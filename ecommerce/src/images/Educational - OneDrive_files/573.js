(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[573,24],{2406:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(78),i=n(237),r=n(179),o=function(){function e(){}return e.getBatchOperationUrl=function(e,t){return new i.t({webAbsoluteUrl:!e&&t?new r.e(t).authority:e}).build().segment("$batch").toString()},e.processErrorResponse=function(e,t){var n={id:t};if((e=e.error?e.error:e)&&e.code){var a=e.code?e.code.split(","):e.error.code.split(","),i=Number(a[0]),r=e.message.value;n.error={code:i,message:r}}return{items:[n]}},e.getBatchResponseText=function(e){var t,n,a,i=[];if(e.split("\n").length>0&&(t=e.split("\n")[0]),t){n=(e=e.replace(t.trim()+"--","")).split(t);for(var r=1;r<n.length;r++)(a=n[r].split("\n\r")).length>2&&i.push(a[2])}return i},e.processBatchResponse=function(e,t,n){var a,i,r,o,s=[],c=!1;if(e&&e.split("\n").length>0&&(a=e.split("\n")[0]),a){i=(e=e.replace(a.trim()+"--","")).split(a);for(var d=1;d<i.length;d++)if((r=i[d].split("\n\r")).length>2){try{o=JSON.parse(r[2])}catch(e){o=r[2]}var l=t&&t[d-1],u=l?{key:l.key,id:l.id,newId:n?n+"/"+l.name:null}:{};if((o=o.error?o.error:o)&&o.code){var f=o.code?o.code.split(","):o.error.code.split(","),p=Number(f[0]),m=o.message.value;u.error={code:p,message:m},c=!0}s.push(u)}}return{items:s,hasError:c}},e.getBatchContent=function(e,t,n,i){for(var r=[],o=0;o<t.length;o++){for(var s=t[o],c=a.e.generate(),d=[],l=0;l<s.length;l++){var u=s[l];d.push("--changeset_"+c),d.push("Content-Type: application/http"),d.push("Content-Transfer-Encoding: binary"),d.push(""),d.push(n+" "+u+" HTTP/1.1"),d.push(i),d.push("")}d.push("--changeset_"+c+"--");var f=d.join("\r\n");r.push("--batch_"+e),r.push('Content-Type: multipart/mixed; boundary="changeset_'+c+'"'),r.push("Content-Length: "+f.length),r.push("Content-Transfer-Encoding: binary"),r.push(""),r.push(f),r.push("")}return r.push("--batch_"+e+"--"),r.join("\r\n")},e.getBatchContentExtended=function(e,t,n,i,r,o,s){var c=a.e.generate(),d=[];r&&r.length!==t.length&&(r=null);for(var l=0;l<t.length;l++){var u=t[l];d.push("--changeset_"+c),d.push("Content-Type: application/http"),d.push("Content-Transfer-Encoding: binary"),d.push(""),s?d.push(s[l]+" "+u+" HTTP/1.1"):d.push(n+" "+u+" HTTP/1.1"),d.push(i),o&&d.push(o),r&&(d.push(""),d.push(r[l])),d.push("")}d.push("--changeset_"+c+"--");var f=d.join("\r\n");return(d=[]).push("--batch_"+e),d.push('Content-Type: multipart/mixed; boundary="changeset_'+c+'"'),d.push("Content-Length: "+f.length),d.push("Content-Transfer-Encoding: binary"),d.push(""),d.push(f),d.push(""),d.push("--batch_"+e+"--"),d.join("\r\n")},e.defaultBatchRequestPostData="Content-Type: application/json;odata=verbose",e.defaultBatchAcceptData="accept: application/json;odata=verbose",e}();t.t=o},2823:function(e,t,n){"use strict";var a,i;n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i}),function(e){e.AddToOneDrive="AddToOneDrive",e.BrowseFiles="BrowseFiles",e.CloseVault="CloseVault",e.CreateFolder="CreateFolder",e.CreateFile="CreateFile",e.DeleteFile="DeleteFile",e.DeleteFolder="DeleteFolder",e.DownloadFile="DownloadFile",e.DownloadBatch="DownloadBatch",e.GetFile="GetFile",e.RenameFile="RenameFile",e.RenameFolder="RenameFolder",e.OpenVault="OpenVault",e.PopulateRecentFiles="PopulateRecentFiles",e.PopulateSharedWithMe="PopulateSharedWithMe",e.Search="Search",e.UploadFile="UploadFile",e.SaveFile="SaveFile",e.UploadBatch="UploadBatch"}(a||(a={})),function(e){e.ActiveUserOperation="AUO",e.BackgroundOperation="BGO",e.PassiveOperation="PO"}(i||(i={}))},3190:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=function(){function e(){}return e.startExitingQuickEditEventName="startExitingQuickEdit",e.quickEditWriteChangesToListEventName="quickEditWriteChangesToList",e.deleteCompletedEventName="quickEditDeleteCompleted",e.switchGridLayout="switchGridLayout",e.undoChangeEventName="quickEditUndoChange",e.redoChangeEventName="quickEditRedoChange",e.undoRealCmdCountChangeEventName="quickEditUndoRealCmdCountChange",e.redoRealCmdCountChangeEventName="quickEditRedoRealCmdCountChange",e.gridGlobalsInitialized="gridGlobalsInitialized",e}();t.t=a},3416:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(303),i=Object(a.e)(function(e){return{}})},3894:function(e,t,n){"use strict";var a;!function(e){e[e.Recycle=2]="Recycle",e[e.PermanantDelete=3]="PermanantDelete",e[e.MoveToSecondStage=4]="MoveToSecondStage"}(a||(a={})),t.e=a},4302:function(e,t,n){"use strict";n.r(t),n.d(t,"driveItemDeleteItemsOperationHandler",function(){return x}),n.d(t,"getDeleteOperationHandler",function(){return C});var a=n(0),i=n(79),r=n(7),o=n(150),s=n(395),c=n(674),d=n(617),l=n(826),u=n(4),f=n(128),p=n(169),m=n(48),_=n(391),h=n(672),b=n(2),g=n(225),v=n(153),y=n(2823),S=n(1046),D=n(45),I=[{code:"resourceLocked"},{code:"lockMismatch"},{code:"nameAlreadyExists"},{code:"resourceModified"},{code:"itemNotFound"},{code:"accessDenied"},{code:"notAllowed"}],x=Object(r.i)({mergeForSameItemKey:!1})(function(e){return function(t){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(n){switch(n.label){case 0:return[4,t(C(e))];case 1:return n.sent(),[2]}})})}});function C(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,r,x,C,w,E,A,L,k,M,P,T,U,F,H,R,N;return Object(a.__generator)(this,function(B){switch(B.label){case 0:if(t=e.itemKey,r=e.options,x=i.e.deserialize(t),C=n(Object(o.e)(function(e){return e.demandItem({folder:u._,oneNote:f.i,driveItem:i.e},t)})),w=!!C.folder||!!C.oneNote,E=n(Object(o.e)(function(e){return e.demandItemFacet(u.d,t)})),A=Object(s.t)(x),E){if(k=n(Object(o.e)(function(e){return{sharepointIds:e.demandItemFacet(S.e,i.e.serialize({endpoint:x.endpoint,driveId:"me"}))}})).sharepointIds,A=function(e,t){if(!e)return"";var n=e.siteUrl,a=e.siteId,i=e.webId;return n&&a&&i?"".concat(t,"/sites/").concat(new D.e(n).domain,",").concat(a,",").concat(i,"/recyclebin/items/delete"):""}(k,x.endpoint),!A||!x.itemId)throw new _.e({code:"invalid url or itemId"});L={ids:[x.itemId]}}return M=x.driveId,P={},!!r.breakLock&&(P.Prefer="bypass-shared-lock"),w&&(P.Prefer="respond-async"),[4,n(Object(c.t)({url:A,method:E?"POST":"DELETE",qosName:E?"recycleBinDeleteItems":"deleteItemVroom",endpoint:x.endpoint,driveId:M,headers:P,expectedErrors:I,body:L,parseResponse:function(e){return e.getResponseHeader("Location")||""},scenarioInfo:{scenario:w?y.e.DeleteFolder:y.e.DeleteFile,scenarioType:y.t.ActiveUserOperation}})).catch(function(e){if(e instanceof h.e)throw new _.e({innerError:e,facets:Object(a.__assign)({},Object(h.t)(e,O)||Object(b.t)({},{}))});throw new _.e({innerError:e})})];case 1:if(""===(T=B.sent()))return[3,12];n(Object(g.e)({items:Object(v.t)({itemKey:r},function(e){return e.progressItemKey,Object(a.__assign)(Object(a.__assign)({},m.g.pack({total:1,current:0})),m.p.pack(!0))},function(e,t){return t.progressItemKey})})),U=!1,B.label=2;case 2:return B.trys.push([2,4,,7]),[4,n(Object(c.t)({url:T,qosName:"getDeleteOperationStatus",endpoint:x.endpoint,driveId:M,parseResponse:function(e){var t=JSON.parse(e.responseText);return{percentComplete:t.percentComplete,status:t.status,retryAfter:Number(e.getResponseHeader("Retry-After")||"10")}},scenarioInfo:{scenario:w?y.e.DeleteFolder:y.e.DeleteFile,scenarioType:y.t.BackgroundOperation}}))];case 3:return F=B.sent(),[3,7];case 4:return(H=B.sent())instanceof h.e?(R=Object(a.__assign)({},Object(h.t)(H,O)||Object(b.t)({},{})),Object(b.n)({autoRetryError:p.i},R).autoRetryError?[4,Object(d.t)(2e4)]:[3,6]):[3,6];case 5:return B.sent(),[3,10];case 6:throw new _.e({innerError:H});case 7:return n(Object(g.e)({items:Object(v.t)({itemKey:r},function(e){return e.progressItemKey,Object(a.__assign)({},m.g.pack({total:1,current:F.percentComplete/100}))},function(e,t){return t.progressItemKey})})),!F||void 0!==F.percentComplete&&"Completed"!==F.status&&"Failed"!==F.status?[3,8]:(U=!0,[3,10]);case 8:return[4,Object(d.t)(1e3*(null==F?void 0:F.retryAfter)||1e4)];case 9:B.sent(),B.label=10;case 10:if(!U)return[3,2];B.label=11;case 11:if(!U)throw new _.e({facets:Object(a.__assign)({},p.u.pack(408))});B.label=12;case 12:return n(Object(l.e)({items:(N={},N[t]=[u.d],N)})),[2]}})})}}function O(e){switch(e){case"resourceLocked":case"lockMismatch":case 423:return Object(a.__assign)({},p.s.pack({}));case"nameAlreadyExists":case 409:return Object(a.__assign)({},p.y.pack({}));case"resourceModified":return Object(a.__assign)({},p.w.pack({}));case"accessDenied":case 403:return Object(a.__assign)({},p.D.pack({}));case 0:return Object(a.__assign)({},p.i.pack({}))}}},5334:function(e,t,n){"use strict";n.r(t),n.d(t,"getDeleteSingleItemUrl",function(){return u}),n.d(t,"spItemDeleteItemsOperationHandler",function(){return G}),n.d(t,"deleteItemsCore",function(){return Q});var a=n(0),i=n(79),r=n(40),o=n(7),s=n(77),c=n(8),d=n(468),l=n(3894);function u(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,a=e.serverRelativeItemUrl,i=e.deletionType,r=e.uniqueId,o=e.isFolder,s=e.listId,c=e.itemId,u=Object(d.a)({webAbsoluteUrl:t,listOrItemFullUrl:n});return u=o?r?u.method("GetFolderById",r):u.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:a}):s&&c?u.method("Lists",s).method("GetItemById",c):u.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:a}),i===l.e.Recycle&&(u=u.segment("recycle")),u.toString()}var f=n(164),p=n(746),m=n(1170),_=n(1),h=n(266),b=n(95),g=n(337),v=n(2406),y=n(78),S=n(391),D=n(4),I=n(36),x=n(169),C=n(150),O=n(128),w=n(286),E=n(64),A=n(167),L=n(265),k=n(6),M=n(3416),P=n(226),T=n(3190),U=n(50),F=n(227),H=n(1499),R=Object(F.e)({operationTypeFacet:H.e}),N=n(153),B=n(1814),j=n(1981),V=n(2),z=n(4302),G=Object(o.n)()(Q),K="-2130575306",W=!c.t.isActivated("8ebca7e1-acfd-489b-bcf5-3a765e64a2a8","8/15/2022","Removes Vroom delete for guest users"),q=!c.t.isActivated("47f09d06-551e-493c-95bb-e16e9708c0cb","8/15/2022","Removes Vroom delete for guest users");function Q(e){var t=this;return function(d){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,F,H,G,Y,J,X,Z,$,ee,te,ne,ae,ie,re,oe,se,ce,de,le,ue,fe,pe,me,_e,he,be,ge,ve,ye,Se,De,Ie,xe,Ce,Oe,we,Ee,Ae,Le,ke,Me,Pe,Te,Ue,Fe,He,Re,Ne,Be,je;return Object(a.__generator)(this,function(Ve){switch(Ve.label){case 0:for(t=e.items,F=void 0,H=void 0,G=void 0,Y=void 0,J=d(M.e),X={},Z=function(e){for(var t=[],n=0,a=e;n<a.length;n++){var i=a[n],r=X[i];r&&r.id&&t.push(r.id)}t.length&&P.e.raise(J,T.e.deleteCompletedEventName,{itemIds:t})},$=[],ee=d(Object(A.e)({enableOverrideDeleteFileLocks:I.h,enableDeleteCommandForMountPointConfiguration:_.w})),te=ee.enableOverrideDeleteFileLocks,ne=ee.enableDeleteCommandForMountPointConfiguration,ae=function(e){Y=t[e].currentItemSetKey;var n=d(Object(C.e)(function(t){return t.demandItem({key:r.e,folder:D._,uniqueId:_.Tn,folderPath:_.he,oneNote:O.i,itemId:_.Ye,mountPoint:_.it,driveItemKey:i.e},e)}));if(n)if(ne&&n.mountPoint)$.push(e);else if(n.key&&n.folderPath){H=n.key.webAbsoluteUrl,G=n.key.listFullUrl;var o=n.driveItemKey?i.e.serialize(Object(a.__assign)(Object(a.__assign)({},n.driveItemKey),{endpoint:n.driveItemKey.endpoint.replace("v2.0","v2.1")})):void 0;if(!F){var s=f.e.serialize({webAbsoluteUrl:H,listFullUrl:G}),c=d(Object(C.e)(function(e){return e.demandItemFacet(_.We,s)}));F={webAbsoluteUrl:H,listFullUrl:G,items:[],deletionType:l.e.Recycle,listId:c&&c.id}}var u={key:e,serverRelativeItemUrl:n.folderPath,id:n.itemId,uniqueId:n.uniqueId,isFolder:!!n.folder||!!n.oneNote,driveItemKey:o};F.items.push(u),X[u.key]=u}},ie=0,re=Object.keys(t);ie<re.length;ie++)oe=re[ie],ae(oe);return $&&$.length>0?(se={currentItemSetKey:Y},[4,d(R({items:Object(N.e)($,function(){return se})}))]):[3,2];case 1:Ve.sent(),Ve.label=2;case 2:return ce=F,de=[],le=d(Object(C.e)(function(e){return H&&G?e.demandItemFacet(_.Sn,p.e.serialize({webAbsoluteUrl:H,listFullUrl:G})):void 0})),ce&&ce.items.length?1!==ce.items.length?[3,7]:(ue=ce.items[0],fe=d(Object(C.e)(function(e){return{list:Object(h.e)(e,ue.key),isVroomDeleteEnabled:Object(s.e)(e,{feature:{ODB:60936}})}})),pe=fe.list,me=fe.isVroomDeleteEnabled,_e=pe&&pe.isDocumentLibrary,he=le&&!(le.isAnonymousGuestUser||le.isExternalGuestUser||le.isEmailAuthenticationGuestUser),be=le&&(le.env2||le.env),ge=!q||be!==I.e.pathfinder&&be!==I.e.trailblazer,ve=W?he:le,_e&&ue.driveItemKey&&ve&&ge&&me?(ye=t[ue.key],Se={itemKey:ue.driveItemKey,options:ye},[4,d(Object(z.getDeleteOperationHandler)(Se))]):[3,4]):[3,10];case 3:return Ve.sent(),[3,6];case 4:return De=u({webAbsoluteUrl:ce.webAbsoluteUrl,listFullUrl:ce.listFullUrl,deletionType:ce.deletionType,listId:ce.listId,serverRelativeItemUrl:ue.serverRelativeItemUrl,uniqueId:ue.uniqueId,isFolder:!!ue.isFolder,itemId:ue.id}),Ie={},ce.deletionType===l.e.PermanantDelete&&(Ie["X-HTTP-Method"]="DELETE"),Le=t[Object.keys(t)[0]],(xe=!!Le.breakLock)&&(Ie.Prefer="bypass-shared-lock"),[4,d(Object(b.t)({webAbsoluteUrl:ce.webAbsoluteUrl,listFullUrl:G||"",url:De,body:void 0,method:"POST",additionalHeaders:Ie,qosName:"deleteSingleItem",telemetryHandler:function(e){var t=e.errorData,n=e.eventData;if(t){var i=t.status===S.t||te&&t.code&&t.code.indexOf(K)>-1?E.e.expectedFailure:E.e.failure;return{eventData:Object(a.__assign)(Object(a.__assign)({},n),{resultType:i})}}return{eventData:n}}})).then(function(){de.push(ue.key),Z(de)}).catch(function(e){if(e instanceof g.e){if(e.code&&e.code.indexOf(K)>-1)throw te&&d(Object(L.e)({name:"DeleteOperationFileLockedWithForcedDeleteEnabled",isIntentional:!1,extraData:{errorCode:e.code,overrideFileLocksEnabled:te,isBatch:!1}})),new S.e({innerError:e,facets:Object(a.__assign)({},x.s.pack({}))});if(xe&&d(Object(L.e)({name:"DeleteOperationOverrideFilelockedFailed",isIntentional:!1,extraData:{errorCode:e.code,overrideFileLocksEnabled:te,isBatch:!1}})),e.errorData.status===S.t)throw new S.e({innerError:e,facets:Object(a.__assign)({},x.v.pack({}))})}throw e})];case 5:Ve.sent(),Ve.label=6;case 6:return[3,9];case 7:return ce.items.length>1?(Ce=y.e.generate(),Oe="multipart/mixed; boundary=batch_".concat(Ce),[4,d(Object(b.t)({webAbsoluteUrl:ce.webAbsoluteUrl,listFullUrl:G||"",url:v.e.getBatchOperationUrl(ce.webAbsoluteUrl),body:n(ce,Ce),method:"POST",additionalHeaders:void 0,contentType:Oe,parseResponse:function(e){return v.e.processBatchResponse(e,ce.items)},qosName:"deleteMultipleItems"})).then(function(e){for(var t=0,n=e.items;t<n.length;t++)!(c=n[t]).error&&c.key&&de.push(c.key);if(Z(de),e.hasError){for(var i={items:{}},r=0,s=e.items;r<s.length;r++){var c;if((c=s[r]).error&&c.key){var l=c.error.code&&c.error.code.toString()===K;te&&d(Object(L.e)({name:"DeleteOperationFileLockedInBatchWithForcedDeleteEnabled",isIntentional:!1,extraData:{errorCode:c.error.code,overrideFileLocksEnabled:te,isBatch:!0}})),i.items[c.key]=new S.e({message:c.error.message,facets:l?Object(a.__assign)({},x.s.pack({})):void 0})}}throw new o.e(i)}return Promise.resolve({data:e})})]):[3,9];case 8:Ve.sent(),Ve.label=9;case 9:for(we=new w.e({publisher:Q}),Ee=0,Ae=ce.items;Ee<Ae.length;Ee++)Le=Ae[Ee],we.invalidateItems({items:(Re={},Re[Le.key]=[D.d],Re)}),we.resolveItems({items:(Ne={},Ne[Le.key]=D.d.pack({}),Ne)});for(ke=!le||!Object(c.a)(le).isActivated("53BF5F56-AF6E-4509-AB0C-6E6F3923C492","08/07/2020","Do not resolve remaining items for current itemSet after delete for group by view"),Y&&de.length&&(Me=d(Object(C.e)(function(e){var t=e.demandItemFacet(k.e,Y);if(t&&t.itemKeys){for(var n=[],a=0,i=t.itemKeys;a<i.length;a++){var o=i[a];if(ke&&m.e.matches(o))return;var s=e.demandItemFacet(r.e,o),c=s&&r.e.serialize(s)||o;de.indexOf(c)<0&&n.push(o)}return n}})),Me&&we.resolveItems({items:(Be={},Be[Y]=k.e.pack({itemKeys:Me}),Be)})),le&&!Object(c.a)(le).isActivated("445a1e80-95c9-44fa-8845-c1d701b1a548","01/26/2021","Deleted pinned items")&&(Pe=d(Object(C.e)(function(e){var t=e.demandItemFacet(B.e,Y);return t&&B.e.serialize(t)})))&&we.resolveItems({items:(je={},je[Pe]=Object(V.t)({childItems:k.e},{childItems:{itemKeys:new j.e(function(e){return-1!==de.indexOf(e)},{defaultToEmptyArray:!0})}}),je)}),Te=function(e){var t,n=d(Object(C.e)(function(t){return t.demandItemFacet(D.k,e)}));n&&n.itemKey&&we.invalidateItems({items:(t={},t[n.itemKey]=[U.e],t)})},Ue=0,Fe=de;Ue<Fe.length;Ue++)He=Fe[Ue],Te(He);d(we.execute()),Ve.label=10;case 10:return[2]}})})};function n(e,t){var n=e.items,a=e.deletionType===l.e.PermanantDelete?"DELETE":"POST",i=e.deletionType===l.e.PermanantDelete?"If-Match: *":v.e.defaultBatchRequestPostData,r=n.map(function(t){return u({webAbsoluteUrl:e.webAbsoluteUrl,listFullUrl:e.listFullUrl,deletionType:e.deletionType,serverRelativeItemUrl:t.serverRelativeItemUrl,uniqueId:t.uniqueId,isFolder:t.isFolder,listId:e.listId,itemId:t.id})});return v.e.getBatchContentExtended(t,r,a,i)}}}}]);