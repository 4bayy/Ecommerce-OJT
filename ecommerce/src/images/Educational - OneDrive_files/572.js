(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[572],{2059:function(e,t,n){"use strict";n.r(t),n.d(t,"Uploader",function(){return xt});var a=n(0),i=n("react-lib"),r=n(188),o=n(708),s=n(1803),c=n(6),d=n(149),l=n(4),u=n(1298),f=n(1515),p=n(48),m=n(634),_=n(287),h=n(98),b=n(435),g=n(934),v=n(225),y=n(1901),S=n(1968),D=n(74),I=n(2),x=n(50),C=n(816),O=n(150),w=n(2857),E=n(115),A=n(3516),L=n(748),k=n(251),M=n(116),P=new M.e("uploadStats",function(e,t){var n,a={file:U(),folder:U(),extensions:{}},i=e.demandItemFacet(c.e,t.itemKey);if(i)for(var r=0,o=i.itemKeys;r<o.length;r++){var s=o[r],d=e.demandItemFacet(P,s);d&&(F(a.file,d.file),F(a.folder,d.folder),H(a.extensions,d.extensions))}var u=e.demandItemFacet(p.v,t.itemKey),f=u&&u.itemKey;if(f){var m=e.demandItemFacet(l._,f),_=e.demandItemFacet(p.b,t.itemKey),h=Object(p.c)(_||p.a.expired),b=Object(p.s)(h);if(e.demandItemFacet(w.e,f));else if(m)F(a.folder,b);else{F(a.file,b);var g=e.demandItemFacet(l.p,f),v=g&&g.extension||"unknown";H(a.extensions,((n={})[v]=b,n))}}return a}),T=new M.e("overallUploadProgressSize",function(e,t){var n=e.demandItemFacet(p.g,t.itemKey);if(n)return n;var a=e.demandItemFacet(c.e,t.itemKey);if(a){for(var i={total:0,current:0},r=0,o=a.itemKeys;r<o.length;r++){var s=o[r],d=e.demandItemFacet(T,s);if(!d)return;i.total+=d.total,i.current+=d.current}return i}var u=e.demandItemFacet(p.v,t.itemKey);if(u){var f=e.demandItemFacet(l.m,u.itemKey);if("number"!=typeof f)return;return{total:f,current:e.demandItemFacet(p.r,t.itemKey)?f:0}}});function U(e){var t={started:0,completed:0,canceled:0,failed:0};return e&&(t.started+=e.started,t.completed+=e.completed,t.failed+=e.failed,t.canceled+=e.canceled),t}function F(e,t){e.started+=t.started,e.completed+=t.completed,e.failed+=t.failed,e.canceled+=t.canceled}function H(e,t){for(var n=0,i=Object.keys(t);n<i.length;n++){var r=i[n],o=t[r];r in e?F(e[r],o):e[r]=Object(a.__assign)({},o)}}var R=n(1460),N=n(199),B=n(673),j=n(286),V=0,z=new I.e("uploadProgressCallbacksFacet"),G=function(){},K={onItemQueued:G,onItemUploaded:G,onItemFailed:G,onEntryBatchCreated:G,onEntryBatchUploaded:G,onEntryBatchFailed:G};function W(e){var t=this,n=e.parentItemKey,i=e.sourceEntryKey,o=e.callbacks,s=void 0===o?K:o,c=e.options,d=void 0===c?{}:c;return function(o){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,c,l,u,f,p;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return o(h.i),t=++V,c={operation:W},o(Object(L.e)({owner:c,items:(p={},p[i]={},p)})),l=new r.t,e.cancelToken&&e.cancelToken.subscribe(l.cancel),[4,o(Y({sourceEntryKey:i}))];case 1:return u=a.sent(),[4,o(u({parentItemKey:n,cancelToken:l.token,callbacks:s,options:d,uploadId:t}))];case 2:f=a.sent().completed,a.label=3;case 3:return a.trys.push([3,,5,6]),[4,f];case 4:return a.sent(),[3,6];case 5:return l.dispose(),o(Object(L.n)({owner:c})),[7];case 6:return[2]}})})}}function q(e){var t=this,n=e.sourceEntryKey,i=e.cancelToken,r=e.onReceiveChildUploader,o=Object(A.e)(n);return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,s,d,l=this;return Object(a.__generator)(this,function(u){switch(u.label){case 0:t={operation:q},e(Object(L.e)({owner:t,items:(s={},s[o]={},s)})),u.label=1;case 1:return u.trys.push([1,,3,4]),e(Object(v.e)({items:(d={},d[o]=Object(a.__assign)({},c.e.pack({itemKeys:[]})),d)})),[4,e(Q({itemKey:n,cancelToken:i,onReceiveChildKeys:function(t){return Object(a.__awaiter)(l,void 0,void 0,function(){var n,s,d,l,u,f,p=this;return Object(a.__generator)(this,function(m){switch(m.label){case 0:for(i.throwIfCanceled(),n=new j.e,s=0,d=t;s<d.length;s++)l=d[s],u=Object(A.e)(l),n.resolveItems({items:(f={},f[u]=Object(a.__assign)({},c.r.pack({itemKey:o})),f[o]=Object(I.t)({childItems:c.e},{childItems:{itemKeys:new y.e([u],function(e){return e})}}),f)});return e(n.execute()),[4,Object(C.e)(t.map(function(t){return Object(a.__awaiter)(p,void 0,void 0,function(){var n;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return n=r,[4,e(Y({sourceEntryKey:t}))];case 1:return n.apply(void 0,[a.sent()]),[2]}})})}))];case 1:return m.sent(),[2]}})})}}))];case 2:return u.sent(),[3,4];case 3:return e(Object(L.n)({owner:t})),[7];case 4:return[2]}})})}}function Q(e){var t=this,n=e.itemKey,i=e.cancelToken,r=e.onReceiveChildKeys;return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,d,l=this;return Object(a.__generator)(this,function(u){switch(u.label){case 0:return t={},[4,e(Object(o.e)(function(e){var t=e.demandItemFacet(c.t,n);return t&&t.itemKey}))];case 1:return(d=u.sent())?[4,e(Object(s.e)(function(e){i&&i.throwIfCanceled();var t=e.demandItemFacet(c.e,d),n=[];if(t)for(var a=0,r=t.itemKeys;a<r.length;a++){var o=r[a];e.isItemFacetResolved(c.a,o)?e.demandItemFacet(c.e,o):n.push(o)}return n},function(e){return Object(a.__awaiter)(l,void 0,void 0,function(){var n,i,o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:for(n=[],i=0,o=e;i<o.length;i++)(s=o[i])in t||(n.push(s),t[s]=!0);return[4,r(n)];case 1:return a.sent(),[2]}})})}))]:[2];case 2:return u.sent(),[2]}})})}}function Y(e){var t=this,n=e.sourceEntryKey;return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,e(Object(o.e)(function(e){return e.demandItemFacet(w.e,n)}))];case 1:return t.sent()?[2,J(n)]:[4,e(Object(o.e)(function(e){return e.demandItemFacet(l._,n)}))];case 2:return t.sent()?[2,X(n)]:[2,Z(n)]}})})}}function J(e){var t=this;return Object(d.t)(function(n){var i=n.parentItemKey,o=n.callbacks,s=n.options,d=n.uploadId,l=Object(A.e)(e);return function(u){var f,m,_=new r.t;n.cancelToken.subscribe(_.cancel);var h={operation:J};u(Object(L.e)({owner:{},items:(f={},f[l]={},f)})),u(Object(v.e)({items:(m={},m[b.e]=Object(I.t)({childItems:c.e},{childItems:{itemKeys:new y.e([l],function(e){return e})}}),m[l]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},x.r.pack(!0)),p.i.pack(_)),p.v.pack({itemKey:e})),c.r.pack({itemKey:b.e})),p.o.pack({itemKey:i})),Object(I.t)({progressCallbacks:z},{progressCallbacks:{onEntryBatchCreated:new S.e([o.onEntryBatchCreated]),onEntryBatchFailed:new S.e([o.onEntryBatchFailed]),onEntryBatchUploaded:new S.e([o.onEntryBatchUploaded])}})),m)}));var w=Object(a.__awaiter)(t,void 0,void 0,function(){var t,n;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return t=[],n=[],[4,u(q({sourceEntryKey:e,cancelToken:_.token,onReceiveChildUploader:function(e){_.token.throwIfCanceled();var a=u(e({parentItemKey:i,cancelToken:_.token,callbacks:o,options:s,uploadId:d})),r=a.started,c=a.completed;t.push(r),n.push(c)}}))];case 1:return a.sent(),[2,{startedWork:t,completedWork:n}]}})}),E=Object(a.__awaiter)(t,void 0,void 0,function(){var e,t;return Object(a.__generator)(this,function(n){switch(n.label){case 0:return t=(e=Promise).race,[4,w];case 1:return[4,t.apply(e,[n.sent().startedWork])];case 2:return n.sent(),[2]}})}),A=Object(a.__awaiter)(t,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:return e=C.e,[4,w];case 1:return[4,e.apply(void 0,[t.sent().completedWork])];case 2:return t.sent(),[2]}})}),k=Object(a.__awaiter)(t,void 0,void 0,function(){var e,t,n,i,o;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(e=u($({uploadProgressKey:l,uploadId:d,qosName:"Uploader.uploadBatch"})),t=u(Object(O.e)(function(e){return e.demandItemFacet(z,l)})))for(n=0,i=t.onEntryBatchCreated;n<i.length;n++)(0,i[n])({progressItemKey:l});a.label=1;case 1:return a.trys.push([1,,3,4]),[4,u(Object(g.e)({progressItemKey:l,started:E,completed:A,onStarted:function(e){},onCompleted:function(n){var a;if(t)for(var i=0,r=t.onEntryBatchUploaded;i<r.length;i++)(0,r[i])({progressItemKey:l});u(Object(v.e)({items:(a={},a[l]=Object(I.t)({progressCallbacks:z},{progressCallbacks:new D.e}),a)})),u(e({error:n.error}))},onFailed:function(n){var a;if(t)for(var i=0,o=t.onEntryBatchFailed;i<o.length;i++)(0,o[i])({error:n.error||new Error("No error reported from batch upload."),progressItemKey:l});n.error&&Object(r.n)(n.error)&&u(Object(v.e)({items:(a={},a[l]=Object(I.t)({progressCallbacks:z},{progressCallbacks:new D.e}),a)})),u(e({error:n.error}))}}))];case 2:return a.sent(),[3,4];case 3:return u(Object(v.e)({items:(o={},o[l]=Object(I.t)({cancelSource:p.i},{cancelSource:new D.e}),o)})),u(Object(L.n)({owner:h})),[7];case 4:return[2]}})});return{started:E,completed:Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Object(C.e)([A,k])];case 1:return e.sent(),[2]}})})}}})}function X(e){var t=this;return Object(d.t)(function(n){var i=n.parentItemKey,s=n.callbacks,c=n.options,d=n.uploadId,u=Object(A.e)(e);return function(h){var b,y,w=new r.t;n.cancelToken.subscribe(w.cancel);var k={operation:X};h(Object(L.e)({owner:k,items:(b={},b[u]={},b[e]={},b)})),h(Object(v.e)({items:(y={},y[u]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},E.t.pack(void 0)),p.b.pack(p.a.created)),x.r.pack(!0)),p.o.pack({itemKey:i})),p.v.pack({itemKey:e})),p.i.pack(w)),Object(I.t)({progressCallbacks:z},{progressCallbacks:{onItemQueued:new S.e([s.onItemQueued]),onItemUploaded:new S.e([s.onItemUploaded]),onItemFailed:new S.e([s.onItemFailed])}})),y)}));var M=h(function(e){var t=this;return function(n){var i=e.sourceEntryKey,r=e.parentItemKey,s=e.cancelToken,c=e.options,d=Object(A.e)(i),u=Object(a.__awaiter)(t,void 0,void 0,function(){var e,t,u,h,b,g,y,S,D,I=this;return Object(a.__generator)(this,function(x){switch(x.label){case 0:return[4,n(Object(o.e)(function(e){return e.demandItemFacet(l.p,i)}))];case 1:if(!(e=x.sent()))throw new Error("Invalid folder name.");return t={folders:(y={},y[e.name]=Object(a.__assign)({progressItemKey:d},c),y)},n(Object(v.e)({items:(S={},S[d]=Object(a.__assign)({},f.t.pack(t)),S)})),u=n(Object(m.e)({operationTypeFacet:f.t,items:(D={},D[r]=t,D)})),h=u.started,b=u.completed,g=s.subscribe(function(){var e;n(Object(_.e)({operationTypeFacet:f.t,items:(e={},e[r]=t,e)}))}),Object(a.__awaiter)(I,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,h];case 1:return e.sent(),g(),[2]}})}),[2,{started:h,itemCreated:Object(a.__awaiter)(I,void 0,void 0,function(){var e,t;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,b];case 1:if(a.sent(),e=n(Object(O.e)(function(e){return e.demandItemFacet(p.r,d)})),!(t=e&&e.itemKey))throw new Error("No folder created.");return[2,t]}})})}]}})});return{started:Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,u];case 1:return[4,e.sent().started];case 2:return e.sent(),[2]}})}),itemCreated:Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,u];case 1:return[4,e.sent().itemCreated];case 2:return[2,e.sent()]}})})}}}({sourceEntryKey:e,parentItemKey:i,cancelToken:w.token,options:c})),P=M.started,T=M.itemCreated,U=Object(a.__awaiter)(t,void 0,void 0,function(){var t,n,i;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,T];case 1:return t=a.sent(),n=[P],i=[],[4,h(q({sourceEntryKey:e,cancelToken:w.token,onReceiveChildUploader:function(e){var a=h(e({parentItemKey:t,cancelToken:w.token,callbacks:s,options:c,uploadId:d})),r=a.started,o=a.completed;n.push(r),i.push(o)}}))];case 2:return a.sent(),[2,{startedWork:n,completedWork:i}]}})}),F=Object(a.__awaiter)(t,void 0,void 0,function(){var e,t;return Object(a.__generator)(this,function(n){switch(n.label){case 0:return t=(e=Promise).race,[4,U];case 1:return[4,t.apply(e,[n.sent().startedWork])];case 2:return n.sent(),[2]}})}),H=Object(a.__awaiter)(t,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:return e=C.e,[4,U];case 1:return[4,e.apply(void 0,[t.sent().completedWork])];case 2:return t.sent(),[2]}})}),R=Object(a.__awaiter)(t,void 0,void 0,function(){var e,t,n,i,o,s=this;return Object(a.__generator)(this,function(c){switch(c.label){case 0:if(e=h($({uploadProgressKey:u,uploadId:d,qosName:"Uploader.createFolder"})),t=h(Object(O.e)(function(e){return e.demandItemFacet(z,u)})))for(n=0,i=t.onItemQueued;n<i.length;n++)(0,i[n])({progressItemKey:u});c.label=1;case 1:return c.trys.push([1,,3,4]),[4,h(Object(g.e)({progressItemKey:u,started:F,completed:Object(a.__awaiter)(s,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,T];case 1:return e.sent(),[2]}})}),onStarted:function(e,t){t&&t(e)},onCompleted:function(n,a){var i;if(a&&a(n),t)for(var r=0,o=t.onItemUploaded;r<o.length;r++)(0,o[r])({progressItemKey:u});h(Object(v.e)({items:(i={},i[u]=Object(I.t)({progressCallbacks:z},{progressCallbacks:new D.e}),i)})),h(e({error:n.error}))},onFailed:function(n,a){var i;if(a&&a(n),t)for(var o=0,s=t.onItemFailed;o<s.length;o++)(0,s[o])({progressItemKey:u});n.error&&Object(r.n)(n.error)&&h(Object(v.e)({items:(i={},i[u]=Object(I.t)({progressCallbacks:z},{progressCallbacks:new D.e}),i)})),h(e({error:n.error}))}}))];case 2:return c.sent(),[3,4];case 3:return h(Object(v.e)({items:(o={},o[u]=Object(I.t)({cancelSource:p.i},{cancelSource:new D.e}),o)})),w.dispose(),h(Object(L.n)({owner:k})),[7];case 4:return[2]}})}),N=Object(a.__awaiter)(t,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:return e=h($({uploadProgressKey:u,uploadId:d,qosName:"Uploader.uploadFolder"})),[4,h(Object(g.e)({progressItemKey:u,started:F,completed:H,onStarted:function(e,t){},onCompleted:function(t,n){var i,r=h(Object(O.e)(function(e){return{overallProgressCounts:e.demandItemFacet(p.d,u),overallProgressSize:e.demandItemFacet(p.u,u)}})),o=r.overallProgressCounts,s=r.overallProgressSize,c=new j.e;c.resolveItems({items:(i={},i[u]=Object(a.__assign)(Object(a.__assign)({},p.m.pack(o)),p.g.pack(s)),i)}),h(c.execute()),h(e({error:t.error}))},onFailed:function(t,n){h(e({error:t.error}))}}))];case 1:return t.sent(),[2]}})});return{started:F,completed:Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Object(C.e)([H,R,N])];case 1:return e.sent(),[2]}})})}}})}function Z(e){var t=this;return Object(d.t)(function(n){var i=n.parentItemKey,s=n.callbacks,c=n.options,d=n.uploadId,f=Object(A.e)(e);return function(h){var b,y,w=new r.t;n.cancelToken.subscribe(w.cancel);var k=h($({uploadProgressKey:f,uploadId:d,qosName:"Uploader.uploadFile"}));if(h(Object(O.e)(function(e){return e.demandItemFacet(p.r,f)})))return{started:Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2]})}),completed:Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2]})})};var M={operation:Z};h(Object(L.e)({owner:M,items:(b={},b[f]={},b[e]={},b)})),h(Object(v.e)({items:(y={},y[f]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},E.t.pack(void 0)),p.b.pack(p.a.created)),x.r.pack(!1)),p.o.pack({itemKey:i})),p.v.pack({itemKey:e})),p.i.pack(w)),Object(I.t)({progressCallbacks:z},{progressCallbacks:{onItemQueued:new S.e([s.onItemQueued]),onItemUploaded:new S.e([s.onItemUploaded]),onItemFailed:new S.e([s.onItemFailed])}})),y)}));var P=h(function(e){var t=this,n=e.sourceEntryKey,i=e.parentItemKey,r=e.cancelToken,s=e.options,c=Object(A.e)(n);return function(e){var d,f,h={sourceEntries:(d={},d[n]=Object(a.__assign)({progressItemKey:c},s),d)};e(Object(v.e)({items:(f={},f[c]=Object(a.__assign)({},u.t.pack(h)),f)}));var b=Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,e(Object(o.e)(function(e){return{fileSize:e.demandItemFacet(l.m,n),fileName:e.demandItemFacet(l.p,n)}}))];case 1:return[2,t.sent()]}})}),g=Object(a.__awaiter)(t,void 0,void 0,function(){var t,n,o,s,d,l,f,g=this;return Object(a.__generator)(this,function(y){switch(y.label){case 0:return[4,b];case 1:return void 0!==(t=y.sent().fileSize)&&e(Object(v.e)({items:(l={},l[c]=Object(a.__assign)({},p.g.pack({total:t,current:0})),l)})),n=e(Object(m.e)({operationTypeFacet:u.t,items:(f={},f[i]=h,f)})),o=n.started,s=n.completed,d=r.subscribe(function(){var t;e(Object(_.e)({operationTypeFacet:u.t,items:(t={},t[i]=h,t)}))}),Object(a.__awaiter)(g,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,o];case 1:return e.sent(),d(),[2]}})}),[2,{started:o,completed:s}]}})});return{started:Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,g];case 1:return[4,e.sent().started];case 2:return e.sent(),[2]}})}),completed:Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,g];case 1:return[4,e.sent().completed];case 2:return e.sent(),[2]}})})}}}({sourceEntryKey:e,parentItemKey:i,cancelToken:w.token,options:c})),T=P.started,U=P.completed,F=Object(a.__awaiter)(t,void 0,void 0,function(){var e,t,n,i;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(e=h(Object(O.e)(function(e){return e.demandItemFacet(z,f)})))for(t=0,n=e.onItemQueued;t<n.length;t++)(0,n[t])({progressItemKey:f});a.label=1;case 1:return a.trys.push([1,,3,4]),[4,h(Object(g.e)({progressItemKey:f,started:T,completed:U,onStarted:function(e,t){t&&t(e)},onCompleted:function(t,n){var a;if(n&&n(t),e)for(var i=0,r=e.onItemUploaded;i<r.length;i++)(0,r[i])({progressItemKey:f});h(Object(v.e)({items:(a={},a[f]=Object(I.t)({progressCallbacks:z},{progressCallbacks:new D.e}),a)})),h(k({error:t.error}))},onFailed:function(t,n){var a;if(n&&n(t),e)for(var i=0,o=e.onItemFailed;i<o.length;i++)(0,o[i])({progressItemKey:f});t.error&&Object(r.n)(t.error)&&h(Object(v.e)({items:(a={},a[f]=Object(I.t)({progressCallbacks:z},{progressCallbacks:new D.e}),a)})),h(k({error:t.error}))}}))];case 2:return a.sent(),[3,4];case 3:return h(Object(v.e)({items:(i={},i[f]=Object(I.t)({cancelSource:p.i},{cancelSource:new D.e}),i)})),w.dispose(),h(Object(L.n)({owner:M})),[7];case 4:return[2]}})});return{started:T,completed:Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Object(C.e)([U,F])];case 1:return e.sent(),[2]}})})}}})}function $(e){var t=e.qosName,n=e.uploadProgressKey,i=e.uploadId;return function(e){var r=e(Object(k.e)({name:t}));return function(t){var o=t.error;return function(){var t=e(Object(O.e)(function(e){var t=e.demandItemFacet(p.v,n),a=t&&t.itemKey,i=e.demandItemFacet(l._,a),r=e.demandItemFacet(w.e,a);return{entryBatch:r,folder:i,fileName:e.demandItemFacet(l.p,a),uploadStats:i||r?e.demandItemFacet(P,n):void 0,progressSize:e.demandItemFacet(T,n)}})),s=t.entryBatch,c=t.folder,d=t.fileName,u=t.uploadStats,f=t.progressSize,m=Object(R.e)(d&&d.extension),_=s?"Batch":c?"Folder":"File",h=f?f.total:0,b=f?f.current:0;e(r(Object(B.e)(Object(N.e)(o),{extraData:Object(a.__assign)(Object(a.__assign)({uploadId:i,totalBytes:h,uploadedBytes:b,objectType:_},s?{}:{extension:m}),u?{"count.file.started":u.file.started,"count.file.completed":u.file.completed,"count.file.failed":u.file.failed,"count.file.canceled":u.file.canceled,"count.folder.started":u.folder.started,"count.folder.completed":u.folder.completed,"count.folder.failed":u.folder.failed,"count.folder.canceled":u.folder.canceled}:{})})))}}}}var ee,te,ne,ae=n(7),ie=n(592),re=n(477),oe=n(18),se=n(4613),ce=n(335),de=n(1086),le=n(2990),ue=n(3640),fe=n(1045),pe=n(3276),me=n(1767),_e=n(391),he=n(4614),be=n(1673),ge=n(153),ve=n(26),ye=n(1450),Se=n(56),De=n(38),Ie=n(23),xe=n(68),Ce=Object(Se.t)(function(e,t){var n=t.itemKeys,r=t.conflictResolution,o=n.filter(function(t){return"failed"===Object(h.a)(e,{itemKey:t}).phase});if(0===o.length)return null;var s=e.dispatch,c=e.demandItemFacet(p.v,o[0]),d=null==c?void 0:c.itemKey,l=Ie.e.get(o[0]),u=e.demandItemFacet(E.t,o[0]);return i.createElement(ve.e,Object(a.__assign)({onExecute:function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,s(Object(pe.e)({items:Object(ge.e)(o,function(){return{conflictResolution:r}})}))];case 1:return e.sent(),[2]}})})},isAvailable:o.length>0},Object(De.t)(e,{itemKey:d,engagement:{name:"ResolveProgress",isIntentional:!0,extraData:Object(a.__assign)({operationType:l.debugName,conflictResolution:r},u&&u instanceof xe.e&&u.code?{errorCode:u.code}:{})}})))}),Oe=Object(ye.e)()(Ce),we={key:new I.e("replaceProgressCommand").id,name:ce.S,action:i.createElement(Oe,{conflictResolution:"replace"})},Ee={key:new I.e("replaceAllProgressCommand").id,name:ce.D,action:i.createElement(Oe,{conflictResolution:"replace"})},Ae={key:new I.e("renameProgressCommand").id,name:ce.v,action:i.createElement(Oe,{conflictResolution:"rename"})},Le={key:new I.e("renameAllProgressCommand").id,name:ce.y,action:i.createElement(Oe,{conflictResolution:"rename"})},ke=n(169),Me=n(19),Pe=new Ie.e("uploadProgress",{type:Me.e}),Te=n(3899),Ue={unknown:Pe.serialize({type:"unknown"}),conflictAll:Pe.serialize({type:"conflict-rename+replace"}),conflictRename:Pe.serialize({type:"conflict-rename"}),conflictReplace:Pe.serialize({type:"conflict-replace"}),similarNameExists:Pe.serialize({type:"similarNameExists"}),accessDenied:Pe.serialize({type:"accessDenied"}),invalidName:Pe.serialize({type:"invalidName"}),emptyFileOrFolder:Pe.serialize({type:"emptyFileOrFolder"}),folderUpload:Pe.serialize({type:"folderUpload"}),overQuota:Pe.serialize({type:"overQuota"}),lockMismatch:Pe.serialize({type:"lockMismatch"}),authFailure:Pe.serialize({type:"authFailure"}),targetFolder:Pe.serialize({type:"targetFolder"}),malware:Pe.serialize({type:"malware"}),fileSize:Pe.serialize({type:"fileSize"}),throttle:Pe.serialize({type:"throttle"}),offline:Pe.serialize({type:"offline"})},Fe=n(1338),He=n(2923),Re=!n(8).e.isActivated("68938d4d-8b3a-4faa-9f8a-198f66b0b49b","11/09/2022","Upadtes strings for single item upload operations"),Ne=((ee={})[p.a.started]=function(e){var t=e.count;return Object(oe.formatToArray)(Object(oe.getLocalizedCountValue)(se.u,se.a,t)||"",t)},ee[p.a.completed]=function(e){var t=e.count;return Object(oe.formatToArray)(Object(oe.getLocalizedCountValue)(se.n,se.a,t)||"",t)},ee[p.a.failed]=function(e){var t=e.count;return Object(oe.formatToArray)(Object(oe.getLocalizedCountValue)(se.s,se.c,t)||"",t)},ee[p.a.canceled]=function(e){var t=e.count;return Object(oe.formatToArray)(Object(oe.getLocalizedCountValue)(se.s,se.c,t)||"",t)},ee),Be=((te={})[p.a.started]=function(e){var t=e.displayName,n=e.destinationItemKey;return Object(oe.formatToArray)(se.f,i.createElement("span",{className:Te.t},t),i.createElement(le.e,{key:"link",itemKey:n}))},te[p.a.completed]=function(e){var t=e.displayName,n=e.destinationItemKey;return Object(oe.formatToArray)(se.i,i.createElement("span",{className:Te.t},t),i.createElement(le.e,{key:"link",itemKey:n}))},te[p.a.failed]=function(e){var t=e.displayName,n=e.destinationItemKey;return Object(oe.formatToArray)(se.d,i.createElement("span",{className:Te.t},t),i.createElement(le.e,{key:"link",itemKey:n}))},te[p.a.canceled]=function(e){var t=e.displayName,n=e.destinationItemKey;return Object(oe.formatToArray)(se.d,i.createElement("span",{className:Te.t},t),i.createElement(le.e,{key:"link",itemKey:n}))},te),je=((ne={})[p.a.started]=function(e){var t=e.count,n=e.itemKey;return Object(oe.formatToArray)(Object(oe.getLocalizedCountValue)(se.l,se.t,t)||"",t,i.createElement(le.e,{key:"link",itemKey:n}))},ne[p.a.completed]=function(e){var t=e.count,n=e.itemKey;return Object(oe.formatToArray)(Object(oe.getLocalizedCountValue)(se.e,se.t,t)||"",t,i.createElement(le.e,{key:"link",itemKey:n}))},ne[p.a.failed]=function(e){var t=e.count,n=e.itemKey;return Object(oe.formatToArray)(Object(oe.getLocalizedCountValue)(se.r,se.o,t)||"",t,i.createElement(le.e,{key:"link",itemKey:n}))},ne[p.a.canceled]=function(e){var t=e.count,n=e.itemKey;return Object(oe.formatToArray)(Object(oe.getLocalizedCountValue)(se.r,se.o,t)||"",t,i.createElement(le.e,{key:"link",itemKey:n}))},ne),Ve=Object(ae.t)(function(){return function(e){e(Object(ie.e)(A.t,re.e)(Ge)),e(Object(ie.e)(A.t,Fe.e)(ze)),e(Object(_.a)(A.t,ue.t)((A.t,Object(ae.n)()(function(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,r;return Object(a.__generator)(this,function(o){for(t=n(Object(O.e)(function(t){var n=new j.e,i=[];function r(e){var o,s=t.demandItemFacet(p.i,e);s&&i.push(s),n.resolveItems({items:(o={},o[e]=Object(a.__assign)(Object(a.__assign)({},s?{}:Object(a.__assign)({},p.b.pack(p.a.canceled))),Object(I.t)({error:E.t},{error:new D.e})),o)});var d=t.demandItemFacet(c.e,e);if(d)for(var l=0,u=d.itemKeys;l<u.length;l++)r(u[l])}for(var o in e.items)Object.prototype.hasOwnProperty.call(e.items,o)&&r(o);return{itemResolver:n,sourcesToCancel:i}})),n(t.itemResolver.execute()),i=0,r=t.sourcesToCancel;i<r.length;i++)r[i].cancel();return[2]})})}})))),e(Object(_.a)(A.t,fe.t)(Object(ae.i)()(We))),e(Object(_.a)(A.t,pe.t)(Object(ae.i)()(qe))),Re&&e(Object(ie.e)(A.t,He.t)(Ke))}});function ze(e,t){var n=e.demandItemFacet(p.v,t.itemKey),a=e.demandItemFacet(w.e,n&&n.itemKey);return n&&!a?function(e,t){var n=function(e,t){var n=e.demandItemFacet(E.t,t.itemKey);if(n&&!(n instanceof r.e)){if(!(n instanceof _e.e))return Ue.unknown;var a=Object(I.n)({conflict:ke.r,nameAlreadyExists:ke.b,similarNameExists:ke.x,allowRename:ke.t,allowReplace:ke.n,offline:ke.v,accessDenied:ke.e,invalidName:ke.f,emptyFileOrFolder:ke.o,overQuota:ke.S,lockMismatch:ke._,authFailure:ke.a,folderUpload:ke.l,targetFolder:ke.C,malware:ke.h,fileSize:ke.d,throttle:ke.O},n.facets),i=a.conflict,o=a.nameAlreadyExists,s=a.similarNameExists,c=a.allowRename,d=a.allowReplace,l=a.offline,u=a.accessDenied,f=a.invalidName,p=a.emptyFileOrFolder,m=a.overQuota,_=a.lockMismatch,h=a.authFailure,b=a.folderUpload,g=a.targetFolder,v=a.malware,y=a.fileSize,S=a.throttle;if(o||i){var D=c||(null==i?void 0:i.supportsRename),x=d||!!i;if(D&&x)return Ue.conflictAll;if(D)return Ue.conflictRename;if(x)return Ue.conflictReplace}return s?Ue.similarNameExists:u?Ue.accessDenied:f?Ue.invalidName:p?Ue.emptyFileOrFolder:b?Ue.folderUpload:m?Ue.overQuota:_?Ue.lockMismatch:h?Ue.authFailure:g?Ue.targetFolder:v?Ue.malware:y?Ue.fileSize:S?Ue.throttle:l?Ue.offline:Ue.unknown}}(e,t);return n?{errorKey:n}:{}}(e,{itemKey:t.itemKey}):{}}function Ge(e,t){var n,o=e.demandItemFacet(p.v,t.itemKey),s=e.demandItemFacet(w.e,o&&o.itemKey);n=o&&!s?function(e,t){var n,o,s=e.demandItemFacet(T,t.itemKey),c=s?s.total>0?s.current/s.total:1:void 0,d=Object(h.n)(e,t),u=e.demandItemFacet(l._,t.sourceItemKey);if(Re){var f=e.demandItemFacet(l.u,t.sourceItemKey),m=e.demandItemFacet(p.y,t.itemKey),_=m&&m.itemKey;o=d!==p.a.expired&&d!==p.a.created?Be[d]({displayName:f,destinationItemKey:_}):void 0}d===p.a.completed&&s?n=de.e.getDisplayString(s.total):u?d!==p.a.created&&d!==p.a.started||(n=Qe(s)||ce.u):d===p.a.started?n=Qe(s):d===p.a.created&&(n=ce.r);var b=Object(a.__assign)(Object(a.__assign)({percentComplete:c},n?{description:n}:{}),o?{title:o}:{}),g=function(e,t){var n=e.demandItemFacet(E.t,t.itemKey);if(!n||n instanceof r.e)return{};var a=e.demandItemFacet(p.h,t.itemKey);if(!a||!Pe.matches(a))return{};var o=[];if(!(n instanceof _e.e))return{commands:o,description:he.d};var s=Object(I.n)({retry:ke.I,fileSize:ke.d},n.facets),c=s.retry,d=s.fileSize,u="";switch(a){case Ue.conflictAll:u=he.n,o.push(we),o.push(Ae);break;case Ue.conflictRename:u=he.a,o.push(Ae);break;case Ue.conflictReplace:u=he.i,o.push(we);break;case Ue.similarNameExists:u=he.m,o.push(Ae);break;case Ue.accessDenied:u=he.e;break;case Ue.invalidName:u=he.l;break;case Ue.emptyFileOrFolder:u=he.o;break;case Ue.folderUpload:u=he.c;break;case Ue.overQuota:u=he.p;break;case Ue.lockMismatch:u=he.u,o.push(be.e);break;case Ue.authFailure:u=he.t,o.push(be.e);break;case Ue.targetFolder:u=he._;break;case Ue.malware:u=he.f;break;case Ue.fileSize:if(d.maxFileSize){var f=de.e.getDisplayString(d.maxFileSize);u=Object(oe.format)(he.s,"","",f)}else u=he.d;break;case Ue.throttle:u=he.h,o.push(be.e);break;case Ue.offline:u=he.r,o.push(be.e)}c&&o.push(be.e),u||(u=n.message||he.d);var m=e.demandItemFacet(l.u,t.sourceItemKey),_=i.createElement("span",{className:Te.t},m);return{message:Object(oe.formatToArray)(u,_),commands:o}}(e,{itemKey:t.itemKey,sourceItemKey:t.sourceItemKey});return Object(a.__assign)(Object(a.__assign)({},b),g)}(e,{itemKey:t.itemKey,sourceItemKey:o.itemKey}):function(e,t){var n,i,r=e.demandItemFacet(T,t.itemKey),o=r?r.total>0?r.current/r.total:1:void 0,s=e.demandItemFacet(p.o,t.itemKey),c=s&&s.itemKey,d=Object(h.a)(e,t),l=d.phase,u=d.count;l===p.a.completed&&r?n=de.e.getDisplayString(r.total):l===p.a.started&&(n=Qe(r)||ce.u),i="group"===t.format&&c?je[l]({count:u,itemKey:c}):Ne[l]({count:u});var f=function(e,t){var n=e.demandItemFacet(p._,t.itemKey);if(!n)return{};var a=[];return n[Ue.conflictAll]>1?(a.push(Ee),a.push(Le)):n[Ue.conflictRename]>1?a.push(Le):n[Ue.conflictReplace]>1&&a.push(Ee),{commands:a}}(e,{itemKey:t.itemKey});return Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},i&&(Re||"item"!==t.format)?{title:i}:{}),n?{description:n}:{}),{percentComplete:o}),f)}(e,t);var c=e.demandItemFacet(me.e,t.itemKey),d=me.e.evaluate(c)(e,{itemKey:t.itemKey,commands:n.commands,description:n.description}),u=d.description,f=d.commands,m=void 0===f?[]:f;return Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},n),{commands:m}),u?{description:u}:{})}function Ke(e,t){return{mode:"single-item"}}function We(e){var t=this,n=e.itemKey;return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,r,o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(t=e(Object(O.e)(function(e){return{sourceItem:e.demandItemFacet(p.v,n),destinationItem:e.demandItemFacet(p.o,n)}})),i=t.sourceItem,r=t.destinationItem,o=i&&i.itemKey,s=r&&r.itemKey,!o)throw new Error("No source entry to retry.");if(!s)throw new Error("No parent item to retry.");return[4,e(W({sourceEntryKey:o,parentItemKey:s}))];case 1:return a.sent(),[2]}})})}}function qe(e){var t=this,n=e.itemKey,i=e.options;return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,r,o,s,c;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(t=e(Object(O.e)(function(e){return{sourceItem:e.demandItemFacet(p.v,n),destinationItem:e.demandItemFacet(p.o,n)}})),r=t.sourceItem,o=t.destinationItem,s=r&&r.itemKey,c=o&&o.itemKey,!s)throw new Error("No source entry to retry.");if(!c)throw new Error("No parent item to retry.");return[4,e(W({sourceEntryKey:s,parentItemKey:c,options:i}))];case 1:return a.sent(),[2]}})})}}function Qe(e){return e&&e.total>0?Object(oe.format)(ce.l,de.e.getDisplayString(e.current),de.e.getDisplayString(e.total)):void 0}var Ye=n(438),Je=n(2152),Xe=n(686),Ze=n(936),$e=n(402),et=n(472),tt=n(313),nt=n(303),at=n(114),it=Object(nt.e)(function(e){var t,n=[];return function(a){var i=new at.e,r=i.resolve,o=i.promise;return n.push({resolve:r,itemResolver:a}),t||(t=setTimeout(function(){!function(){var a=n;n=[],t=void 0;for(var i=[],r=0,o=a;r<o.length;r++){var s=o[r],c=s.resolve,d=s.itemResolver;i.push(c),e(d.execute())}for(var l=0,u=i;l<u.length;l++)(c=u[l])()}()},500)),o}}),rt=new et.e("batch"),ot=new Ie.e("batchChildren",{batch:rt.subKeyPart}),st=new Ie.e("fileEntry",{batch:rt.subKeyPart,index:$e.e,path:Me.e}),ct=new Ie.e("fileEntryChildren",{fileEntry:st.subKeyPart}),dt=new Ie.e("fileEntryDirectoryPage",{fileEntryChildren:ct.subKeyPart,startIndex:$e.e}),lt=new I.e("entry"),ut=new I.e("rootEntries"),ft=new I.e("directoryPage"),pt=Object(ae.t)(function(){return function(e){e(Object(v.t)({keyFacet:rt,facets:[c.t]})),e(Object(v.t)({keyFacet:ot,facets:[c.e]})),e(Object(v.t)({keyFacet:st,facets:[l.u,c.t,w.t,l.m,l.p,l._,l.k,l.c]})),e(Object(v.t)({keyFacet:ct,facets:[c.e]})),e(Object(v.t)({keyFacet:dt,facets:[c.e]})),e(Object(_.a)(rt,Ye.e)(Object(ae.i)({maxParallelOperationCount:8})(mt))),e(Object(_.a)(ot,Ye.e)(Object(ae.i)({maxParallelOperationCount:8})(_t))),e(Object(_.a)(st,Ye.e)(Object(ae.i)({maxParallelOperationCount:128})(ht))),e(Object(_.a)(ct,Ye.e)(Object(ae.i)({maxParallelOperationCount:32})(bt))),e(Object(_.a)(dt,Ye.e)(Object(ae.i)({maxParallelOperationCount:32})(gt))),e(Object(_.a)(rt,Xe.e)(Object(ae.i)({maxParallelOperationCount:8})(vt)))}});function mt(e){var t=this,n=e.itemKey,i=rt.deserialize(n);return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,r;return Object(a.__generator)(this,function(o){switch(o.label){case 0:return e(Object(O.e)(function(e){return e.demandItemFacet(ut,n)}))?((t=new j.e).resolveItems({items:(r={},r[n]=Object(a.__assign)(Object(a.__assign)({},w.e.pack({})),c.t.pack({itemKey:ot.serialize({batch:i})})),r)}),[4,e(it)(t)]):[3,2];case 1:o.sent(),o.label=2;case 2:return[2]}})})}}function _t(e){var t=this,n=e.itemKey,i=ot.deserialize(n).batch,r=rt.serialize(i);return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,o,s,d,l,u,f,p,m,_;return Object(a.__generator)(this,function(h){switch(h.label){case 0:if(!(t=e(Object(O.e)(function(e){return e.demandItemFacet(ut,r)}))))return[3,2];for(o=new j.e,s=[],d=0,l=0,u=t;l<u.length;l++)f=u[l],p=st.serialize({batch:i,index:d,path:f.name}),o.resolveItems({items:(m={},m[p]=Object(a.__assign)({},lt.pack(f)),m)}),s.push(p),d++;return o.resolveItems({items:(_={},_[n]=Object(a.__assign)({},c.e.pack({itemKeys:s})),_)}),[4,e(it)(o)];case 1:h.sent(),h.label=2;case 2:return[2]}})})}}function ht(e){var t=this,n=e.itemKey;return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,r,o,s;return Object(a.__generator)(this,function(d){switch(d.label){case 0:return(t=e(Object(O.e)(function(e){return e.demandItemFacet(lt,n)})))?((i=new j.e).resolveItems({items:(o={},o[n]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},l.u.pack(t.name)),t.type===Ze.e.directory?Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},l._.pack({})),l.p.pack({name:t.name,extension:""})),c.t.pack({itemKey:ct.serialize({fileEntry:st.deserialize(n)})})):Object(a.__assign)(Object(a.__assign)({},c.t.pack(void 0)),l._.pack(void 0))),t.type===Ze.e.file?Object(a.__assign)({},l.p.pack(yt(t.name))):{}),o)}),t.type!==Ze.e.file&&t.type!==Ze.e.unknown?[3,2]:[4,t.getFile()]):[2];case 1:r=d.sent(),i.resolveItems({items:(s={},s[n]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},l.p.pack(yt(r.name))),l._.pack(void 0)),l.m.pack(r.size)),l.c.pack(r.lastModified)),w.t.pack(r)),s)}),d.label=2;case 2:return[4,e(it)(i)];case 3:return d.sent(),[2]}})})}}function bt(e){var t=this,n=e.itemKey,i=ct.deserialize(n),r=i.fileEntry,o=st.serialize(r);return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){function t(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n,i,s,c,m;return Object(a.__generator)(this,function(_){switch(_.label){case 0:for(e=d.entries,t=d.getEntries,n=0,i=e;n<i.length;n++)s=i[n],c=st.serialize(Object(a.__assign)(Object(a.__assign)({},r),{index:f,path:"".concat(r.path,"/").concat(s.name)})),p.resolveItems({items:(m={},m[c]=Object(a.__assign)(Object(a.__assign)({},lt.pack(s)),l.k.pack({itemKey:o})),m)}),u.push(c),f++;return t?[4,t()]:[3,2];case 1:d=_.sent(),_.label=2;case 2:return[2,!!t]}})})}var s,d,u,f,p,m,_,h,b;return Object(a.__generator)(this,function(l){switch(l.label){case 0:return(s=e(Object(O.e)(function(e){return e.demandItemFacet(lt,st.serialize(r))})))&&s.type===Ze.e.directory?[4,s.getEntries()]:[2];case 1:return d=l.sent(),u=[],f=0,p=new j.e,[4,t()];case 2:return(m=l.sent())?[4,t()]:[3,4];case 3:m=l.sent(),l.label=4;case 4:return m&&(_=dt.serialize({fileEntryChildren:i,startIndex:f}),p.merge(Object(tt.t)({itemKey:_}).itemResolver),p.resolveItems({items:(h={},h[_]=Object(a.__assign)({},ft.pack(d)),h)}),u.push(_)),p.resolveItems({items:(b={},b[n]=Object(a.__assign)(Object(a.__assign)({},c.e.pack({itemKeys:u})),c.r.pack({itemKey:o})),b)}),[4,e(it)(p)];case 5:return l.sent(),[2]}})})}}function gt(e){var t=this,n=e.itemKey,i=dt.deserialize(n),r=i.fileEntryChildren,o=i.startIndex,s=r.fileEntry,c=st.serialize(s);return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){function t(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n,i,r,o,m;return Object(a.__generator)(this,function(_){switch(_.label){case 0:for(e=d.entries,t=d.getEntries,n=0,i=e;n<i.length;n++)r=i[n],o=st.serialize(Object(a.__assign)(Object(a.__assign)({},s),{index:u,path:"".concat(s.path,"/").concat(r.name)})),p.resolveItems({items:(m={},m[o]=Object(a.__assign)(Object(a.__assign)({},lt.pack(r)),l.k.pack({itemKey:c})),m)}),f.push(o),u++;return t?[4,t()]:[3,2];case 1:d=_.sent(),_.label=2;case 2:return[2,!!t]}})})}var i,d,u,f,p,m,_,h;return Object(a.__generator)(this,function(s){switch(s.label){case 0:return(i=e(Object(O.e)(function(e){return e.demandItemFacet(ft,n)})))?(d=i,u=o,f=[],p=new j.e,[4,t()]):[2];case 1:return(m=s.sent())?[4,t()]:[3,3];case 2:m=s.sent(),s.label=3;case 3:return m&&(_=dt.serialize({fileEntryChildren:r,startIndex:u}),p.merge(Object(tt.t)({itemKey:_}).itemResolver),p.resolveItems({items:(h={},h[_]=Object(a.__assign)({},ft.pack(d)),h)}),f.push(_)),p.merge(Object(tt.e)({itemKey:n,itemSetKey:ct.serialize(r),childItemKeys:f}).itemResolver),[4,e(it)(p)];case 4:return s.sent(),[2]}})})}}function vt(e){var t=this,n=e.itemKey;return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(t){return e(Object(Je.e)({items:e(Object(O.e)(function(e){for(var t,a={},i=[n];t=i.pop();){a[t]=!0;var r=e.demandItemFacet(c.t,t),o=r&&r.itemKey;o&&(a[o]=!0);var s=e.demandItemFacet(c.e,o),d=s&&s.itemKeys;d&&i.push.apply(i,d)}return a}))})),[2]})})}}function yt(e){var t=e.lastIndexOf(".");return t>-1?{name:e.slice(0,t),extension:e.slice(t)}:{name:e,extension:""}}var St=n(663),Dt=n(108),It=n(184);function xt(e){var t=this,n=e.resolve,o=e.reject,s=e.entries,c=e.itemKey,d=e.onUploadStarted,l=e.onUploadCompleted,u=e.onUploadFailed,f=e.onItemQueued,p=e.onItemUploaded,m=e.onItemFailed,_=i.useState(!1),h=_[0],b=_[1],g=i.useState(!1),v=g[0],y=g[1],S=i.useState(),D=S[0],I=S[1],x=i.useState(!1),C=x[0],O=x[1],E=i.useRef(),A=E.current||(E.current=new r.t);i.useLayoutEffect(function(){return function(){A.dispose(),E.current=void 0}},[]);var L=Object(St.e)(v),k=Object(St.e)(D),M=Object(St.e)(C),P=Object(It.t)(),T=Object(Dt.e)(function(e){d&&d(e)}),U=Object(Dt.e)(function(e){l&&l(e)}),F=Object(Dt.e)(function(e){u&&u(e)}),H=Object(Dt.e)(function(e){f&&f(e)}),R=Object(Dt.e)(function(e){p&&p(e)}),N=Object(Dt.e)(function(e){m&&m(e)}),B=Object(Dt.e)(function(){return Object(a.__awaiter)(t,void 0,void 0,function(){var e,t;return Object(a.__generator)(this,function(n){switch(n.label){case 0:b(!0),n.label=1;case 1:return n.trys.push([1,3,,4]),P(Ve),e=P((i={entries:s},function(e){var t;e(pt);var n=rt.serializeNext(),r=new j.e;return r.resolveItems({items:(t={},t[n]=Object(a.__assign)(Object(a.__assign)({},w.e.pack({})),ut.pack(i.entries)),t)}),e(r.execute()),{itemKey:n}})).itemKey,[4,P(W({parentItemKey:c,sourceEntryKey:e,callbacks:{onEntryBatchCreated:T,onEntryBatchFailed:F,onEntryBatchUploaded:U,onItemFailed:N,onItemUploaded:R,onItemQueued:H},cancelToken:A.token}))];case 2:return n.sent(),A.token.isCanceled()?[2]:(O(!0),[3,4]);case 3:return t=n.sent(),A.token.isCanceled()?[2]:(Object(r.n)(t)?y(!0):I(t),[3,4]);case 4:return[2]}var i})})});return i.useLayoutEffect(function(){C&&!M?n():D&&!k?o(D):v&&!L?o(new r.e):h||B()},[h,v,D,C]),null}},2097:function(e,t,n){"use strict";n.r(t),n.d(t,"MalwareDetectedDialog",function(){return g}),n.d(t,"ItemsContextMenu",function(){return W}),n.d(t,"NO_ITEMS",function(){return A}),n.d(t,"ActionContextMenu",function(){return L}),n.d(t,"Uploader",function(){return q.Uploader});var a=n(0),i=n("react-lib"),r=n(18),o=n(2310),s=n(2387),c=n(2241),d=n(2272),l=n(1912),u=n(188),f=n(4618),p=n(3518),m=n(25),_=n(22),h=n(1662),b=n(108);function g(e){var t=this,n=e.itemKey,g=e.resolve,y=e.reject,S=i.useState(!1),D=S[0],I=S[1],x=Object(b.e)(function(){y(new u.e)}),C=Object(m.L)();return i.createElement(_.n,{action:i.createElement(h.t,{itemKeys:[n]})},function(e){var n=e.isAvailable,u=e.execute,m=n?function(){return Object(a.__awaiter)(t,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),I(!0),[4,u()];case 1:return t.sent(),g(),[3,3];case 2:return e=t.sent(),y(e),[3,3];case 3:return[2]}})})}:void 0,_=n?f.t:f.i;return D?null:i.createElement(s.e,{hidden:!1,onDismiss:x,title:f.n,closeButtonAriaLabel:f.e,type:c.e.close,styles:v,dialogContentProps:{styles:function(){return{title:{color:C.semanticColors.errorText,fontWeight:"500"}}}}},i.createElement(o.e,null,r.formatToArray(_,i.createElement("a",{href:"https://go.microsoft.com/fwlink/?linkid=862871",target:"_blank"},f.a))),i.createElement(d.e,null,m?i.createElement(l.e,{onClick:m},f.r):null,i.createElement(l.e,{onClick:x,primary:!0},p.n)))})}function v(){return{main:{maxWidth:"450px !important"}}}var y=n(44),S=n(56),D=n(175),I=n(2062),x=n(1060),C=n(342),O=n(4619);function w(e,t){var n=t.preserveIcons,i=void 0!==n&&n;return e.map(function(e){var n=e.subMenuProps,r=Object(a.__rest)(e,["subMenuProps"]);return Object(a.__assign)(Object(a.__assign)({},r),{name:e.iconProps&&"More"===e.iconProps.iconName?O.e:e.name,icon:void 0,iconProps:i?e.iconProps:void 0,subMenuProps:n?Object(a.__assign)(Object(a.__assign)({},n),{items:w(n.items,t)}):void 0})})}var E=n(885),A=[],L=Object(S.t)(function(e,t){var n=t.items,r=void 0===n?A:n,o=t.directionalHint,s=void 0===o?D.e.rightTopEdge:o,c=t.isBeakVisible,d=void 0!==c&&c,l=t.isOpen,u=t.contextMenuAs,f=Object(a.__rest)(t,["items","directionalHint","isBeakVisible","isOpen","contextMenuAs"]),p=u?Object(E.e)(u,I.e):I.e;return i.createElement(x.e,{commands:t.commands},function(e){var n=e.menuItems,o=Object(C.n)(r,w(n,t));return l?i.createElement(p,Object(a.__assign)({},f,{items:o,directionalHint:s,isBeakVisible:d})):null})}),k=n(422),M=n(213),P=n(312),T=n(535),U=n(238),F=n(453),H=n(1133),R=n(456),N=n(138),B=n(203),j=n(59),V=n(761),z=n(174),G=[M.e,P.e,T.e,U.n,U.t,V.e,F.e,R.e,H.e],K=Object(N.t)({withContext:{component:"ContextMenu"}}),W=Object(B.n)(K)(Object(S.t)(function(e,t){t.isOpen&&Object(z.t)("ItemsContextMenu.render");var n=Object(j.e)(e),r=Object(y.e)(e),o=t.commands,s=void 0===o?[]:o,c=e.demandItemFacet(k.e,n),d=k.e.evaluate(c)(e,{itemKey:n||"",itemSetKey:r,commands:G,preserveIcons:t.preserveIcons}),l=d.commands,u=d.onMenuOpened,f=d.contextMenuAs,p=d.preserveIcons;return i.createElement(L,Object(a.__assign)({},t,{commands:Object(C.n)(l,s),onMenuOpened:u,contextMenuAs:f,preserveIcons:p}))}));W.displayName="ItemsContextMenu";var q=n(2059)},2241:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.normal=0]="normal",e[e.largeHeader=1]="largeHeader",e[e.close=2]="close"}(a||(a={}))},2272:function(e,t,n){"use strict";n.d(t,"e",function(){return f});var a=n(1902),i=n(0),r=n("react-lib"),o=n(662),s=n(1266),c=Object(o.e)(),d=function(e){function t(t){var n=e.call(this,t)||this;return Object(s.e)(n),n}return Object(i.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.styles,a=e.theme;return this._classNames=c(n,{theme:a,className:t}),r.createElement("div",{className:this._classNames.actions},r.createElement("div",{className:this._classNames.actionsRight},this._renderChildrenAsActions()))},t.prototype._renderChildrenAsActions=function(){var e=this;return r.Children.map(this.props.children,function(t){return t?r.createElement("span",{className:e._classNames.action},t):null})},t}(r.Component),l=n(25),u={actions:"ms-Dialog-actions",action:"ms-Dialog-action",actionsRight:"ms-Dialog-actionsRight"},f=Object(a.e)(d,function(e){var t=e.className,n=e.theme,a=Object(l.I)(u,n);return{actions:[a.actions,{position:"relative",width:"100%",minHeight:"24px",lineHeight:"24px",margin:"16px 0 0",fontSize:"0",selectors:{".ms-Button":{lineHeight:"normal",verticalAlign:"middle"}}},t],action:[a.action,{margin:"0 4px"}],actionsRight:[a.actionsRight,{alignItems:"center",display:"flex",fontSize:"0",justifyContent:"flex-end",marginRight:"-4px"}]}},void 0,{scope:"DialogFooter"})},2310:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var a=n(1902),i=n(0),r=n("react-lib"),o=n(125),s=n(662),c=Object(s.e)({cacheSize:100}),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.as,n=void 0===t?"label":t,a=e.children,s=e.className,d=e.disabled,l=e.styles,u=e.required,f=e.theme,p=c(l,{className:s,disabled:d,required:u,theme:f});return r.createElement(n,Object(i.__assign)({},Object(o.s)(this.props,o.r),{className:p.root}),a)},t}(r.Component),l=n(25),u=Object(a.e)(d,function(e){var t,n=e.theme,a=e.className,r=e.disabled,o=e.required,s=n.semanticColors,c=l.r.semibold,d=s.bodyText,u=s.disabledBodyText,f=s.errorText;return{root:["ms-Label",n.fonts.medium,{fontWeight:c,color:d,boxSizing:"border-box",boxShadow:"none",margin:0,display:"block",padding:"5px 0",wordWrap:"break-word",overflowWrap:"break-word"},r&&{color:u,selectors:(t={},t[l.o]=Object(i.__assign)({color:"GrayText"},Object(l.x)()),t)},o&&{selectors:{"::after":{content:"' *'",color:f,paddingRight:12}}},a]}},void 0,{scope:"Label"})},2337:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n("react-lib"),i=n(668);function r(e){var t=a.useState(e),n=t[0],r=t[1];return[n,{setTrue:Object(i.e)(function(){return function(){r(!0)}}),setFalse:Object(i.e)(function(){return function(){r(!1)}}),toggle:Object(i.e)(function(){return function(){r(function(e){return!e})}})}]}},2340:function(e,t,n){"use strict";n.d(t,"e",function(){return m});var a=n(1902),i=n(0),r=n("react-lib"),o=n(662),s=n(1266),c=n(1003),d=n(125),l=Object(o.e)(),u=function(e){function t(t){var n=e.call(this,t)||this;Object(s.e)(n);var a=n.props.allowTouchBodyScroll,i=void 0!==a&&a;return n._allowTouchBodyScroll=i,n}return Object(i.__extends)(t,e),t.prototype.componentDidMount=function(){!this._allowTouchBodyScroll&&Object(c.n)()},t.prototype.componentWillUnmount=function(){!this._allowTouchBodyScroll&&Object(c.a)()},t.prototype.render=function(){var e=this.props,t=e.isDarkThemed,n=e.className,a=e.theme,o=e.styles,s=Object(d.s)(this.props,d.r),c=l(o,{theme:a,className:n,isDark:t});return r.createElement("div",Object(i.__assign)({},s,{className:c.root}))},t}(r.Component),f=n(25),p={root:"ms-Overlay",rootDark:"ms-Overlay--dark"},m=Object(a.e)(u,function(e){var t,n=e.className,a=e.theme,i=e.isNone,r=e.isDark,o=a.palette,s=Object(f.I)(p,a);return{root:[s.root,a.fonts.medium,{backgroundColor:o.whiteTranslucent40,top:0,right:0,bottom:0,left:0,position:"absolute",selectors:(t={},t[f.o]={border:"1px solid WindowText",opacity:0},t)},i&&{visibility:"hidden"},r&&[s.rootDark,{backgroundColor:o.blackTranslucent40}],n]}},void 0,{scope:"Overlay"})},2360:function(e,t,n){"use strict";n.d(t,"e",function(){return j});var a=n(1902),i=n(0),r=n("react-lib"),o=n(662),s=n(1985),c=n(226),d=n(1003),l=n(139),u=n(749),f=n(49),p=n(2210),m=n(25),_=m.n.durationValue2,h={root:"ms-Modal",main:"ms-Dialog-main",scrollableContent:"ms-Modal-scrollableContent",isOpen:"is-open",layer:"ms-Modal-Layer"},b=n(2340),g=n(1998),v=n(2172),y=n(2177),S=n(353),D=n(175),I=n(512),x=n(132),C=Object(x.t)(function(e,t){return{root:Object(m.U)(e,t&&{touchAction:"none",selectors:{"& *":{userSelect:"none"}}})}}),O=n(1984),w={start:"touchstart",move:"touchmove",stop:"touchend"},E={start:"mousedown",move:"mousemove",stop:"mouseup"},A=function(e){function t(t){var n=e.call(this,t)||this;return n._currentEventType=E,n._events=[],n._onMouseDown=function(e){var t=r.Children.only(n.props.children).props.onMouseDown;return t&&t(e),n._currentEventType=E,n._onDragStart(e)},n._onMouseUp=function(e){var t=r.Children.only(n.props.children).props.onMouseUp;return t&&t(e),n._currentEventType=E,n._onDragStop(e)},n._onTouchStart=function(e){var t=r.Children.only(n.props.children).props.onTouchStart;return t&&t(e),n._currentEventType=w,n._onDragStart(e)},n._onTouchEnd=function(e){var t=r.Children.only(n.props.children).props.onTouchEnd;t&&t(e),n._currentEventType=w,n._onDragStop(e)},n._onDragStart=function(e){if("number"==typeof e.button&&0!==e.button)return!1;if(!(n.props.handleSelector&&!n._matchesSelector(e.target,n.props.handleSelector)||n.props.preventDragSelector&&n._matchesSelector(e.target,n.props.preventDragSelector))){n._touchId=n._getTouchId(e);var t=n._getControlPosition(e);if(void 0!==t){var a=n._createDragDataFromPosition(t);n.props.onStart&&n.props.onStart(e,a),n.setState({isDragging:!0,lastPosition:t}),n._events=[Object(O.e)(document.body,n._currentEventType.move,n._onDrag,!0),Object(O.e)(document.body,n._currentEventType.stop,n._onDragStop,!0)]}}},n._onDrag=function(e){"touchmove"===e.type&&e.preventDefault();var t=n._getControlPosition(e);if(t){var a=n._createUpdatedDragData(n._createDragDataFromPosition(t)),i=a.position;n.props.onDragChange&&n.props.onDragChange(e,a),n.setState({position:i,lastPosition:t})}},n._onDragStop=function(e){if(n.state.isDragging){var t=n._getControlPosition(e);if(t){var a=n._createDragDataFromPosition(t);n.setState({isDragging:!1,lastPosition:void 0}),n.props.onStop&&n.props.onStop(e,a),n.props.position&&n.setState({position:n.props.position}),n._events.forEach(function(e){return e()})}}},n.state={isDragging:!1,position:n.props.position||{x:0,y:0},lastPosition:void 0},n}return Object(i.__extends)(t,e),t.prototype.componentDidUpdate=function(e){!this.props.position||e.position&&this.props.position===e.position||this.setState({position:this.props.position})},t.prototype.componentWillUnmount=function(){this._events.forEach(function(e){return e()})},t.prototype.render=function(){var e=r.Children.only(this.props.children),t=e.props,n=this.props.position,a=this.state,o=a.position,s=a.isDragging,c=o.x,d=o.y;return n&&!s&&(c=n.x,d=n.y),r.cloneElement(e,{style:Object(i.__assign)(Object(i.__assign)({},t.style),{transform:"translate("+c+"px, "+d+"px)"}),className:C(t.className,this.state.isDragging).root,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onTouchStart:this._onTouchStart,onTouchEnd:this._onTouchEnd})},t.prototype._getControlPosition=function(e){var t=this._getActiveTouch(e);if(void 0===this._touchId||t){var n=t||e;return{x:n.clientX,y:n.clientY}}},t.prototype._getActiveTouch=function(e){return e.targetTouches&&this._findTouchInTouchList(e.targetTouches)||e.changedTouches&&this._findTouchInTouchList(e.changedTouches)},t.prototype._getTouchId=function(e){var t=e.targetTouches&&e.targetTouches[0]||e.changedTouches&&e.changedTouches[0];if(t)return t.identifier},t.prototype._matchesSelector=function(e,t){if(!e||e===document.body)return!1;var n=e.matches||e.webkitMatchesSelector||e.msMatchesSelector;return!!n&&(n.call(e,t)||this._matchesSelector(e.parentElement,t))},t.prototype._findTouchInTouchList=function(e){if(void 0!==this._touchId)for(var t=0;t<e.length;t++)if(e[t].identifier===this._touchId)return e[t]},t.prototype._createDragDataFromPosition=function(e){var t=this.state.lastPosition;return void 0===t?{delta:{x:0,y:0},lastPosition:e,position:e}:{delta:{x:e.x-t.x,y:e.y-t.y},lastPosition:t,position:e}},t.prototype._createUpdatedDragData=function(e){var t=this.state.position;return{position:{x:t.x+e.delta.x,y:t.y+e.delta.y},delta:e.delta,lastPosition:t}},t}(r.Component),L=n(1264),k=n(1980),M=n(2174),P=n(1993),T=n(2337),U=n(668),F=n(2189),H={x:0,y:0},R={isOpen:!1,isDarkOverlay:!0,className:"",containerClassName:"",enableAriaHiddenSiblings:!0},N=Object(o.e)(),B=r.forwardRef(function(e,t){var n,a,o,m,h,x=Object(s.e)(R,e),C=x.allowTouchBodyScroll,O=x.className,w=x.children,E=x.containerClassName,B=x.scrollableContentClassName,j=x.elementToFocusOnDismiss,V=x.firstFocusableSelector,z=x.focusTrapZoneProps,G=x.forceFocusInsideTrap,K=x.disableRestoreFocus,W=void 0===K?x.ignoreExternalFocusing:K,q=x.isBlocking,Q=x.isAlert,Y=x.isClickableOutsideFocusTrap,J=x.isDarkOverlay,X=x.onDismiss,Z=x.layerProps,$=x.overlay,ee=x.isOpen,te=x.titleAriaId,ne=x.styles,ae=x.subtitleAriaId,ie=x.theme,re=x.topOffsetFixed,oe=x.responsiveMode,se=x.onLayerDidMount,ce=x.isModeless,de=x.dragOptions,le=x.onDismissed,ue=x.enableAriaHiddenSiblings,fe=x.popupProps,pe=r.useRef(null),me=r.useRef(null),_e=Object(k.e)(me,null==z?void 0:z.componentRef),he=r.useRef(null),be=Object(k.e)(pe,t),ge=Object(y.e)(be),ve=Object(M.e)("ModalFocusTrapZone",null==z?void 0:z.id),ye=Object(L.n)(),Se=Object(P.e)(),De=Se.setTimeout,Ie=Se.clearTimeout,xe=r.useState(ee),Ce=xe[0],Oe=xe[1],we=r.useState(ee),Ee=we[0],Ae=we[1],Le=r.useState(H),ke=Le[0],Me=Le[1],Pe=r.useState(),Te=Pe[0],Ue=Pe[1],Fe=Object(T.e)(!1),He=Fe[0],Re=Fe[1],Ne=Re.toggle,Be=Re.setFalse,je=Object(U.e)(function(){return{onModalCloseTimer:0,allowTouchBodyScroll:C,scrollableContent:null,lastSetCoordinates:H,events:new c.e({})}}),Ve=(de||{}).keepInBounds,ze=null!=Q?Q:q&&!ce,Ge=void 0===Z?"":Z.className,Ke=N(ne,{theme:ie,className:O,containerClassName:E,scrollableContentClassName:B,isOpen:ee,isVisible:Ee,hasBeenOpened:je.hasBeenOpened,modalRectangleTop:Te,topOffsetFixed:re,isModeless:ce,layerClassName:Ge,windowInnerHeight:null==ye?void 0:ye.innerHeight,isDefaultDragHandle:de&&!de.dragHandleSelector}),We=Object(i.__assign)(Object(i.__assign)({eventBubblingEnabled:!1},Z),{onLayerDidMount:Z&&Z.onLayerDidMount?Z.onLayerDidMount:se,insertFirst:(null==Z?void 0:Z.insertFirst)||ce,className:Ke.layer}),qe=r.useCallback(function(e){e?je.allowTouchBodyScroll?Object(d.e)(e,je.events):Object(d.t)(e,je.events):je.events.off(je.scrollableContent),je.scrollableContent=e},[je]),Qe=function(){var e=he.current,t=null==e?void 0:e.getBoundingClientRect();t&&(re&&Ue(t.top),Ve&&(je.minPosition={x:-t.left,y:-t.top},je.maxPosition={x:t.left,y:t.top}))},Ye=r.useCallback(function(e,t){var n=je.minPosition,a=je.maxPosition;return Ve&&n&&a&&(t=Math.max(n[e],t),t=Math.min(a[e],t)),t},[Ve,je]),Je=function(){var e;je.lastSetCoordinates=H,Be(),je.isInKeyboardMoveMode=!1,Oe(!1),Me(H),null===(e=je.disposeOnKeyUp)||void 0===e||e.call(je),null==le||le()},Xe=r.useCallback(function(){Be(),je.isInKeyboardMoveMode=!1},[je,Be]),Ze=r.useCallback(function(e,t){Me(function(e){return{x:Ye("x",e.x+t.delta.x),y:Ye("y",e.y+t.delta.y)}})},[Ye]),$e=r.useCallback(function(){me.current&&me.current.focus()},[]);r.useEffect(function(){var e;Ie(je.onModalCloseTimer),ee&&(requestAnimationFrame(function(){return De(Qe,0)}),Oe(!0),de&&(e=function(e){e.altKey&&e.ctrlKey&&e.keyCode===l.e.space&&Object(u.e)(je.scrollableContent,e.target)&&(Ne(),e.preventDefault(),e.stopPropagation())},je.disposeOnKeyUp||(je.events.on(ye,"keyup",e,!0),je.disposeOnKeyUp=function(){je.events.off(ye,"keyup",e,!0),je.disposeOnKeyUp=void 0})),je.hasBeenOpened=!0,Ae(!0)),!ee&&Ce&&(je.onModalCloseTimer=De(Je,1e3*parseFloat(_)),Ae(!1))},[Ce,ee]),Object(F.e)(function(){je.events.dispose()}),function(e,t){r.useImperativeHandle(e.componentRef,function(){return{focus:function(){t.current&&t.current.focus()}}},[t])}(x,me);var et=r.createElement(p.e,Object(i.__assign)({},z,{id:ve,ref:he,componentRef:_e,className:Object(f.e)(Ke.main,null==z?void 0:z.className),elementToFocusOnDismiss:null!==(n=null==z?void 0:z.elementToFocusOnDismiss)&&void 0!==n?n:j,isClickableOutsideFocusTrap:null!==(a=null==z?void 0:z.isClickableOutsideFocusTrap)&&void 0!==a?a:ce||Y||!q,disableRestoreFocus:null!==(o=null==z?void 0:z.disableRestoreFocus)&&void 0!==o?o:W,forceFocusInsideTrap:(null!==(m=null==z?void 0:z.forceFocusInsideTrap)&&void 0!==m?m:G)&&!ce,firstFocusableSelector:(null==z?void 0:z.firstFocusableSelector)||V,focusPreviouslyFocusedInnerElement:null===(h=null==z?void 0:z.focusPreviouslyFocusedInnerElement)||void 0===h||h,onBlur:je.isInKeyboardMoveMode?function(e){var t,n;null===(t=null==z?void 0:z.onBlur)||void 0===t||t.call(z,e),je.lastSetCoordinates=H,je.isInKeyboardMoveMode=!1,null===(n=je.disposeOnKeyDown)||void 0===n||n.call(je)}:void 0}),de&&je.isInKeyboardMoveMode&&r.createElement("div",{className:Ke.keyboardMoveIconContainer},de.keyboardMoveIconProps?r.createElement(I.e,Object(i.__assign)({},de.keyboardMoveIconProps)):r.createElement(I.e,{iconName:"move",className:Ke.keyboardMoveIcon})),r.createElement("div",{ref:qe,className:Ke.scrollableContent,"data-is-scrollable":!0},de&&He&&r.createElement(de.menu,{items:[{key:"move",text:de.moveMenuItemText,onClick:function(){var e=function(e){if(e.altKey&&e.ctrlKey&&e.keyCode===l.e.space)return e.preventDefault(),void e.stopPropagation();var t=e.altKey||e.keyCode===l.e.escape;if(He&&t&&Be(),!je.isInKeyboardMoveMode||e.keyCode!==l.e.escape&&e.keyCode!==l.e.enter||(je.isInKeyboardMoveMode=!1,e.preventDefault(),e.stopPropagation()),je.isInKeyboardMoveMode){var n=!0,a=function(e){var t=10;return e.shiftKey?e.ctrlKey||(t=50):e.ctrlKey&&(t=1),t}(e);switch(e.keyCode){case l.e.escape:Me(je.lastSetCoordinates);case l.e.enter:je.lastSetCoordinates=H;break;case l.e.up:Me(function(e){return{x:e.x,y:Ye("y",e.y-a)}});break;case l.e.down:Me(function(e){return{x:e.x,y:Ye("y",e.y+a)}});break;case l.e.left:Me(function(e){return{x:Ye("x",e.x-a),y:e.y}});break;case l.e.right:Me(function(e){return{x:Ye("x",e.x+a),y:e.y}});break;default:n=!1}n&&(e.preventDefault(),e.stopPropagation())}};je.lastSetCoordinates=ke,Be(),je.isInKeyboardMoveMode=!0,je.events.on(ye,"keydown",e,!0),je.disposeOnKeyDown=function(){je.events.off(ye,"keydown",e,!0),je.disposeOnKeyDown=void 0}}},{key:"close",text:de.closeMenuItemText,onClick:Je}],onDismiss:Be,alignTargetEdge:!0,coverTarget:!0,directionalHint:D.e.topLeftEdge,directionalHintFixed:!0,shouldFocusOnMount:!0,target:je.scrollableContent}),w));return Ce&&ge>=(oe||S.e.small)&&r.createElement(g.e,Object(i.__assign)({ref:be},We),r.createElement(v.e,Object(i.__assign)({role:ze?"alertdialog":"dialog",ariaLabelledBy:te,ariaDescribedBy:ae,onDismiss:X,shouldRestoreFocus:!W,enableAriaHiddenSiblings:ue,"aria-modal":!ce},fe),r.createElement("div",{className:Ke.root,role:ce?void 0:"document"},!ce&&r.createElement(b.e,Object(i.__assign)({"aria-hidden":!0,isDarkThemed:J,onClick:q?void 0:X,allowTouchBodyScroll:C},$)),de?r.createElement(A,{handleSelector:de.dragHandleSelector||"#"+ve,preventDragSelector:"button",onStart:Xe,onDragChange:Ze,onStop:$e,position:ke},et):et)))||null});B.displayName="Modal";var j=Object(a.e)(B,function(e){var t,n=e.className,a=e.containerClassName,i=e.scrollableContentClassName,r=e.isOpen,o=e.isVisible,s=e.hasBeenOpened,c=e.modalRectangleTop,d=e.theme,l=e.topOffsetFixed,u=e.isModeless,f=e.layerClassName,p=e.isDefaultDragHandle,b=e.windowInnerHeight,g=d.palette,v=d.effects,y=d.fonts,S=Object(m.I)(h,d);return{root:[S.root,y.medium,{backgroundColor:"transparent",position:"fixed",height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",opacity:0,pointerEvents:"none",transition:"opacity "+_},l&&"number"==typeof c&&s&&{alignItems:"flex-start"},r&&S.isOpen,o&&{opacity:1},o&&!u&&{pointerEvents:"auto"},n],main:[S.main,{boxShadow:v.elevation64,borderRadius:v.roundedCorner2,backgroundColor:g.white,boxSizing:"border-box",position:"relative",textAlign:"left",outline:"3px solid transparent",maxHeight:"calc(100% - 32px)",maxWidth:"calc(100% - 32px)",minHeight:"176px",minWidth:"288px",overflowY:"auto",zIndex:u?m.g.Layer:void 0},u&&{pointerEvents:"auto"},l&&"number"==typeof c&&s&&{top:c},p&&{cursor:"move"},a],scrollableContent:[S.scrollableContent,{overflowY:"auto",flexGrow:1,maxHeight:"100vh",selectors:(t={},t["@supports (-webkit-overflow-scrolling: touch)"]={maxHeight:b},t)},i],layer:u&&[f,S.layer,{pointerEvents:"none"}],keyboardMoveIconContainer:{position:"absolute",display:"flex",justifyContent:"center",width:"100%",padding:"3px 0px"},keyboardMoveIcon:{fontSize:y.xLargePlus.fontSize,width:"24px"}}},void 0,{scope:"Modal",fields:["theme","styles","enableAriaHiddenSiblings"]});j.displayName="Modal"},2387:function(e,t,n){"use strict";n.d(t,"e",function(){return w});var a=n(1902),i=n(0),r=n("react-lib"),o=n(662),s=n(747),c=n(2241),d=n(2360),l=n(353),u=n(1266),f=n(1826),p=n(49),m=n(2033),_=n(2272),h=Object(o.e)(),b=r.createElement(_.e,null).type,g=function(e){function t(t){var n=e.call(this,t)||this;return Object(u.e)(n),Object(f.e)("DialogContent",t,{titleId:"titleProps.id"}),n}return Object(i.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.showCloseButton,a=t.className,o=t.closeButtonAriaLabel,s=t.onDismiss,d=t.subTextId,l=t.subText,u=t.titleProps,f=void 0===u?{}:u,_=t.titleId,b=t.title,g=t.type,v=t.styles,y=t.theme,S=t.draggableHeaderClassName,D=h(v,{theme:y,className:a,isLargeHeader:g===c.e.largeHeader,isClose:g===c.e.close,draggableHeaderClassName:S}),I=this._groupChildren();return l&&(e=r.createElement("p",{className:D.subText,id:d},l)),r.createElement("div",{className:D.content},r.createElement("div",{className:D.header},r.createElement("div",Object(i.__assign)({id:_,role:"heading","aria-level":1},f,{className:Object(p.e)(D.title,f.className)}),b),r.createElement("div",{className:D.topButton},this.props.topButtonsProps.map(function(e,t){return r.createElement(m.e,Object(i.__assign)({key:e.uniqueId||t},e))}),(g===c.e.close||n&&g!==c.e.largeHeader)&&r.createElement(m.e,{className:D.button,iconProps:{iconName:"Cancel"},ariaLabel:o,onClick:s}))),r.createElement("div",{className:D.inner},r.createElement("div",{className:D.innerContent},e,I.contents),I.footers))},t.prototype._groupChildren=function(){var e={footers:[],contents:[]};return r.Children.map(this.props.children,function(t){"object"==typeof t&&null!==t&&t.type===b?e.footers.push(t):e.contents.push(t)}),e},t.defaultProps={showCloseButton:!1,className:"",topButtonsProps:[],closeButtonAriaLabel:"Close"},Object(i.__decorate)([l.i],t)}(r.Component),v=n(25),y={contentLgHeader:"ms-Dialog-lgHeader",close:"ms-Dialog--close",subText:"ms-Dialog-subText",header:"ms-Dialog-header",headerLg:"ms-Dialog--lgHeader",button:"ms-Dialog-button ms-Dialog-button--close",inner:"ms-Dialog-inner",content:"ms-Dialog-content",title:"ms-Dialog-title"},S=Object(a.e)(g,function(e){var t,n,a,i=e.className,r=e.theme,o=e.isLargeHeader,s=e.isClose,c=e.hidden,d=e.isMultiline,l=e.draggableHeaderClassName,u=r.palette,f=r.fonts,p=r.effects,m=r.semanticColors,_=Object(v.I)(y,r);return{content:[o&&[_.contentLgHeader,{borderTop:"4px solid "+u.themePrimary}],s&&_.close,{flexGrow:1,overflowY:"hidden"},i],subText:[_.subText,f.medium,{margin:"0 0 24px 0",color:m.bodySubtext,lineHeight:"1.5",wordWrap:"break-word",fontWeight:v.r.regular}],header:[_.header,{position:"relative",width:"100%",boxSizing:"border-box"},s&&_.close,l&&[l,{cursor:"move"}]],button:[_.button,c&&{selectors:{".ms-Icon.ms-Icon--Cancel":{color:m.buttonText,fontSize:v.c.medium}}}],inner:[_.inner,{padding:"0 24px 24px",selectors:(t={},t["@media (min-width: "+v.m+"px) and (max-width: "+v.u+"px)"]={padding:"0 16px 16px"},t)}],innerContent:[_.content,{position:"relative",width:"100%"}],title:[_.title,f.xLarge,{color:m.bodyText,margin:"0",minHeight:f.xLarge.fontSize,padding:"16px 46px 20px 24px",lineHeight:"normal",selectors:(n={},n["@media (min-width: "+v.m+"px) and (max-width: "+v.u+"px)"]={padding:"16px 46px 16px 16px"},n)},o&&{color:m.menuHeader},d&&{fontSize:f.xxLarge.fontSize}],topButton:[{display:"flex",flexDirection:"row",flexWrap:"nowrap",position:"absolute",top:"0",right:"0",padding:"15px 15px 0 0",selectors:(a={"> *":{flex:"0 0 auto"},".ms-Dialog-button":{color:m.buttonText},".ms-Dialog-button:hover":{color:m.buttonTextHovered,borderRadius:p.roundedCorner2}},a["@media (min-width: "+v.m+"px) and (max-width: "+v.u+"px)"]={padding:"15px 8px 0 0"},a)}]}},void 0,{scope:"DialogContent"}),D=Object(o.e)(),I={isDarkOverlay:!1,isBlocking:!1,className:"",containerClassName:"",topOffsetFixed:!1,enableAriaHiddenSiblings:!0},x={type:c.e.normal,className:"",topButtonsProps:[]},C=function(e){function t(t){var n=e.call(this,t)||this;return n._getSubTextId=function(){var e=n.props,t=e.ariaDescribedById,a=e.modalProps,i=e.dialogContentProps,r=e.subText,o=a&&a.subtitleAriaId||t;return o||(o=(i&&i.subText||r)&&n._defaultSubTextId),o},n._getTitleTextId=function(){var e=n.props,t=e.ariaLabelledById,a=e.modalProps,i=e.dialogContentProps,r=e.title,o=a&&a.titleAriaId||t;return o||(o=(i&&i.title||r)&&n._defaultTitleTextId),o},n._id=Object(s.e)("Dialog"),n._defaultTitleTextId=n._id+"-title",n._defaultSubTextId=n._id+"-subText",n}return Object(i.__extends)(t,e),t.prototype.render=function(){var e,t,n,a,o,s=this.props,c=s.className,l=s.containerClassName,u=s.contentClassName,f=s.elementToFocusOnDismiss,p=s.firstFocusableSelector,m=s.forceFocusInsideTrap,_=s.styles,h=s.hidden,b=s.disableRestoreFocus,g=void 0===b?s.ignoreExternalFocusing:b,v=s.isBlocking,y=s.isClickableOutsideFocusTrap,C=s.isDarkOverlay,O=s.isOpen,w=void 0===O?!h:O,E=s.onDismiss,A=s.onDismissed,L=s.onLayerDidMount,k=s.responsiveMode,M=s.subText,P=s.theme,T=s.title,U=s.topButtonsProps,F=s.type,H=s.minWidth,R=s.maxWidth,N=s.modalProps,B=Object(i.__assign)({onLayerDidMount:L},null==N?void 0:N.layerProps);(null==N?void 0:N.dragOptions)&&!(null===(e=N.dragOptions)||void 0===e?void 0:e.dragHandleSelector)&&(a="ms-Dialog-draggable-header",(o=Object(i.__assign)({},N.dragOptions)).dragHandleSelector="."+a);var j=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},I),{elementToFocusOnDismiss:f,firstFocusableSelector:p,forceFocusInsideTrap:m,disableRestoreFocus:g,isClickableOutsideFocusTrap:y,responsiveMode:k,className:c,containerClassName:l,isBlocking:v,isDarkOverlay:C,onDismissed:A}),N),{dragOptions:o,layerProps:B,isOpen:w}),V=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({className:u,subText:M,title:T,topButtonsProps:U,type:F},x),s.dialogContentProps),{draggableHeaderClassName:a,titleProps:Object(i.__assign)({id:(null===(t=s.dialogContentProps)||void 0===t?void 0:t.titleId)||this._defaultTitleTextId},null===(n=s.dialogContentProps)||void 0===n?void 0:n.titleProps)}),z=D(_,{theme:P,className:j.className,containerClassName:j.containerClassName,hidden:h,dialogDefaultMinWidth:H,dialogDefaultMaxWidth:R});return r.createElement(d.e,Object(i.__assign)({},j,{className:z.root,containerClassName:z.main,onDismiss:E||j.onDismiss,subtitleAriaId:this._getSubTextId(),titleAriaId:this._getTitleTextId()}),r.createElement(S,Object(i.__assign)({subTextId:this._defaultSubTextId,showCloseButton:j.isBlocking,onDismiss:E},V),s.children))},t.defaultProps={hidden:!0},Object(i.__decorate)([l.i],t)}(r.Component),O={root:"ms-Dialog"},w=Object(a.e)(C,function(e){var t,n=e.className,a=e.containerClassName,i=e.dialogDefaultMinWidth,r=void 0===i?"288px":i,o=e.dialogDefaultMaxWidth,s=void 0===o?"340px":o,c=e.hidden,d=e.theme;return{root:[Object(v.I)(O,d).root,d.fonts.medium,n],main:[{width:r,outline:"3px solid transparent",selectors:(t={},t["@media (min-width: "+v.p+"px)"]={width:"auto",maxWidth:s,minWidth:r},t)},!c&&{display:"flex"},a]}},void 0,{scope:"Dialog"});w.displayName="Dialog"},2857:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r});var a=n(2),i=new a.e("entryBatch"),r=new a.e("sourceFile")},2923:function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a=n(5),i=new a.e("progressListGroup",{maxChildItemCount:a.t,mode:a.t}),r=new a.e("progressList",{groupControlHandler:Object(a.n)(i)})},2990:function(e,t,n){"use strict";n.d(t,"e",function(){return f});var a=n("react-lib"),i=n(220),r=n(22),o=n(1999),s=n(447),c=n(4),d=n(59),l=n(277),u=n(241),f=function(e){var t=e.itemKey,n=e.action;return a.createElement(i.e,null,function(i){var f,p=i.itemCache;if(e.children)f=e.children;else{var m=p.demandItemFacet(c.u,t);f=m}var _,h=Object(d.e)(p);return _=n||(function(e,t){var n=Object(l.e)(e,{itemKey:t.itemKey1}),a=Object(l.e)(e,{itemKey:t.itemKey2});return Object(u.e)(e,{itemKey:n})===Object(u.e)(e,{itemKey:a})}(p,{itemKey1:t,itemKey2:h})?null:t?a.createElement(s.e,{itemKey:t}):null),a.createElement(r.n,{action:_},function(e){var t=e.isAvailable,n=e.execute,i=t?function(){n().catch(function(){})}:void 0;return i?a.createElement(o.e,{onClick:i},f):a.createElement("span",null,f)})})}},3276:function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a=n(2),i=n(227),r=new a.e("resolveProgressItemsOperation"),o=Object(i.e)({operationTypeFacet:r})},3516:function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a=n(23),i=n(19),r=new a.e("uploadProgress",{sourceEntryKey:i.e});function o(e){return r.serialize({sourceEntryKey:e})}},3640:function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a=n(2),i=n(227),r=new a.e("cancelProgressItemsOperation"),o=Object(i.e)({operationTypeFacet:r})},3899:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r});var a=n(126);Object(a.n)([{rawString:".errorDescription_84d0e0ea{margin-top:4px}.itemName_84d0e0ea{font-weight:600}"}]);var i="errorDescription_84d0e0ea",r="itemName_84d0e0ea"}}]);