(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[565,16,18,96,444],{2017:function(e,t,n){"use strict";n.r(t),n.d(t,"ConfirmationDialog",function(){return h});var a=n(0),i=n(2299),r=n(1912),o=n(2387),s=n(2241),c=n(2272),d=n(2197),l=n(2563),u=n(210),f=n("react-lib"),p=n(2498),m=n(2924),_=u.n.isFeatureEnabled({ODC:"DialogNextEnabled",ODB:60768})?l.e:{},h=function(e){var t=e.onConfirm,n=e.onCancel,l=e.defaultToYes,u=void 0!==l&&l,h=e.defaultFocusToYes,b=void 0!==h&&h,g=e.yesText,v=void 0===g?m.t:g,y=e.noText,S=void 0===y?m.e:y,D=e.yesClassName,I=e.noClassName,x=function(e){e&&e.focus()},C=u?i.e:r.e,O=u?r.e:i.e,w=b?void 0:x,E=b?x:void 0;return f.createElement(p.e,null,f.createElement(d.e,{scopedSettings:_},f.createElement(o.e,Object(a.__assign)({styles:e.styles,dialogContentProps:{type:s.e.close,styles:e.contentStyles,subText:e.prompt?e.prompt:""},onDismiss:n,hidden:!1,title:e.title,maxWidth:e.maxWidth,closeButtonAriaLabel:e.closeButtonAriaLabel},e.theme?{theme:e.theme}:{}),e.children,f.createElement(c.e,null,f.createElement(C,Object(a.__assign)({className:D,"data-automationid":"confirmbutton",onClick:t,componentRef:E},e.theme?{theme:e.theme}:{}),v),f.createElement(O,Object(a.__assign)({className:I,"data-automationid":"cancelbutton",onClick:n,componentRef:w},e.theme?{theme:e.theme}:{}),S)))))}},2241:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.normal=0]="normal",e[e.largeHeader=1]="largeHeader",e[e.close=2]="close"}(a||(a={}))},2272:function(e,t,n){"use strict";n.d(t,"e",function(){return f});var a=n(1902),i=n(0),r=n("react-lib"),o=n(662),s=n(1266),c=Object(o.e)(),d=function(e){function t(t){var n=e.call(this,t)||this;return Object(s.e)(n),n}return Object(i.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.styles,a=e.theme;return this._classNames=c(n,{theme:a,className:t}),r.createElement("div",{className:this._classNames.actions},r.createElement("div",{className:this._classNames.actionsRight},this._renderChildrenAsActions()))},t.prototype._renderChildrenAsActions=function(){var e=this;return r.Children.map(this.props.children,function(t){return t?r.createElement("span",{className:e._classNames.action},t):null})},t}(r.Component),l=n(25),u={actions:"ms-Dialog-actions",action:"ms-Dialog-action",actionsRight:"ms-Dialog-actionsRight"},f=Object(a.e)(d,function(e){var t=e.className,n=e.theme,a=Object(l.I)(u,n);return{actions:[a.actions,{position:"relative",width:"100%",minHeight:"24px",lineHeight:"24px",margin:"16px 0 0",fontSize:"0",selectors:{".ms-Button":{lineHeight:"normal",verticalAlign:"middle"}}},t],action:[a.action,{margin:"0 4px"}],actionsRight:[a.actionsRight,{alignItems:"center",display:"flex",fontSize:"0",justifyContent:"flex-end",marginRight:"-4px"}]}},void 0,{scope:"DialogFooter"})},2299:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n("react-lib"),r=n(1988),o=n(1989),s=n(1912),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){return i.createElement(s.e,Object(a.__assign)({},this.props,{primary:!0,onRenderDescription:r.t}))},Object(a.__decorate)([Object(o.e)("PrimaryButton",["theme","styles"],!0)],t)}(i.Component)},2337:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n("react-lib"),i=n(668);function r(e){var t=a.useState(e),n=t[0],r=t[1];return[n,{setTrue:Object(i.e)(function(){return function(){r(!0)}}),setFalse:Object(i.e)(function(){return function(){r(!1)}}),toggle:Object(i.e)(function(){return function(){r(function(e){return!e})}})}]}},2340:function(e,t,n){"use strict";n.d(t,"e",function(){return m});var a=n(1902),i=n(0),r=n("react-lib"),o=n(662),s=n(1266),c=n(1003),d=n(125),l=Object(o.e)(),u=function(e){function t(t){var n=e.call(this,t)||this;Object(s.e)(n);var a=n.props.allowTouchBodyScroll,i=void 0!==a&&a;return n._allowTouchBodyScroll=i,n}return Object(i.__extends)(t,e),t.prototype.componentDidMount=function(){!this._allowTouchBodyScroll&&Object(c.n)()},t.prototype.componentWillUnmount=function(){!this._allowTouchBodyScroll&&Object(c.a)()},t.prototype.render=function(){var e=this.props,t=e.isDarkThemed,n=e.className,a=e.theme,o=e.styles,s=Object(d.s)(this.props,d.r),c=l(o,{theme:a,className:n,isDark:t});return r.createElement("div",Object(i.__assign)({},s,{className:c.root}))},t}(r.Component),f=n(25),p={root:"ms-Overlay",rootDark:"ms-Overlay--dark"},m=Object(a.e)(u,function(e){var t,n=e.className,a=e.theme,i=e.isNone,r=e.isDark,o=a.palette,s=Object(f.I)(p,a);return{root:[s.root,a.fonts.medium,{backgroundColor:o.whiteTranslucent40,top:0,right:0,bottom:0,left:0,position:"absolute",selectors:(t={},t[f.o]={border:"1px solid WindowText",opacity:0},t)},i&&{visibility:"hidden"},r&&[s.rootDark,{backgroundColor:o.blackTranslucent40}],n]}},void 0,{scope:"Overlay"})},2360:function(e,t,n){"use strict";n.d(t,"e",function(){return j});var a=n(1902),i=n(0),r=n("react-lib"),o=n(662),s=n(1985),c=n(226),d=n(1003),l=n(139),u=n(749),f=n(49),p=n(2210),m=n(25),_=m.n.durationValue2,h={root:"ms-Modal",main:"ms-Dialog-main",scrollableContent:"ms-Modal-scrollableContent",isOpen:"is-open",layer:"ms-Modal-Layer"},b=n(2340),g=n(1998),v=n(2172),y=n(2177),S=n(353),D=n(175),I=n(512),x=n(132),C=Object(x.t)(function(e,t){return{root:Object(m.U)(e,t&&{touchAction:"none",selectors:{"& *":{userSelect:"none"}}})}}),O=n(1984),w={start:"touchstart",move:"touchmove",stop:"touchend"},E={start:"mousedown",move:"mousemove",stop:"mouseup"},A=function(e){function t(t){var n=e.call(this,t)||this;return n._currentEventType=E,n._events=[],n._onMouseDown=function(e){var t=r.Children.only(n.props.children).props.onMouseDown;return t&&t(e),n._currentEventType=E,n._onDragStart(e)},n._onMouseUp=function(e){var t=r.Children.only(n.props.children).props.onMouseUp;return t&&t(e),n._currentEventType=E,n._onDragStop(e)},n._onTouchStart=function(e){var t=r.Children.only(n.props.children).props.onTouchStart;return t&&t(e),n._currentEventType=w,n._onDragStart(e)},n._onTouchEnd=function(e){var t=r.Children.only(n.props.children).props.onTouchEnd;t&&t(e),n._currentEventType=w,n._onDragStop(e)},n._onDragStart=function(e){if("number"==typeof e.button&&0!==e.button)return!1;if(!(n.props.handleSelector&&!n._matchesSelector(e.target,n.props.handleSelector)||n.props.preventDragSelector&&n._matchesSelector(e.target,n.props.preventDragSelector))){n._touchId=n._getTouchId(e);var t=n._getControlPosition(e);if(void 0!==t){var a=n._createDragDataFromPosition(t);n.props.onStart&&n.props.onStart(e,a),n.setState({isDragging:!0,lastPosition:t}),n._events=[Object(O.e)(document.body,n._currentEventType.move,n._onDrag,!0),Object(O.e)(document.body,n._currentEventType.stop,n._onDragStop,!0)]}}},n._onDrag=function(e){"touchmove"===e.type&&e.preventDefault();var t=n._getControlPosition(e);if(t){var a=n._createUpdatedDragData(n._createDragDataFromPosition(t)),i=a.position;n.props.onDragChange&&n.props.onDragChange(e,a),n.setState({position:i,lastPosition:t})}},n._onDragStop=function(e){if(n.state.isDragging){var t=n._getControlPosition(e);if(t){var a=n._createDragDataFromPosition(t);n.setState({isDragging:!1,lastPosition:void 0}),n.props.onStop&&n.props.onStop(e,a),n.props.position&&n.setState({position:n.props.position}),n._events.forEach(function(e){return e()})}}},n.state={isDragging:!1,position:n.props.position||{x:0,y:0},lastPosition:void 0},n}return Object(i.__extends)(t,e),t.prototype.componentDidUpdate=function(e){!this.props.position||e.position&&this.props.position===e.position||this.setState({position:this.props.position})},t.prototype.componentWillUnmount=function(){this._events.forEach(function(e){return e()})},t.prototype.render=function(){var e=r.Children.only(this.props.children),t=e.props,n=this.props.position,a=this.state,o=a.position,s=a.isDragging,c=o.x,d=o.y;return n&&!s&&(c=n.x,d=n.y),r.cloneElement(e,{style:Object(i.__assign)(Object(i.__assign)({},t.style),{transform:"translate("+c+"px, "+d+"px)"}),className:C(t.className,this.state.isDragging).root,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onTouchStart:this._onTouchStart,onTouchEnd:this._onTouchEnd})},t.prototype._getControlPosition=function(e){var t=this._getActiveTouch(e);if(void 0===this._touchId||t){var n=t||e;return{x:n.clientX,y:n.clientY}}},t.prototype._getActiveTouch=function(e){return e.targetTouches&&this._findTouchInTouchList(e.targetTouches)||e.changedTouches&&this._findTouchInTouchList(e.changedTouches)},t.prototype._getTouchId=function(e){var t=e.targetTouches&&e.targetTouches[0]||e.changedTouches&&e.changedTouches[0];if(t)return t.identifier},t.prototype._matchesSelector=function(e,t){if(!e||e===document.body)return!1;var n=e.matches||e.webkitMatchesSelector||e.msMatchesSelector;return!!n&&(n.call(e,t)||this._matchesSelector(e.parentElement,t))},t.prototype._findTouchInTouchList=function(e){if(void 0!==this._touchId)for(var t=0;t<e.length;t++)if(e[t].identifier===this._touchId)return e[t]},t.prototype._createDragDataFromPosition=function(e){var t=this.state.lastPosition;return void 0===t?{delta:{x:0,y:0},lastPosition:e,position:e}:{delta:{x:e.x-t.x,y:e.y-t.y},lastPosition:t,position:e}},t.prototype._createUpdatedDragData=function(e){var t=this.state.position;return{position:{x:t.x+e.delta.x,y:t.y+e.delta.y},delta:e.delta,lastPosition:t}},t}(r.Component),L=n(1264),k=n(1980),M=n(2174),P=n(1993),T=n(2337),U=n(668),F=n(2189),H={x:0,y:0},R={isOpen:!1,isDarkOverlay:!0,className:"",containerClassName:"",enableAriaHiddenSiblings:!0},N=Object(o.e)(),B=r.forwardRef(function(e,t){var n,a,o,m,h,x=Object(s.e)(R,e),C=x.allowTouchBodyScroll,O=x.className,w=x.children,E=x.containerClassName,B=x.scrollableContentClassName,j=x.elementToFocusOnDismiss,V=x.firstFocusableSelector,z=x.focusTrapZoneProps,G=x.forceFocusInsideTrap,K=x.disableRestoreFocus,W=void 0===K?x.ignoreExternalFocusing:K,q=x.isBlocking,Q=x.isAlert,Y=x.isClickableOutsideFocusTrap,J=x.isDarkOverlay,X=x.onDismiss,Z=x.layerProps,$=x.overlay,ee=x.isOpen,te=x.titleAriaId,ne=x.styles,ae=x.subtitleAriaId,ie=x.theme,re=x.topOffsetFixed,oe=x.responsiveMode,se=x.onLayerDidMount,ce=x.isModeless,de=x.dragOptions,le=x.onDismissed,ue=x.enableAriaHiddenSiblings,fe=x.popupProps,pe=r.useRef(null),me=r.useRef(null),_e=Object(k.e)(me,null==z?void 0:z.componentRef),he=r.useRef(null),be=Object(k.e)(pe,t),ge=Object(y.e)(be),ve=Object(M.e)("ModalFocusTrapZone",null==z?void 0:z.id),ye=Object(L.n)(),Se=Object(P.e)(),De=Se.setTimeout,Ie=Se.clearTimeout,xe=r.useState(ee),Ce=xe[0],Oe=xe[1],we=r.useState(ee),Ee=we[0],Ae=we[1],Le=r.useState(H),ke=Le[0],Me=Le[1],Pe=r.useState(),Te=Pe[0],Ue=Pe[1],Fe=Object(T.e)(!1),He=Fe[0],Re=Fe[1],Ne=Re.toggle,Be=Re.setFalse,je=Object(U.e)(function(){return{onModalCloseTimer:0,allowTouchBodyScroll:C,scrollableContent:null,lastSetCoordinates:H,events:new c.e({})}}),Ve=(de||{}).keepInBounds,ze=null!=Q?Q:q&&!ce,Ge=void 0===Z?"":Z.className,Ke=N(ne,{theme:ie,className:O,containerClassName:E,scrollableContentClassName:B,isOpen:ee,isVisible:Ee,hasBeenOpened:je.hasBeenOpened,modalRectangleTop:Te,topOffsetFixed:re,isModeless:ce,layerClassName:Ge,windowInnerHeight:null==ye?void 0:ye.innerHeight,isDefaultDragHandle:de&&!de.dragHandleSelector}),We=Object(i.__assign)(Object(i.__assign)({eventBubblingEnabled:!1},Z),{onLayerDidMount:Z&&Z.onLayerDidMount?Z.onLayerDidMount:se,insertFirst:(null==Z?void 0:Z.insertFirst)||ce,className:Ke.layer}),qe=r.useCallback(function(e){e?je.allowTouchBodyScroll?Object(d.e)(e,je.events):Object(d.t)(e,je.events):je.events.off(je.scrollableContent),je.scrollableContent=e},[je]),Qe=function(){var e=he.current,t=null==e?void 0:e.getBoundingClientRect();t&&(re&&Ue(t.top),Ve&&(je.minPosition={x:-t.left,y:-t.top},je.maxPosition={x:t.left,y:t.top}))},Ye=r.useCallback(function(e,t){var n=je.minPosition,a=je.maxPosition;return Ve&&n&&a&&(t=Math.max(n[e],t),t=Math.min(a[e],t)),t},[Ve,je]),Je=function(){var e;je.lastSetCoordinates=H,Be(),je.isInKeyboardMoveMode=!1,Oe(!1),Me(H),null===(e=je.disposeOnKeyUp)||void 0===e||e.call(je),null==le||le()},Xe=r.useCallback(function(){Be(),je.isInKeyboardMoveMode=!1},[je,Be]),Ze=r.useCallback(function(e,t){Me(function(e){return{x:Ye("x",e.x+t.delta.x),y:Ye("y",e.y+t.delta.y)}})},[Ye]),$e=r.useCallback(function(){me.current&&me.current.focus()},[]);r.useEffect(function(){var e;Ie(je.onModalCloseTimer),ee&&(requestAnimationFrame(function(){return De(Qe,0)}),Oe(!0),de&&(e=function(e){e.altKey&&e.ctrlKey&&e.keyCode===l.e.space&&Object(u.e)(je.scrollableContent,e.target)&&(Ne(),e.preventDefault(),e.stopPropagation())},je.disposeOnKeyUp||(je.events.on(ye,"keyup",e,!0),je.disposeOnKeyUp=function(){je.events.off(ye,"keyup",e,!0),je.disposeOnKeyUp=void 0})),je.hasBeenOpened=!0,Ae(!0)),!ee&&Ce&&(je.onModalCloseTimer=De(Je,1e3*parseFloat(_)),Ae(!1))},[Ce,ee]),Object(F.e)(function(){je.events.dispose()}),function(e,t){r.useImperativeHandle(e.componentRef,function(){return{focus:function(){t.current&&t.current.focus()}}},[t])}(x,me);var et=r.createElement(p.e,Object(i.__assign)({},z,{id:ve,ref:he,componentRef:_e,className:Object(f.e)(Ke.main,null==z?void 0:z.className),elementToFocusOnDismiss:null!==(n=null==z?void 0:z.elementToFocusOnDismiss)&&void 0!==n?n:j,isClickableOutsideFocusTrap:null!==(a=null==z?void 0:z.isClickableOutsideFocusTrap)&&void 0!==a?a:ce||Y||!q,disableRestoreFocus:null!==(o=null==z?void 0:z.disableRestoreFocus)&&void 0!==o?o:W,forceFocusInsideTrap:(null!==(m=null==z?void 0:z.forceFocusInsideTrap)&&void 0!==m?m:G)&&!ce,firstFocusableSelector:(null==z?void 0:z.firstFocusableSelector)||V,focusPreviouslyFocusedInnerElement:null===(h=null==z?void 0:z.focusPreviouslyFocusedInnerElement)||void 0===h||h,onBlur:je.isInKeyboardMoveMode?function(e){var t,n;null===(t=null==z?void 0:z.onBlur)||void 0===t||t.call(z,e),je.lastSetCoordinates=H,je.isInKeyboardMoveMode=!1,null===(n=je.disposeOnKeyDown)||void 0===n||n.call(je)}:void 0}),de&&je.isInKeyboardMoveMode&&r.createElement("div",{className:Ke.keyboardMoveIconContainer},de.keyboardMoveIconProps?r.createElement(I.e,Object(i.__assign)({},de.keyboardMoveIconProps)):r.createElement(I.e,{iconName:"move",className:Ke.keyboardMoveIcon})),r.createElement("div",{ref:qe,className:Ke.scrollableContent,"data-is-scrollable":!0},de&&He&&r.createElement(de.menu,{items:[{key:"move",text:de.moveMenuItemText,onClick:function(){var e=function(e){if(e.altKey&&e.ctrlKey&&e.keyCode===l.e.space)return e.preventDefault(),void e.stopPropagation();var t=e.altKey||e.keyCode===l.e.escape;if(He&&t&&Be(),!je.isInKeyboardMoveMode||e.keyCode!==l.e.escape&&e.keyCode!==l.e.enter||(je.isInKeyboardMoveMode=!1,e.preventDefault(),e.stopPropagation()),je.isInKeyboardMoveMode){var n=!0,a=function(e){var t=10;return e.shiftKey?e.ctrlKey||(t=50):e.ctrlKey&&(t=1),t}(e);switch(e.keyCode){case l.e.escape:Me(je.lastSetCoordinates);case l.e.enter:je.lastSetCoordinates=H;break;case l.e.up:Me(function(e){return{x:e.x,y:Ye("y",e.y-a)}});break;case l.e.down:Me(function(e){return{x:e.x,y:Ye("y",e.y+a)}});break;case l.e.left:Me(function(e){return{x:Ye("x",e.x-a),y:e.y}});break;case l.e.right:Me(function(e){return{x:Ye("x",e.x+a),y:e.y}});break;default:n=!1}n&&(e.preventDefault(),e.stopPropagation())}};je.lastSetCoordinates=ke,Be(),je.isInKeyboardMoveMode=!0,je.events.on(ye,"keydown",e,!0),je.disposeOnKeyDown=function(){je.events.off(ye,"keydown",e,!0),je.disposeOnKeyDown=void 0}}},{key:"close",text:de.closeMenuItemText,onClick:Je}],onDismiss:Be,alignTargetEdge:!0,coverTarget:!0,directionalHint:D.e.topLeftEdge,directionalHintFixed:!0,shouldFocusOnMount:!0,target:je.scrollableContent}),w));return Ce&&ge>=(oe||S.e.small)&&r.createElement(g.e,Object(i.__assign)({ref:be},We),r.createElement(v.e,Object(i.__assign)({role:ze?"alertdialog":"dialog",ariaLabelledBy:te,ariaDescribedBy:ae,onDismiss:X,shouldRestoreFocus:!W,enableAriaHiddenSiblings:ue,"aria-modal":!ce},fe),r.createElement("div",{className:Ke.root,role:ce?void 0:"document"},!ce&&r.createElement(b.e,Object(i.__assign)({"aria-hidden":!0,isDarkThemed:J,onClick:q?void 0:X,allowTouchBodyScroll:C},$)),de?r.createElement(A,{handleSelector:de.dragHandleSelector||"#"+ve,preventDragSelector:"button",onStart:Xe,onDragChange:Ze,onStop:$e,position:ke},et):et)))||null});B.displayName="Modal";var j=Object(a.e)(B,function(e){var t,n=e.className,a=e.containerClassName,i=e.scrollableContentClassName,r=e.isOpen,o=e.isVisible,s=e.hasBeenOpened,c=e.modalRectangleTop,d=e.theme,l=e.topOffsetFixed,u=e.isModeless,f=e.layerClassName,p=e.isDefaultDragHandle,b=e.windowInnerHeight,g=d.palette,v=d.effects,y=d.fonts,S=Object(m.I)(h,d);return{root:[S.root,y.medium,{backgroundColor:"transparent",position:"fixed",height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",opacity:0,pointerEvents:"none",transition:"opacity "+_},l&&"number"==typeof c&&s&&{alignItems:"flex-start"},r&&S.isOpen,o&&{opacity:1},o&&!u&&{pointerEvents:"auto"},n],main:[S.main,{boxShadow:v.elevation64,borderRadius:v.roundedCorner2,backgroundColor:g.white,boxSizing:"border-box",position:"relative",textAlign:"left",outline:"3px solid transparent",maxHeight:"calc(100% - 32px)",maxWidth:"calc(100% - 32px)",minHeight:"176px",minWidth:"288px",overflowY:"auto",zIndex:u?m.g.Layer:void 0},u&&{pointerEvents:"auto"},l&&"number"==typeof c&&s&&{top:c},p&&{cursor:"move"},a],scrollableContent:[S.scrollableContent,{overflowY:"auto",flexGrow:1,maxHeight:"100vh",selectors:(t={},t["@supports (-webkit-overflow-scrolling: touch)"]={maxHeight:b},t)},i],layer:u&&[f,S.layer,{pointerEvents:"none"}],keyboardMoveIconContainer:{position:"absolute",display:"flex",justifyContent:"center",width:"100%",padding:"3px 0px"},keyboardMoveIcon:{fontSize:y.xLargePlus.fontSize,width:"24px"}}},void 0,{scope:"Modal",fields:["theme","styles","enableAriaHiddenSiblings"]});j.displayName="Modal"},2387:function(e,t,n){"use strict";n.d(t,"e",function(){return w});var a=n(1902),i=n(0),r=n("react-lib"),o=n(662),s=n(747),c=n(2241),d=n(2360),l=n(353),u=n(1266),f=n(1826),p=n(49),m=n(2033),_=n(2272),h=Object(o.e)(),b=r.createElement(_.e,null).type,g=function(e){function t(t){var n=e.call(this,t)||this;return Object(u.e)(n),Object(f.e)("DialogContent",t,{titleId:"titleProps.id"}),n}return Object(i.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.showCloseButton,a=t.className,o=t.closeButtonAriaLabel,s=t.onDismiss,d=t.subTextId,l=t.subText,u=t.titleProps,f=void 0===u?{}:u,_=t.titleId,b=t.title,g=t.type,v=t.styles,y=t.theme,S=t.draggableHeaderClassName,D=h(v,{theme:y,className:a,isLargeHeader:g===c.e.largeHeader,isClose:g===c.e.close,draggableHeaderClassName:S}),I=this._groupChildren();return l&&(e=r.createElement("p",{className:D.subText,id:d},l)),r.createElement("div",{className:D.content},r.createElement("div",{className:D.header},r.createElement("div",Object(i.__assign)({id:_,role:"heading","aria-level":1},f,{className:Object(p.e)(D.title,f.className)}),b),r.createElement("div",{className:D.topButton},this.props.topButtonsProps.map(function(e,t){return r.createElement(m.e,Object(i.__assign)({key:e.uniqueId||t},e))}),(g===c.e.close||n&&g!==c.e.largeHeader)&&r.createElement(m.e,{className:D.button,iconProps:{iconName:"Cancel"},ariaLabel:o,onClick:s}))),r.createElement("div",{className:D.inner},r.createElement("div",{className:D.innerContent},e,I.contents),I.footers))},t.prototype._groupChildren=function(){var e={footers:[],contents:[]};return r.Children.map(this.props.children,function(t){"object"==typeof t&&null!==t&&t.type===b?e.footers.push(t):e.contents.push(t)}),e},t.defaultProps={showCloseButton:!1,className:"",topButtonsProps:[],closeButtonAriaLabel:"Close"},Object(i.__decorate)([l.i],t)}(r.Component),v=n(25),y={contentLgHeader:"ms-Dialog-lgHeader",close:"ms-Dialog--close",subText:"ms-Dialog-subText",header:"ms-Dialog-header",headerLg:"ms-Dialog--lgHeader",button:"ms-Dialog-button ms-Dialog-button--close",inner:"ms-Dialog-inner",content:"ms-Dialog-content",title:"ms-Dialog-title"},S=Object(a.e)(g,function(e){var t,n,a,i=e.className,r=e.theme,o=e.isLargeHeader,s=e.isClose,c=e.hidden,d=e.isMultiline,l=e.draggableHeaderClassName,u=r.palette,f=r.fonts,p=r.effects,m=r.semanticColors,_=Object(v.I)(y,r);return{content:[o&&[_.contentLgHeader,{borderTop:"4px solid "+u.themePrimary}],s&&_.close,{flexGrow:1,overflowY:"hidden"},i],subText:[_.subText,f.medium,{margin:"0 0 24px 0",color:m.bodySubtext,lineHeight:"1.5",wordWrap:"break-word",fontWeight:v.r.regular}],header:[_.header,{position:"relative",width:"100%",boxSizing:"border-box"},s&&_.close,l&&[l,{cursor:"move"}]],button:[_.button,c&&{selectors:{".ms-Icon.ms-Icon--Cancel":{color:m.buttonText,fontSize:v.c.medium}}}],inner:[_.inner,{padding:"0 24px 24px",selectors:(t={},t["@media (min-width: "+v.m+"px) and (max-width: "+v.u+"px)"]={padding:"0 16px 16px"},t)}],innerContent:[_.content,{position:"relative",width:"100%"}],title:[_.title,f.xLarge,{color:m.bodyText,margin:"0",minHeight:f.xLarge.fontSize,padding:"16px 46px 20px 24px",lineHeight:"normal",selectors:(n={},n["@media (min-width: "+v.m+"px) and (max-width: "+v.u+"px)"]={padding:"16px 46px 16px 16px"},n)},o&&{color:m.menuHeader},d&&{fontSize:f.xxLarge.fontSize}],topButton:[{display:"flex",flexDirection:"row",flexWrap:"nowrap",position:"absolute",top:"0",right:"0",padding:"15px 15px 0 0",selectors:(a={"> *":{flex:"0 0 auto"},".ms-Dialog-button":{color:m.buttonText},".ms-Dialog-button:hover":{color:m.buttonTextHovered,borderRadius:p.roundedCorner2}},a["@media (min-width: "+v.m+"px) and (max-width: "+v.u+"px)"]={padding:"15px 8px 0 0"},a)}]}},void 0,{scope:"DialogContent"}),D=Object(o.e)(),I={isDarkOverlay:!1,isBlocking:!1,className:"",containerClassName:"",topOffsetFixed:!1,enableAriaHiddenSiblings:!0},x={type:c.e.normal,className:"",topButtonsProps:[]},C=function(e){function t(t){var n=e.call(this,t)||this;return n._getSubTextId=function(){var e=n.props,t=e.ariaDescribedById,a=e.modalProps,i=e.dialogContentProps,r=e.subText,o=a&&a.subtitleAriaId||t;return o||(o=(i&&i.subText||r)&&n._defaultSubTextId),o},n._getTitleTextId=function(){var e=n.props,t=e.ariaLabelledById,a=e.modalProps,i=e.dialogContentProps,r=e.title,o=a&&a.titleAriaId||t;return o||(o=(i&&i.title||r)&&n._defaultTitleTextId),o},n._id=Object(s.e)("Dialog"),n._defaultTitleTextId=n._id+"-title",n._defaultSubTextId=n._id+"-subText",n}return Object(i.__extends)(t,e),t.prototype.render=function(){var e,t,n,a,o,s=this.props,c=s.className,l=s.containerClassName,u=s.contentClassName,f=s.elementToFocusOnDismiss,p=s.firstFocusableSelector,m=s.forceFocusInsideTrap,_=s.styles,h=s.hidden,b=s.disableRestoreFocus,g=void 0===b?s.ignoreExternalFocusing:b,v=s.isBlocking,y=s.isClickableOutsideFocusTrap,C=s.isDarkOverlay,O=s.isOpen,w=void 0===O?!h:O,E=s.onDismiss,A=s.onDismissed,L=s.onLayerDidMount,k=s.responsiveMode,M=s.subText,P=s.theme,T=s.title,U=s.topButtonsProps,F=s.type,H=s.minWidth,R=s.maxWidth,N=s.modalProps,B=Object(i.__assign)({onLayerDidMount:L},null==N?void 0:N.layerProps);(null==N?void 0:N.dragOptions)&&!(null===(e=N.dragOptions)||void 0===e?void 0:e.dragHandleSelector)&&(a="ms-Dialog-draggable-header",(o=Object(i.__assign)({},N.dragOptions)).dragHandleSelector="."+a);var j=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},I),{elementToFocusOnDismiss:f,firstFocusableSelector:p,forceFocusInsideTrap:m,disableRestoreFocus:g,isClickableOutsideFocusTrap:y,responsiveMode:k,className:c,containerClassName:l,isBlocking:v,isDarkOverlay:C,onDismissed:A}),N),{dragOptions:o,layerProps:B,isOpen:w}),V=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({className:u,subText:M,title:T,topButtonsProps:U,type:F},x),s.dialogContentProps),{draggableHeaderClassName:a,titleProps:Object(i.__assign)({id:(null===(t=s.dialogContentProps)||void 0===t?void 0:t.titleId)||this._defaultTitleTextId},null===(n=s.dialogContentProps)||void 0===n?void 0:n.titleProps)}),z=D(_,{theme:P,className:j.className,containerClassName:j.containerClassName,hidden:h,dialogDefaultMinWidth:H,dialogDefaultMaxWidth:R});return r.createElement(d.e,Object(i.__assign)({},j,{className:z.root,containerClassName:z.main,onDismiss:E||j.onDismiss,subtitleAriaId:this._getSubTextId(),titleAriaId:this._getTitleTextId()}),r.createElement(S,Object(i.__assign)({subTextId:this._defaultSubTextId,showCloseButton:j.isBlocking,onDismiss:E},V),s.children))},t.defaultProps={hidden:!0},Object(i.__decorate)([l.i],t)}(r.Component),O={root:"ms-Dialog"},w=Object(a.e)(C,function(e){var t,n=e.className,a=e.containerClassName,i=e.dialogDefaultMinWidth,r=void 0===i?"288px":i,o=e.dialogDefaultMaxWidth,s=void 0===o?"340px":o,c=e.hidden,d=e.theme;return{root:[Object(v.I)(O,d).root,d.fonts.medium,n],main:[{width:r,outline:"3px solid transparent",selectors:(t={},t["@media (min-width: "+v.p+"px)"]={width:"auto",maxWidth:s,minWidth:r},t)},!c&&{display:"flex"},a]}},void 0,{scope:"Dialog"});w.displayName="Dialog"},2455:function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"e",function(){return a});var a,i={applyPanel:"filtersPane-applyInPanel",pinnedToFiltersPaneChanged:"filtersPane-pinnedToFiltersPaneChanged",showInFiltersPaneChanged:"filtersPane-showInFiltersPaneChangedChanged",sectionInfosChanged:"filtersPane-sectionInfosChanged",canvasFilterChanged:"filtersPane-canvasFilterChanged"};function r(e){return e}!function(e){e[e.none=0]="none",e[e.last3Months=1]="last3Months",e[e.last30Days=2]="last30Days",e[e.last7Days=3]="last7Days",e[e.yesterday=4]="yesterday",e[e.today=5]="today",e[e.tomorrow=6]="tomorrow",e[e.next7Days=7]="next7Days",e[e.next30Days=8]="next30Days",e[e.next3Months=9]="next3Months",e[e.nextYear=10]="nextYear"}(a||(a={}))},2498:function(e,t,n){"use strict";n.d(t,"e",function(){return c}),n.d(t,"t",function(){return d});var a=n("react-lib"),i=n(1436),r=n(197),o=n(226),s=0;function c(e){var t=e.isDefault,n=void 0!==t&&t,o=a.useState("".concat(++s))[0],c=a.useContext(i.e),d=a.useRef(),u=d.current||n&&c.keyboardManager||(d.current=new i.t({isDefault:!1,id:o,parent:c.keyboardManager})),f=l(u),p=f.isActive,m=f.isChildActive;a.useEffect(function(){return function(){n||(u.setIsActive(!1),u.dispose())}},[]);var _=a.useMemo(function(){return{keyboardManager:u}},[u]);return a.createElement("div",{"data-keyboard-zone-id":o},a.createElement(i.e.Provider,{value:_},Object(r.t)(e.children,{isActive:p,isChildActive:m})))}function d(){return l(a.useContext(i.e).keyboardManager)}function l(e){var t=a.useState(function(){return e.getIsActive()}),n=t[0],i=t[1],r=a.useState(function(){return e.hasActiveChildren()}),s=r[0],c=r[1];return a.useEffect(function(){var t=new o.e(null);return t.on(e,"change",function(){i(e.getIsActive()),c(e.hasActiveChildren())}),function(){t.dispose()}},[]),{isActive:n,isChildActive:s}}},2563:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a,i=n(0),r={height:"100%",display:"flex",flexDirection:"column"},o={width:"440px",minWidth:"none",maxWidth:"none"},s={Modal:{styles:{main:Object(i.__assign)({selectors:(a={},a["@media (min-width: 480px)"]=Object(i.__assign)({},o),a),minHeight:"240px"},o)}},DialogContent:{styles:{content:r,inner:r,innerContent:r}},DialogFooter:{styles:{actions:{minHeight:"none"}}}}},2686:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("bundle")},2747:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"n",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a="root",i="me",r="/drive/root:",o=30},2823:function(e,t,n){"use strict";var a,i;n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i}),function(e){e.AddToOneDrive="AddToOneDrive",e.BrowseFiles="BrowseFiles",e.CloseVault="CloseVault",e.CreateFolder="CreateFolder",e.CreateFile="CreateFile",e.DeleteFile="DeleteFile",e.DeleteFolder="DeleteFolder",e.DownloadFile="DownloadFile",e.DownloadBatch="DownloadBatch",e.GetFile="GetFile",e.RenameFile="RenameFile",e.RenameFolder="RenameFolder",e.OpenVault="OpenVault",e.PopulateRecentFiles="PopulateRecentFiles",e.PopulateSharedWithMe="PopulateSharedWithMe",e.Search="Search",e.UploadFile="UploadFile",e.SaveFile="SaveFile",e.UploadBatch="UploadBatch"}(a||(a={})),function(e){e.ActiveUserOperation="AUO",e.BackgroundOperation="BGO",e.PassiveOperation="PO"}(i||(i={}))},2856:function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a=n(18);function i(e){return new Date(e)}function r(e,t){void 0===t&&(t=!1);var n=new Date(e),i=n.getTimezoneOffset()<0,r=n.getFullYear()+"",o=Object(a.leftPad)(n.getMonth()+1+"",2),s=Object(a.leftPad)(n.getDate()+"",2),c=Object(a.leftPad)(n.getHours()+"",2),d=Object(a.leftPad)(n.getMinutes()+"",2),l=Object(a.leftPad)(n.getSeconds()+"",2),u=(i?"+":"-")+Object(a.leftPad)(i?(Math.ceil(n.getTimezoneOffset()/60)+"").replace("-",""):Math.floor(n.getTimezoneOffset()/60)+"",2)+Object(a.leftPad)((n.getTimezoneOffset()%60).toString().replace("-",""),2);return t?r+"-"+o+"-"+s+"T"+c+":"+d+":"+l+u:r+o+s+"T"+c+d+l+u}},2887:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("convergenceConfigurationFacet")},2926:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("driveItemResponse")},2930:function(e,t,n){"use strict";n.d(t,"e",function(){return m}),n.d(t,"t",function(){return _}),n.d(t,"n",function(){return h}),n.d(t,"a",function(){return b}),n.d(t,"i",function(){return g}),n.d(t,"r",function(){return y}),n.d(t,"o",function(){return S});var a=n(0),i=n(1434),r=n(3208),o=n(3207),s=n(79),c=n(116),d=n(128),l=n(3145),u=n(8),f=!u.e.isActivated("DAF1BE9A-8497-4F4F-8797-73EF984441D3","04/05/2022","Fix logic in hasRequiredRole"),p=!u.e.isActivated("A7214F2C-B4A0-4A90-AB59-4F8E4927261F","04/05/2022","Revises hasPermission `isOwner` logic to be self-contained and available to addon-graph consumers (not just odsp-next)"),m=(new c.e("addToOneDrive",function(e,t){return v(e,Object(a.__assign)(Object(a.__assign)({},t),{commandFacet:r.e}))}),new c.e("canCreateFolder",function(e,t){return v(e,Object(a.__assign)(Object(a.__assign)({},t),{commandFacet:r.t}))})),_=(new c.e("canCreateLink",function(e,t){return v(e,Object(a.__assign)(Object(a.__assign)({},t),{commandFacet:r.n}))}),new c.e("canDelete",function(e,t){return v(e,Object(a.__assign)(Object(a.__assign)({},t),{commandFacet:r.a}))})),h=new c.e("canDownload",function(e,t){return!e.demandItemFacet(d.i,t.itemKey)&&v(e,Object(a.__assign)(Object(a.__assign)({},t),{commandFacet:r.i}))}),b=(new c.e("canInvite",function(e,t){return v(e,Object(a.__assign)(Object(a.__assign)({},t),{commandFacet:r.r}))}),new c.e("canMove",function(e,t){return v(e,Object(a.__assign)(Object(a.__assign)({},t),{commandFacet:r.o}))}),new c.e("canUseOfficeLens",function(e,t){return v(e,Object(a.__assign)(Object(a.__assign)({},t),{commandFacet:r.s}))}),new c.e("canRename",function(e,t){return v(e,Object(a.__assign)(Object(a.__assign)({},t),{commandFacet:r.c}))})),g=new c.e("canUpload",function(e,t){return v(e,Object(a.__assign)(Object(a.__assign)({},t),{commandFacet:r.d}))});function v(e,t){var n=t.itemKey,a=t.commandFacet,i=e.demandItemFacet(s.e,n);if(!i)return!1;var r=i.endpoint,c=i.driveId,d=e.demandItemFacet(a,o.e.serialize({endpoint:r,driveId:c}));return!!d&&!!d.roles&&y(e,{itemKey:n,oneOfRequiredRoles:d.roles})}function y(e,t){var n=t.itemKey,a=t.oneOfRequiredRoles,r=function(e,t){if(S(e,t))return["read","write","owner"];var n=e.demandItemFacet(i.e,t);return n&&n.effectiveRoles?n.effectiveRoles:[]}(e,n);return function(e,t){var n=t.oneOfRequiredRoles,a=t.effectiveRoles;if(f)for(var i=0,r=a;i<r.length;i++){var o=r[i];if(n.indexOf(o)>=0)return!0}else for(var o in a)if(o in n)return!0;return!1}(0,{oneOfRequiredRoles:a,effectiveRoles:r})}function S(e,t,n){var a,r,o=e.demandItemFacet(i.e,t);if(p){var c=e.demandItemFacet(s.e,t);if(Object(l.e)(e,{driveItemKey:c}))return!0}else{var d=null===(r=null===(a=null==o?void 0:o.owner)||void 0===a?void 0:a.user)||void 0===r?void 0:r.id;if(n&&d)return n.toUpperCase()===d.toUpperCase()}return!o||!o.effectiveRoles||!(o.owner||o.sharedBy)}},2931:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(5),i=new a.e("itemsViewSearch",{getSearchItemKey:a.t,query:a.t,isAvailable:a.t})},2971:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(8);function i(e){var t;return a.t.isActivated("70112978-C401-4C01-AC5E-CFB577601CD6","","")?e.parentReference:(null===(t=e.remoteItem)||void 0===t?void 0:t.parentReference)||e.parentReference}},3060:function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a=n("react-lib"),i=n(1485),r=n(917),o=n(4),s=n(22),c=n(447),d=n(179),l=n(215),u=n(8),f=n(3131),p=u.e.isActivated("AB1B9B00-C482-451A-A5DA-500AC7533605","1/31/2022","Require Name to be clickable for parent path to be clickable"),m=[];function _(e,t){var n=t.itemKey,d=t.renderer,u=e.demandItemFacet(o.k,n),_=e.demandItemFacet(o.A,null==u?void 0:u.itemKey)||"",b=e.demandItemFacet(f.e,n),g=f.e.evaluate(b)(e,{itemKey:n,displayPathSegments:_?h(_):m,openUrl:_,action:u&&_?Object(l.a)(e,a.createElement(c.e,{itemKey:u.itemKey})):null}),v=g.displayPathSegments,y=void 0===v?m:v,S=g.action,D=g.openUrl;return{renderer:function(e,t,n){var o=d?d(e,t,n):null;return a.createElement(a.Fragment,null,o?a.createElement(a.Fragment,{key:"content"},o):null,y.length>0?a.createElement(s.n,{key:"path",action:S},function(t){var n=t.execute,o=t.isAvailable&&(p||e.isInvokable)?function(e){n({event:e}).catch(function(){}),e.preventDefault(),e.stopPropagation()}:void 0;return a.createElement(i.e,{className:r.e,displayPathSegments:y,parentLink:o?D:void 0,onClick:o})}):null)}}}function h(e){for(var t=[],n=0,a=new d.e(e).segments.slice(1);n<a.length;n++){var i=a[n];try{t.push(decodeURIComponent(i))}catch(e){t.push(i)}}return t}},3124:function(e,t,n){"use strict";n.d(t,"e",function(){return K}),n.d(t,"t",function(){return q});var a=n(0),i=n(128),r=n(4),o=n(6),s=n(79),c=n(1028),d=n(3659),l=n(3147),u=n(2926),f=n(2686),p=n(768),m=n(1434),_=n(2),h=new _.e("deletedDateTime"),b=new _.e("deletedFromLocation"),g=n(3146),v=n(239),y=n(365),S=n(170),D=n(50),I=n(1052),x=n(1478),C=n(1051),O=n(1440),w=n(3536),E=n(2971),A=n(1046),L=n(3445),k=n(3292),M=n(260),P=n(3921),T=n(3537),U=n(777),F=n(3660),H=n(3661),R=n(3662),N=n(1464),B=n(286),j=n(8),V=!j.e.isActivated("9744858D-1FBE-4889-99CD-288F9CB2B2B1","06/01/2022","Actively pack undefined `mountPointFacet` + `shortcutItemFacet` in `getDriveItemFacets`"),z=!j.e.isActivated("1AEC6B12-C1F5-40E0-8D77-DDD9B65B3C25","09/15/2022","Disable overriding document library names"),G=!j.e.isActivated("5EDF71CC-AEE3-4FF3-BFC7-E895EB999F8F5","12/09/2022","Add follow facet if Favorites is enabled");function K(e){var t=e.itemKey,n=e.driveItemKey,_=e.driveItem,j=e.endpoint,Q=e.parentFolderItemKey,Y=e.shouldReturnShareFacets,J=void 0===Y||Y,X=_.coverImage,Z=_.file,$=_.fileSystemInfo,ee=_.name,te=_.remoteItem,ne=_.root,ae=_.size,ie=_.thumbnails,re=_.image,oe=_.video,se=_.eTag,ce=_.tags,de=_.photo,le=_.specialFolder,ue=_.photoStreamItemSource;return function(e){var Y,fe,pe,me,_e,he,be,ge,ve=_.lastModifiedDateTime,ye=void 0===ve?$&&$.lastModifiedDateTime||te&&te.lastModifiedDateTime:ve,Se=_.createdDateTime||$&&$.createdDateTime||te&&te.createdDateTime,De=Object(E.e)(_),Ie=null==De?void 0:De.driveId,xe=null==De?void 0:De.driveType,Ce="personal"===xe,Oe=_.webDavUrl||te&&te.webDavUrl,we=null==De?void 0:De["@oneDrive.displayPath"],Ee=null===(be=null===(he=null==te?void 0:te.owner)||void 0===he?void 0:he.user)||void 0===be?void 0:be.displayName,Ae=we?d.e.serialize({endpoint:j,driveId:Ie,path:we}):void 0,Le=$&&$.lastAccessedDateTime||te&&te.fileSystemInfo&&te.fileSystemInfo.lastAccessedDateTime,ke=(null==de?void 0:de.takenDateTime)||(null==de?void 0:de.alternateTakenDateTime),Me=_.package||(null==te?void 0:te.package),Pe=ie||(null==te?void 0:te.thumbnails),Te=!(null==Pe?void 0:Pe.length)||void 0===Pe[0].isPreAuth,Ue=re||te&&te.image,Fe=oe||te&&te.video,He=_.shared||te&&te.shared,Re=_.deletedFromLocation,Ne=_.deletedDateTime,Be={itemId:_.id,driveId:Ie,endpoint:j},je=$&&$.systemPath,Ve=n||te&&te.parentReference&&{itemId:te.id,driveId:te.parentReference.driveId,endpoint:j}||Be,ze=s.e.serialize(Ve),Ge=Oe&&decodeURIComponent(Oe);ge=("business"===xe||!z&&"documentLibrary"===xe||"personal"===xe)&&ne?y.n:ee||te&&te.name||"";var Ke=_.bundle||(null==te?void 0:te.bundle),We=_.folder||(null==te?void 0:te.folder)||Ke,qe=null!=ae?ae:null==te?void 0:te.size,Qe=null==We?void 0:We.childCount,Ye=q(ge,!!We),Je=Ye.extension||(null==Me?void 0:Me.type),Xe=Je&&Object(w.e)(Je),Ze=_.sharepointIds||te&&te.sharepointIds,$e=_.localItem,et=_.webUrl||te&&te.webUrl,tt=new B.e({publisher:K});return Ae&&Q&&tt.mapKeys({mappings:(Y={},Y[Ae]=Q,Y)}),Ae&&tt.resolveItems({items:(fe={},fe[Ae]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},d.e.pack(d.e.deserialize(Ae))),r.u.pack(we?we.substring(we.lastIndexOf("/")+1):void 0)),r.L.pack(Ee)),r._.pack({})),fe)}),tt.resolveItems({items:(pe={},pe[t]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},s.e.pack(Ve)),r.u.pack(ge)),r.L.pack(Ee)),void 0!==qe?r.m.pack(qe):{}),r._.pack(We?{}:void 0)),et?r.A.pack(et):{}),C.n.pack(je)),Ge||Ke?r.i.pack(Ge):{}),r.c.pack(ye?new Date(ye).getTime():void 0)),r.s.pack(Se?new Date(Se).getTime():void 0)),S.c.pack(ke?new Date(ke).getTime():void 0)),Le?Object(a.__assign)({},r.o.pack(new Date(Le).getTime())):{}),i.i.pack(Me&&"oneNote"===Me.type?{}:void 0)),Pe?Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},l.e.pack(Pe)),k.e.pack(Te)),T.e.pack(Object(U.i)(Ye.extension))):{}),Object(M.e)().forFacet(S.h).thenInvalidate(ze,l.e).pack()),u.e.pack(_)),se?r.f.pack(se):{}),Ue&&Ue.width&&Ue.height?S.d.pack({width:Ue.width,height:Ue.height}):{}),Ue&&!Fe?S.m.pack({}):{}),Fe?S.g.pack({}):{}),o.t.pack({itemKey:c.e.serialize({driveItemKey:Ve,sortBy:"",isAscending:!0})})),r.n.pack({itemKey:p.e.serialize({driveItemKey:Ve})})),r.k.pack(Q?{itemKey:Q}:Ae?{itemKey:Ae}:void 0)),!Ce&&Oe?Object(a.__assign)({},r.M.pack(W(Oe))):{}),I.e.pack(xe)),Ce?Object(a.__assign)({},x.e.pack(_.vault)):{}),Ce&&_.restricted?Object(a.__assign)({},F.e.pack(_.restricted)):{}),r.p.pack(Ye)),J?Object(a.__assign)(Object(a.__assign)({},r.D.pack(!!He)),m.e.pack(He)):{}),$e?C.e.pack($e):{}),"number"==typeof Qe?D.e.pack(Qe):{}),P.e.pack(X)),H.e.pack(ce)),R.e.pack(!!ue)),C.t.pack(Z&&Z.mimeType)),Xe?O.e.pack(Xe):{}),Ze?A.e.pack(Ze):{}),le?L.e.pack(le.name):{}),Re?b.pack(Re):{}),Ne?h.pack(Ne):{}),r.d.pack(Ne||Re?{}:void 0)),V?Object(a.__assign)(Object(a.__assign)({},g.e.pack(void 0)),v.e.pack(void 0)):{}),pe)}),tt.resolveItems({items:(me={},me[t]=Object(a.__assign)(Object(a.__assign)({},Ke?f.e.pack(Ke):{}),G?Object(a.__assign)({},r.h.pack({itemKey:N.e.serialize({driveItem:Ve})})):{}),me)}),G&&tt.resolveItems({items:(_e={},_e[t]=Object(a.__assign)({},r.h.pack({itemKey:N.e.serialize({driveItem:Ve})})),_e)}),{itemResolver:tt}}}function W(e){var t=e.split("/");return t.length>2?decodeURIComponent(t[t.length-2]):void 0}function q(e,t){var n=e.lastIndexOf(".");return t||n<0?{name:e,extension:""}:{name:e.substring(0,n),extension:e.substring(n)}}},3125:function(e,t,n){"use strict";var a=n(269);function i(e){return void 0!==e.action}function r(e){return void 0!==e.activityDateTime}function o(e){var t=g(e).comment;return void 0!==t&&!t.isReply}function s(e){var t=g(e).comment;return void 0!==t&&t.isReply}function c(e){return void 0!==g(e).mention}function d(e){return void 0!==g(e).version}function l(e){return void 0!==g(e).pointInTimeRestore}function u(e){return void 0!==g(e).restoreVersion}function f(e){return void 0!==g(e).move}function p(e){return void 0!==g(e).rename}function m(e){return void 0!==g(e).delete}function _(e){return void 0!==g(e).share}function h(e){var t=g(e).addToOneDrive;return void 0!==t&&!t.removedDateTime}function b(e){var t=g(e).addToOneDrive;return void 0!==t&&!!t.removedDateTime}function g(e){return i(e)?e.action:e}function v(e){return e.driveItem||e.listItem}var y=n(69),S=!n(8).t.isActivated("DC1B3A2B-2469-49B2-9230-7F6CD01BD84C","12/30/2020","Enable deeplinking for comment activities"),D=function(){function e(){}return e.prototype.processResponse=function(e){var t=this,n=e.item,a=e.response;return{isPlaceholder:!1,activities:a.value.map(function(e){if(r(e))if(o(e)||s(e)){var a=g(e).comment;(a.contentId||a.navigationId)&&(e.docDetails={contentId:a.contentId,navigationId:a.navigationId})}else if(c(e)){var i=g(e).mention;(i.contentId||i.navigationId)&&(e.docDetails={contentId:i.contentId,navigationId:i.navigationId})}return t._processActivityResponse(n,e)}),nextRequestToken:this._getNextRequestToken(a),success:!0}},e.prototype.processActivitiesByIntervalResponse=function(e){var t=this;return{activitiesByInterval:e.value.map(function(e){return t._processActivitySummaryResponse(e)}),success:!0}},e.prototype._processActivitySummaryResponse=function(e){return{totalCount:(void 0!==e.create?e.create.actionCount:0)+(void 0!==e.delete?e.delete.actionCount:0)+(void 0!==e.edit?e.edit.actionCount:0)+(void 0!==e.move?e.move.actionCount:0)+(void 0!==e.rename?e.rename.actionCount:0)+(void 0!==e.restore?e.restore.actionCount:0)+(void 0!==e.copy?e.copy.actionCount:0),startDateTime:new Date(e.startDateTime),endDateTime:new Date(e.endDateTime)}},e.prototype._getNextRequestToken=function(e){if(e.value&&!(e.value.length<1)){var t=e["@odata.nextLink"],n=t&&t.match(/skiptoken=([^&]+)/i);return n?n[1]:void 0}},e.prototype._processActivityResponse=function(e,t){var n=this._getItem(e,t),a=this._getParentItem(t),i=this._getAction(e,n,a,t);if(r(t)){var o=t.actor&&t.actor.user,s=o&&{displayName:o.displayName,id:o.id,email:o.email,self:o.self};return{id:t.id,type:this._getActivityType(t),actors:s?[s]:[],item:n,parentItem:a,time:new Date(t.activityDateTime),action:i}}var c=t.actor&&t.actor.user,d=c&&{displayName:c.displayName,email:c.email,self:c.self,userPrincipalName:c.userPrincipalName};return{id:t.id,type:this._getActivityType(t),actors:[d],item:n,parentItem:a,time:t.times.recordedTime?new Date(t.times.recordedTime):new Date(t.times.recordedDateTime),friendlyDisplayTime:t["@sharePoint.localizedRelativeTime"],action:i}},e.prototype._getActivityType=function(e){return(t={Comment:function(){return a.e.comment},CommentResponse:function(){return a.e.commentResponse},Create:function(){return a.e.create},Delete:function(){return a.e.delete},Edit:function(){return a.e.edit},Mention:function(){return a.e.mention},Move:function(){return a.e.move},Rename:function(){return a.e.rename},Restore:function(){return a.e.restore},RestoreVersion:function(){return a.e.restoreVersion},PointInTimeRestore:function(){return a.e.pointInTimeRestore},Share:function(){return a.e.share},Version:function(){return a.e.version},Copy:function(){return a.e.copy},AddShortcutToOneDrive:function(){return a.e.addShortcutToOneDrive},RemoveShortcutFromOneDrive:function(){return a.e.removeShortcutFromOneDrive}},function(e){return c(e)?t.Mention(e):o(e)?t.Comment(e):s(e)?t.CommentResponse(e):function(e){return void 0!==g(e).create}(e)?t.Create(e):m(e)?t.Delete(e):function(e){return void 0!==g(e).edit}(e)?t.Edit(e):f(e)?t.Move(e):p(e)?t.Rename(e):function(e){return void 0!==g(e).restore}(e)?t.Restore(e):u(e)?t.RestoreVersion(e):_(e)?t.Share(e):d(e)?t.Version(e):function(e){return void 0!==g(e).copy}(e)?t.Copy(e):l(e)?t.PointInTimeRestore(e):h(e)?t.AddShortcutToOneDrive(e):b(e)?t.RemoveShortcutFromOneDrive(e):void 0})(e);var t},e.prototype._getItem=function(e,t){var n,a,o=v(t);if(f(t)){if(i(t)){var s=g(t).move;if(s&&s.to)return{name:this._getFileNameFromPath(s.to),isRoot:this._isRootItem(s.to),graphItemUrl:void 0,relativePath:void 0,absolutePath:s.to}}}else if(m(t)&&i(t)){var c=g(t).delete;if(c&&c.name){var d=(a=(n=o&&o.parentReference)&&this._getRelativePathFromVroomPath(n.path))&&o&&a+"/"+o.name+"/"+c.name;return{name:c.name,isRoot:this._isRootItem(c.name),graphItemUrl:void 0,relativePath:d,absolutePath:void 0,isFolder:"Folder"===c.objectType}}}return o?(t.docDetails&&(o.webUrl=this._getNavLink(o,t.docDetails)),d=(a=(n=o&&(o.parentReference||o.remoteItem&&o.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(n.path))&&a+"/"+o.name,m(t)?{name:o.name,isRoot:this._isRootItem(o.name),graphItemUrl:void 0,relativePath:d,absolutePath:void 0}:{name:o.name,isRoot:this._isRootItem(o.name),graphItemUrl:n&&"/drives/".concat(n.driveId,"/items/").concat(o.id),relativePath:d,absolutePath:void 0,driveItem:o,navigationId:this._getNavigationId(t)}):r(t)?void 0:e},e.prototype._getParentItem=function(e){var t=v(e);if(f(e)){var n=g(e).move;if(n&&n.to){var a=this._getDirNameFromPath(n.to),r=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference);return{name:this._getFileNameFromPath(a),isRoot:this._isRootItem(a),graphItemUrl:r&&"/drives/".concat(r.driveId,"/items/").concat(r.id),relativePath:void 0,absolutePath:this._getDirNameFromPath(a),isFolder:!0,driveItem:r&&{id:r.id}}}}else if(m(e)&&t){if(i(e)){var o=(c=(r=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(r.path))&&c+"/"+name;return{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:r&&"/drives/".concat(r.driveId,"/items/").concat(t.id),relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:t}}if(r=t&&t.parentReference){o=this._getRelativePathFromVroomPath(r.path);var s=r.name?r.name:o&&this._getFileNameFromPath(o);if(void 0===o||void 0===s||void 0===r.id)return;return{name:s,isRoot:this._isRootItem(s),graphItemUrl:"/drives/".concat(r.driveId,"/items/").concat(r.id),relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:{id:r.id}}}}else{if(u(e)&&t)return o=(c=(r=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(r.path))&&c+"/"+name,{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:r&&"/drives/".concat(r.driveId,"/items/").concat(t.id),relativePath:o,absolutePath:void 0,isFolder:!1,driveItem:t};var c;if(l(e)&&t)return o=(c=(r=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(r.path))&&c+"/"+name,{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:r&&"/drives/".concat(r.driveId,"/items/").concat(t.id),relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:t};if(t&&(r=t.parentReference&&t.parentReference)){o=this._getRelativePathFromVroomPath(r.path);var d=r.name?r.name:o&&this._getFileNameFromPath(o);return{name:d,isRoot:this._isRootItem(d),graphItemUrl:"/drives/".concat(r.driveId,"/items/").concat(r.id),relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:{id:r.id}}}}},e.prototype._getNavLink=function(e,t){var n=e.webUrl,a=n&&new y.t(n),i=t.navigationId;return a&&i&&a.setQueryParameter("nav",i),a.toString()||n},e.prototype._getNavId=function(e){return e&&e.navigationId},e.prototype._getNavigationId=function(e){var t,n,a;if(null==e?void 0:e.docDetails)return this._getNavId(e.docDetails);if(S&&o(e)){var i=g(e);return(null===(t=null==i?void 0:i.comment)||void 0===t?void 0:t.navigationId)?null===(n=null==i?void 0:i.comment)||void 0===n?void 0:n.navigationId:null===(a=null==i?void 0:i.comment)||void 0===a?void 0:a.commentId}},e.prototype._getAction=function(e,t,n,a){var i,l={};if(d(a)&&(l.version={newVersion:g(a).version.newVersion}),f(a)){var u=g(a).move;if(r(a)){var m=void 0,v=void 0;u.from&&(m=this._getDirNameFromPath(u.from)),u.to&&(v=this._getDirNameFromPath(u.to)),l.move={from:{name:this._getFileNameFromPath(m),isRoot:this._isRootItem(m),graphItemUrl:void 0,absolutePath:m},to:{name:this._getFileNameFromPath(v),isRoot:this._isRootItem(v),graphItemUrl:void 0,absolutePath:v}}}else if(u.From){var y=this._getDirNameFromPath(u.From);l.move={from:{name:this._getFileNameFromPath(y),isRoot:this._isRootItem(y),graphItemUrl:void 0,absolutePath:y},to:void 0}}else if(u.to){var S=this._getDirNameFromPath(u.to);l.move={from:void 0,to:{name:this._getFileNameFromPath(S),isRoot:this._isRootItem(S),graphItemUrl:void 0,absolutePath:S}}}}if(p(a)){var D=g(a).rename;l.rename={newItem:{name:D.newName,isRoot:this._isRootItem(D.newName),graphItemUrl:t?t.graphItemUrl:void 0,relativePath:t?t.relativePath:void 0,absolutePath:t?t.absolutePath:void 0,driveItem:t?t.driveItem:void 0},oldItem:{name:D.oldName,isRoot:this._isRootItem(D.oldName),graphItemUrl:t?t.graphItemUrl:void 0,relativePath:t?t.relativePath:void 0,absolutePath:t?t.absolutePath:void 0,driveItem:t?t.driveItem:void 0}}}if(s(a)&&(i=g(a).comment).isReply&&(l.commentResponse={commentAuthor:i.parentAuthor&&i.parentAuthor.user}),o(a)&&((i=g(a).comment).isReply||(l.comment={commentId:i.commentId})),c(a)){var I=g(a).mention;l.mention={mentionees:I.mentionees&&I.mentionees.map(function(e){return e.user})||[],commentId:r(a)?I.navigationId:void 0}}if(_(a)){var x=g(a).share;l.share={recipients:x.recipients&&x.recipients.map(function(e){return e.user})||[]}}if(h(a)&&(l.addShortcutToOneDrive={}),b(a)){var C=g(a).addToOneDrive;l.removeShortcutFromOneDrive={mountPointName:C.mountPointName}}return l},e.prototype._getRelativePathFromVroomPath=function(e){if(e)return e.split(":",2)[1]},e.prototype._getDirNameFromPath=function(e){return e&&e.substring(0,e.lastIndexOf("/"))},e.prototype._getFileNameFromPath=function(e){return e&&e.substring(e.lastIndexOf("/")+1)},e.prototype._isRootItem=function(e){return e&&"/LiveFolders"===e},e}();t.e=D},3130:function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a=n(0),i=n(240),r=n(3060),o=n(194),s=n(80),c=n(1054),d=n(1067),l=n(1064),u=n(1065),f=n(779),p=n(193),m=n(8).e.isActivated("A8ABE184-9647-42E8-BBAD-7AC7F51995D6","5/20/2022","Fix signals positioning in nameAndPathColumn")?[f.t,r.e]:[r.e,f.t],_=Object(c.e)({key:o.s,name:i.c,fieldName:"",isCollapsible:!1,minWidth:445,maxWidth:445,sortProps:s.a,data:{facets:Object(a.__assign)({},p.e.pack("nameAndPath"))}},Object(a.__spreadArray)(Object(a.__spreadArray)([d.e],m,!0),[l.e,u.e],!1))},3131:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(5),i=new a.e("itemPathField",{displayPathSegments:a.t,openUrl:a.t,action:a.t})},3145:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(79),i=n(2747);function r(e,t){var n,r=null!==(n=t.driveItemKey)&&void 0!==n?n:{};return r.driveId===function(e,t){var n=t.endpoint;if(n){var r=a.e.serialize({endpoint:n,driveId:i.n,itemId:i.a}),o=e.demandItemFacet(a.e,r,{suppressGetItems:!1});return null==o?void 0:o.driveId}}(e,{endpoint:r.endpoint})}},3146:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("mountPoint")},3147:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("graphThumbnailSet")},3164:function(e,t,n){"use strict";n.d(t,"e",function(){return C}),n.d(t,"t",function(){return O});var a=n(0),i=n("react-lib"),r=n(70),o=n(312),s=n(512),c=n(2209),d=n(1440),l=n(375),u=n(126);Object(u.n)([{rawString:".iconContainer_8aac815c{position:relative;font-size:16px;margin:0 4px;height:16px;width:16px}.brandIcon_8aac815c{position:relative;margin:0 4px;height:16px;width:16px}.brandIcon_8aac815c img{display:block}.menuItemIconContainer_8aac815c{position:relative;margin:0 4px;height:36px;line-height:36px;width:14px}.logoFillIcon_8aac815c,.logoIcon_8aac815c{height:100%;position:absolute;left:0;right:0}.logoFillIcon_8aac815c[data-icon-name=ExcelLogo16],.logoIcon_8aac815c[data-icon-name=ExcelLogo16]{color:#217346}.logoFillIcon_8aac815c[data-icon-name=OneNoteLogo16],.logoIcon_8aac815c[data-icon-name=OneNoteLogo16]{color:#5c2d91}.logoFillIcon_8aac815c[data-icon-name=PowerPointLogo16],.logoIcon_8aac815c[data-icon-name=PowerPointLogo16]{color:#d24726}.logoFillIcon_8aac815c[data-icon-name=WordLogo16],.logoIcon_8aac815c[data-icon-name=WordLogo16]{color:#2b579a}.logoFillIcon_8aac815c[data-icon-name=VisioLogo16],.logoIcon_8aac815c[data-icon-name=VisioLogo16]{color:#3854a2}.logoFillIcon_8aac815c{color:#fff}.contextualMenuItemLinkContent_8aac815c{white-space:nowrap;height:inherit;display:flex;align-items:center;max-width:100%}.contextualMenuItemTextLabel_8aac815c{margin:0 4px;vertical-align:middle;display:inline-block;flex-grow:1;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}"}]);var f=n(16),p=n(56),m=n(4),_=n(3291),h={key:n(1520).e,automationId:"openInOfficeOnlineCommand",action:i.createElement(_.t,null),facets:Object(a.__assign)({},r.t.pack(!0))},b=n(3397),g={key:n(1521).e,automationId:"openInOfficeClientCommand",action:i.createElement(b.t,null),facets:Object(a.__assign)({},r.t.pack(!0))},v=n(2),y=n(1470),S=new v.e("fileHandlerOpenCommand").id,D=Object(f.r)()(Object(f.a)()(Object(p.e)(function(e,t){var n=t.itemKey,a=t.item,i=e.demandItem({appMap:d.e},n).appMap,r=a.name;return a.key===h.key?r=r||(i?Object(l.r)(i,!1):l.e.OpenInBrowser):a.key===g.key&&(r=r||(i?Object(l.o)(i,!0):l.e.Open)),{name:r}})(function(e){return i.createElement("div",{className:"contextualMenuItemLinkContent_8aac815c"},i.createElement("span",{dir:"auto",className:"contextualMenuItemTextLabel_8aac815c"},e.name))}))),I=Object(f.r)()(Object(f.a)()(Object(p.e)(function(e,t){var n=t.itemKey,i=t.menuProps,r=e.demandItem({appMap:d.e,fileName:m.p},n),o=r.appMap,s=r.fileName,c={};if(i&&i.items){var u=i.items[0];u&&-1!==u.key.indexOf(S)&&u.iconProps&&(c=u.iconProps)}var f=!!s&&!!s.extension&&".pdf"===s.extension.toLowerCase(),p={iconName:o?Object(l.t)(o):f?"PDF":"OpenFile"},_=void 0;return i&&i.items&&(_=i.items.map(function(e){return e.key===h.key?Object(a.__assign)(Object(a.__assign)({},e),{iconProps:p,name:e.name||o&&Object(l.r)(o,!0)||(f?l.e.OpenInBrowser:l.e.Open),onRenderIcon:o?x.bind(void 0,o,!0):void 0}):e.key===g.key?Object(a.__assign)(Object(a.__assign)({},e),{iconProps:p,name:e.name||o&&Object(l.i)(o),onRenderIcon:o?x.bind(void 0,o,!0):void 0}):e})),{iconProps:c||p,onRenderIcon:o?x.bind(void 0,o,!1):void 0,text:l.e.Open,menuProps:_?Object(a.__assign)(Object(a.__assign)({},i),{items:_}):i}})(c.e)));function x(e,t){var n=e&&Object(l.n)(e),a=e&&Object(l.a)(e);return a?i.createElement(y.e,{size:16,extension:"",brand:a.toLowerCase(),className:"brandIcon_8aac815c"}):n?i.createElement("span",{className:t?"menuItemIconContainer_8aac815c":"iconContainer_8aac815c"},i.createElement(s.e,{iconName:n.logoFill16,className:"logoFillIcon_8aac815c"}),i.createElement(s.e,{iconName:n.logo16,className:"logoIcon_8aac815c"})):null}var C={key:o.e.key,automationId:o.e.automationId,subMenuProps:{items:[h,g]},onRender:function(e){return i.createElement(I,Object(a.__assign)({},e,{menuProps:e.subMenuProps}))},facets:Object(a.__assign)({},r.t.pack(!0))},O={key:o.e.key,automationId:o.e.automationId,name:o.e.name,subMenuProps:{items:[h,g],contextualMenuItemAs:D},facets:Object(a.__assign)({},r.t.pack(!0))}},3206:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=n(8).e.isActivated("EB854331-5340-42D0-8893-9E093DC56A47","03/10/2022","Use standard Open command for Office files")},3207:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(23),i=n(19),r=new a.e("commands",{endpoint:i.e,driveId:i.t})},3208:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"n",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"i",function(){return c}),n.d(t,"r",function(){return d}),n.d(t,"o",function(){return l}),n.d(t,"s",function(){return u}),n.d(t,"c",function(){return f}),n.d(t,"d",function(){return p});var a=n(2),i=new a.e("addToOneDrive"),r=new a.e("createFolder"),o=new a.e("createLink"),s=new a.e("delete"),c=new a.e("download"),d=new a.e("invite"),l=new a.e("move"),u=new a.e("officeLens"),f=new a.e("rename"),p=new a.e("upload")},3291:function(e,t,n){"use strict";n.d(t,"e",function(){return f}),n.d(t,"t",function(){return p});var a=n(0),i=n(1995),r=n(56),o=n(26),s=n(4),c=n(16),d=n(38),l=n(1535),u=n(1440),f=Object(r.e)(function(e,t){var n=t.itemKey,r=e.demandItem({openUrl:s.A,appFacet:u.e,isMalwareDetected:s.O},n),o=r.openUrl,c=r.appFacet,f=r.isMalwareDetected,p=e.demandItemFacet(l.e,n),m=l.e.evaluate(p)(e,{itemKey:n,isAvailable:!f&&!!c&&!!o,forceInSameWindow:!1}),_=m.isAvailable,h=m.forceInSameWindow,b=m.getOpenUrl,g=m.onExecute;return Object(a.__assign)({isAvailable:_,onExecute:function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var e,t,n;return Object(a.__generator)(this,function(a){return e=null==b?void 0:b(),t=(new Date).getTime().toString(),(n=e||o&&i.e.AddWopiPerfMarkToTargetUrl(t,"ItemsView",o))&&(g&&g(),h?window.location.href=n:window.open(n)),[2]})})}},Object(d.t)(e,{itemKey:n,engagement:{name:"OpenInOfficeOnline",isIntentional:!0}}))})(o.e),p=Object(c.r)()(Object(c.a)()(f))},3292:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("hasThumbnailAuthTokenFacet")},3397:function(e,t,n){"use strict";n.d(t,"e",function(){return b}),n.d(t,"t",function(){return g});var a=n(0),i=n(104),r=n(1501),o=n(56),s=n(26),c=n(16),d=n(38),l=n(4),u=new(n(5).e)("openInOfficeClientAction",{}),f=n(1440),p=n(79),m=n(2930),_=new i.e,h=function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2]})})},b=Object(o.e)(function(e,t){var n=t.itemKey,i=e.demandItem({key:p.e,appMap:f.e,fileName:l.p,openUrl:l.A,canonicalUrl:l.i,isMalwareDetected:l.O},n),o=i.key,s=i.appMap,c=i.fileName,b=i.openUrl,g=i.canonicalUrl,y=i.isMalwareDetected,S=!1,D=h,I=Object(m.r)(e,{itemKey:n,oneOfRequiredRoles:["write","owner"]});if(n){var x=!y&&!!s&&!!b&&(_.isMac||_.isWindows||_.isIOS||_.isWinPhone||_.isAndroid),C=e.demandItemFacet(u,n),O=u.evaluate(C)(e,{itemKey:n,isAvailable:x,protocolCallback:v}),w=O.protocolCallback,E=O.isAvailable;S=x&&E,o&&S&&(D=function(e){var t=this,n=e.key,i=e.openUrl,o=e.canonicalUrl,s=e.canEdit,c=e.appMap,d=e.fileName,l=e.isNew,u=e.defaultLocation,f=e.protocolCallback;return function(){return Object(a.__awaiter)(t,void 0,void 0,function(){var e,t;return Object(a.__generator)(this,function(a){return n?(e=!!s,t=function(){i&&window.open(i)},Object(r.e)({app:c||"",itemUrl:o||"",extension:d&&d.extension||"",shouldEdit:e,isNew:Boolean(l),defaultLocation:u||"",platformDetection:_,onNavigate:f,onFailureCallback:t}),[2]):[2]})})}}({key:o,openUrl:b,canonicalUrl:g,canEdit:I,appMap:s,fileName:c,protocolCallback:w}))}return Object(a.__assign)({isAvailable:S,onExecute:D},Object(d.t)(e,{itemKey:n,engagement:{name:"OpenInOfficeClient",isIntentional:!0}}))})(s.e),g=Object(c.r)()(Object(c.a)()(b));function v(e){window.location.href=e}},3444:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(23),i=n(19),r=new a.e("thumbnailToken",{endpoint:i.e,driveId:i.t})},3445:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("specialFolder")},3522:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(23),i=n(19),r=new a.e("userByEmail",{email:i.e,endpoint:i.e})},3534:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(1504),i=n(280),r={key:"OpenFileLocation",name:i.i,title:i.i,action:a.t,iconProps:{iconName:"FabricFolder"}}},3535:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("thumbnailAccessToken")},3536:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(893);function i(e){var t=e.replace(".",""),n=Object.keys(a.e);for(var i in n)if(a.e.hasOwnProperty(n[i])){var r=n[i];if(a.e[r].indexOf(t)>-1)return r}}},3537:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("hasPdfFacet")},3538:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("passwordProtectedErrorFacet")},3539:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(23),i=n(19),r=new a.e("currentUserKey",{endpoint:i.e})},3634:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(5),i=new a.e("deleteProgress",{commands:a.t,description:a.t})},3659:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(23),i=n(19),r=new a.e("driveItemByPath",{endpoint:i.e,driveId:i.t,path:i.e})},3660:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("restricted")},3661:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("tags")},3662:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("isPhotoStreamItem")},3663:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(23),i=n(402),r=n(79),o=new a.e("driveItemUnauthenticatedThumbnail",{driveItemKey:r.e.subKeyPart,width:i.e,height:i.e})},3665:function(e,t,n){"use strict";n.d(t,"e",function(){return m});var a,i=n(0),r=n(18),o=n(48),s=n(477),c=n(98),d=n(3664),l=n(7),u=n(592),f=n(1294),p=((a={})[o.a.started]=function(e){return Object(r.formatToArray)(Object(r.getLocalizedCountValue)(d.r,d.t,e)||"",e)},a[o.a.completed]=function(e){return Object(r.formatToArray)(Object(r.getLocalizedCountValue)(d.e,d.t,e)||"",e)},a[o.a.failed]=function(e){return Object(r.formatToArray)(Object(r.getLocalizedCountValue)(d.n,d.a,e)||"",e)},a[o.a.canceled]=function(e){return Object(r.formatToArray)(Object(r.getLocalizedCountValue)(d.n,d.a,e)||"",e)},a),m=Object(l.t)(function(){return function(e){e(Object(u.e)(f.e,s.e)(_))}});function _(e,t){var n,a=Object(c.a)(e,t),r=a.phase,o=a.count;return n=p[r](o),Object(i.__assign)({},n&&"item"!==t.format?{title:n}:{})}},3920:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("isUnauthenticatedConfiguration")},3921:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("coverImage")},3922:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(8),i=function(){return a.e.isActivated("8B2678E4-71A6-4034-A604-01CE2E306BA6","07/28/2022","Use getItemThumbnailOperation to get thumbnail blob for each item")}},3923:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(55),i=n(2),r=n("react-lib"),o=n(280),s=n(795),c={action:r.createElement(a.t,null,r.createElement(s.t,null)),automationId:"removeShortcutFromSharedWithMeCommand",title:o.c,iconProps:{iconName:"FabricFolderLink"},key:new i.e("RemoveShortcutFromSWM").id,name:o.s}},4003:function(e,t,n){"use strict";n.d(t,"e",function(){return M});var a=n("react-lib"),i=n(55),r=n(0),o=n(188),s=n(220),c=n(2017),d=n(961),l=n(1294),u=n(4),f=n(56),p=n(44),m=n(153),_=n(22),h=n(26),b=n(16),g=n(1621),v=n(38),y=n(222),S=n(8),D=Object(f.t)(function(e,t){var n=t.itemKeys,i=t.removeFromSharedListWizard,o=t.removeItemsFromSharedList,s=void 0===o?l.t:o,c=Object(p.e)(e)||"",d=e.demandItemFacet(y.e,c);if(0===n.length)return null;for(var u=d&&n.length<=200,f=i,b=0,D=n;b<D.length;b++){var I=D[b],x=e.demandItemFacet(g.e,I),C=S.t.isActivated("6c28a705-1f14-4f06-97c7-ee39b2d66e9e","11/5/2020","Action should be available unless otherwise stated in control handler");g.e.evaluate(x)(e,{itemKey:I,isAvailable:!C}).isAvailable||(u=!1)}var O=e.dispatch,w=function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e,t;return Object(r.__generator)(this,function(a){switch(a.label){case 0:return e={itemSetKey:c},t=Object(m.e)(n,function(){return e}),[4,O(s({items:t}))];case 1:return a.sent(),[2]}})})},E=Object(_.o)(function(e){return a.createElement(f,Object(r.__assign)({},e,{onItemRemoved:w,itemKeys:n}))});return a.createElement(h.e,Object(r.__assign)({isAvailable:u,onExecute:E},Object(v.t)(e,{itemKey:void 0,engagement:{name:"RemoveFromSharedList",isIntentional:!0,extraData:{itemCount:n.length}}})))}),I=Object(b.r)()(D),x=n(4320),C=n(3664),O=n(3665),w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.resolve,i=t.reject,d=t.onItemRemoved,l=t.itemKeys,u=function(){return Object(r.__awaiter)(e,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return n(),[4,d()];case 1:return e.sent(),[2]}})})},f=function(){return Object(r.__awaiter)(e,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return i(new o.e),[2]})})};return a.createElement(s.e,null,function(e){var t=e.itemCache,n=E(t,l),i=n.title,r=n.prompt;return a.createElement(c.ConfirmationDialog,{onCancel:f,onConfirm:u,yesText:C.i,noText:x.o,defaultToYes:!0,title:i,prompt:r})})},t}(a.PureComponent),E=function(e,t){if(t.length>1)return{title:x.r,prompt:x.i};if(1===t.length){var n=e.demandItemFacet(u._,t[0]);return{title:n?x.a:x.t,prompt:n?x.n:x.e}}return{title:"",prompt:""}},A=Object(d.e)({operationTypeFacet:l.n,progressKeyFacet:l.e,initializeBatch:function(){return O.e}}),L=Object(f.e)(function(){return{removeFromSharedListWizard:w,removeItemsFromSharedList:A}})(I),k=n(280),M={key:new(n(2).e)("removeFromSharedList").id,automationId:"removeFromSharedListCommand",name:k.l,action:a.createElement(i.t,null,a.createElement(L,null)),iconProps:{iconName:"Cancel"}}},4076:function(e,t,n){"use strict";var a,i;n.d(t,"e",function(){return i}),function(e){e[e.MalwareDetected=0]="MalwareDetected",e[e.ThisFileIsCheckedOut=1]="ThisFileIsCheckedOut",e[e.DLPBlocked=2]="DLPBlocked",e[e.MissingMetaData=3]="MissingMetaData",e[e.DLPWarning=4]="DLPWarning",e[e.AwaitingApproval=5]="AwaitingApproval",e[e.Trending=6]="Trending",e[e.New=7]="New",e[e.NeedsRepublishing=8]="NeedsRepublishing"}(a||(a={})),function(e){e[e.Mail=0]="Mail",e[e.CalendarEvent=1]="CalendarEvent",e[e.Teams=2]="Teams"}(i||(i={}))},4093:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(0),i=n(194),r=n(240),o=n(3060),s=n(1054),c=n(80),d=n(193),l=Object(s.e)({key:i.c,name:r.d,fieldName:"",isCollapsible:!1,minWidth:c.e.regularMin,maxWidth:c.e.displayNameMax,sortProps:void 0,isResizable:!0,data:{facets:Object(a.__assign)({},d.e.pack("path"))}},[o.e])},4096:function(e,t,n){"use strict";function a(e){return"."===e[0]}n.d(t,"e",function(){return a})},4097:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=n(210).n.isFeatureEnabled({ODC:"EnableDefaultSortOrderFromBackend"})},4098:function(e,t,n){"use strict";n.d(t,"e",function(){return I}),n.d(t,"t",function(){return x});var a=n(0),i=n(4),r=n(128),o=n(79),s=n(3147),c=n(3444),d=n(3535),l=n(3292),u=n(2926),f=n(674),p=n(179),m=n(395),_=n(340),h=n(8),b=n(1090),g=n(3663),v=n(170),y=n(3922),S=h.e.isActivated("AB808229-F141-4F5A-B7E9-C1DEF8EC6F64","10/21/2021","Enable crop mode for folder cover thumbnail"),D=h.e.isActivated("75843FC5-8F0A-4925-BB0B-AA5FCE46444C","02/07/2022","Enable various thumbnail fixes in ItemResultProcessor and addon-graph ItemThumbnailControl");function I(e,t){var n=t.itemKey,h=t.desiredSize,S=t.fitMode,I=t.requestOptions,C=e.demandItemFacet(o.e,n);if(!C)return{};var O=e.demandItemFacet(l.e,n)?function(e,t){var n=t.itemKey,a=t.desiredSize,i=t.fitMode,r=x(e.demandItemFacet(s.e,n));if(r&&r.large){var o=e.demandItemFacet(u.e,n),c=o&&(o["@microsoft.graph.downloadUrl"]||o["@content.downloadUrl"]),d=Object(b.e)(e,{itemKey:n});return{url:E(d&&c||r.large.url,a,i,d),width:0,height:0}}}(e,{itemKey:n,driveItem:C,desiredSize:h,fitMode:S}):function(e,t){var n,o,s=t.itemKey,l=t.driveItem,u=t.desiredSize;if(!D){var h=!!e.demandItemFacet(i._,s),b=!!e.demandItemFacet(r.i,s);if(h||b)return}if(!Object(y.e)()&&!(null===(n=t.requestOptions)||void 0===n?void 0:n.allowsHeaders))return function(e,t){var n=t.driveItem,a=t.desiredSize,i=Math.ceil(a.width),r=Math.ceil(a.height),o=g.e.serialize({driveItemKey:{driveId:n.driveId,itemId:n.itemId,endpoint:n.endpoint},width:i,height:r}),s=e.demandItemFacet(v.h,o);return s?{url:s.url,height:i,width:r}:void 0}(e,{driveItem:l,desiredSize:u});var S,I,x=e.demandItemFacet(i.f,s,{suppressGetItems:!0})||"",C=new p.e(l.endpoint).authority;if(D)I=l.endpoint.indexOf("/_api/v2.")>-1,S="".concat(C,I?"/_api/v2.1":"/v1.0");else{I=l.endpoint.indexOf("/v2.")>-1;var O=Object(f.a)(e,l.endpoint);S="".concat(C,I&&!O?"/_api/v2.1":"/v1.0")}var w=c.e.serialize({endpoint:S,driveId:l.driveId}),E=e.demandItemFacet(d.e,w);if(E){var A=Object(m.t)({endpoint:S,driveId:l.driveId,itemId:l.itemId}),L=Math.ceil(u.width),k=Math.ceil(u.height),M="".concat(A,"/thumbnails/0/c").concat(L,"x").concat(k,"/content"),P={prefer:"noredirect,closestavailablesize",cb:x};if(I||!D){var T=Object(a.__assign)(Object(a.__assign)({},P),{access_token:{uriValue:E}});return{url:"".concat(M,"?").concat(Object(_.e)(T)),width:L,height:k}}if(null===(o=t.requestOptions)||void 0===o?void 0:o.allowsHeaders){var U={Authorization:"bearer ".concat(E)};return{url:"".concat(M,"?").concat(Object(_.e)(P)),width:L,height:k,headers:U}}}}(e,{itemKey:n,driveItem:C,desiredSize:h,requestOptions:I});return O?{thumbnail:O}:{}}function x(e){return e&&(t=e)&&"number"==typeof t.length?e[0]:e;var t}var C=/width=[0-9]*/,O=/height=[0-9]*/,w=/cropmode=[a-z]*/;function E(e,t,n,a){if(a)return e;if(!S){var i="cover"===n?"center":"none";w.test(e)?e=e.replace(w,"cropmode=".concat(i)):e+="".concat(e.indexOf("?")>-1?"&":"?","cropmode=").concat(i)}var r="number"==typeof t.width?Math.ceil(t.width):t.width,o="number"==typeof t.height?Math.ceil(t.height):t.height,s="".concat(r||"");C.test(e)?e=e.replace(C,"width=".concat(s)):e+="".concat(e.indexOf("?")>-1?"&":"?","width=").concat(s);var c="".concat(o||"");return O.test(e)?e=e.replace(O,"height=".concat(c)):e+="".concat(e.indexOf("?")>-1?"&":"?","height=").concat(c),e}},4099:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(5),i=new a.e("moveCopyProgress",{commands:a.t,description:a.t})},4317:function(e,t,n){"use strict";n.r(t),n.d(t,"recentContextMenuControlHandler",function(){return f});var a=n(312),i=n(238),r=n(761),o=n(3534),s=n(336),c=n(3164),d=n(3206),l={name:"-",key:"divider_1",itemType:s.e.Divider},u=[d.e?a.e:c.t,o.e,l,i.n,i.t,r.e];function f(e,t){return{commands:u}}},4321:function(e,t,n){"use strict";n.r(t),n.d(t,"sharedWithMeContextMenuControlHandler",function(){return b});var a=n(0),i=n(312),r=n(238),o=n(453),s=n(761),c=n(1313),d=n(3923),l=n(4003),u=n(336),f=n(8),p=n(3164),m=n(3206),_=!f.t.isActivated("A62AD86A-B7EB-4EF6-A7F2-CC139D544AE7","",""),h={name:"-",key:"divider_1",itemType:u.e.Divider};function b(e,t){return{commands:Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)([m.e?i.e:p.t,r.n,r.t],_?[h]:[],!0),[c.e],!1),_?[o.e]:[],!0),[d.e,l.e,s.e],!1)}}},4519:function(e,t,n){"use strict";n.d(t,"e",function(){return m}),n.d(t,"t",function(){return _});var a,i=n(0),r=n(109);!function(e){e[e.MalwareDetected=0]="MalwareDetected",e[e.ThisFileIsCheckedOut=1]="ThisFileIsCheckedOut",e[e.DLPBlocked=2]="DLPBlocked",e[e.MissingMetaData=3]="MissingMetaData",e[e.DLPWarning=4]="DLPWarning",e[e.AwaitingApproval=5]="AwaitingApproval",e[e.Trending=6]="Trending",e[e.New=7]="New",e[e.NeedsRepublishing=8]="NeedsRepublishing"}(a||(a={}));var o=n(1016),s=n(41),c=n(672),d=n(474),l=n(2856),u=6e3,f="/_layouts/15/userphoto.aspx?size=S&accountname=",p="v2.1",m=function(){function e(e,t){this._eTagMap={},this._dataRequestor=t.vroomDataRequestor;var n=t.getProfileImageUrl,a=void 0===n?function(e){return Object(o.getUserPhotoUrl)(e)}:n,i=t.caller,r=void 0===i?"hovercard":i,s=t.useSharePointApi,c=void 0!==s&&s;this._getProfileImageUrl=a,this._caller=r,this._useSharePointApi=c}return e.prototype.getItemAnalytics=function(e,t){void 0===t&&(t={});var n=t.apiVersion,a=void 0===n?p:n,i=t.skipToken,o=void 0===i?"":i,s=t.headers,c=void 0===s?{Caller:this._caller}:s,d=o?";$skiptoken=".concat(o):"",l=e.queryType?"_".concat(e.queryType):"",u="GetItemAnalytics".concat(a).concat(l,"_WithGuestUser"),f=this._getBaseUrl(e);if(!f)return r.n.resolve();var m="".concat(f,"/analytics/allTime?$expand=activities"),_="".concat(m).concat("($filter=access%20ne%20null)").concat(d);return this._getAnalytics(u,_,!1,e,c)},e.prototype.getAnalyticsSections=function(e,t){if(void 0===t&&(t={}),this._useSharePointApi)return r.n.reject(void 0);var n=t.headers,a=void 0===n?{Caller:this._caller}:n,i=this._getBaseUrl(e);if(!i)return r.n.resolve();var o="$select=*".concat(",id,reactions").concat(",malware,metadataMissing,awaitingApproval,trending,retentionPolicy,publication,dataLossPrevention"),s="".concat(o,"&").concat("$expand=insights($expand=keyPoints)"),c=this._useSharePointApi?"".concat(i,"/driveItem?").concat(s):"".concat(i,"?").concat(s);return this._getAnalytics("GetAnalyticsSections_WithReaction_WithKeyPoints_WithLifeCycle",c,!0,e,a)},e.prototype.getItemAnalyticsSections=function(e,t){void 0===t&&(t={});var n="$expand=analytics($expand=allTime($expand=activities($filter=access%20ne%20null)))",a=this._getBaseUrl(e);if(!a)return r.n.resolve();var i=t.apiVersion,o=void 0===i?p:i,s=t.headers,c=void 0===s?{Caller:this._caller}:s,d=e.queryType?"_".concat(e.queryType):"";if(this._useSharePointApi){var l="GetItemAnalyticsSharePoint".concat(o).concat(d),u="".concat(a,"/driveItem?").concat(n);return this._getAnalytics(l,u,!0,e,c)}var f="GetItemAnalyticsSections".concat(o).concat(d,"_WithGuestUser_WithReaction_WithKeyPoints_WithLifeCycle"),m="$select=*".concat(",id,reactions").concat(",malware,metadataMissing,awaitingApproval,trending,retentionPolicy,publication,dataLossPrevention"),_="".concat(m,"&").concat(n).concat(",insights($expand=keyPoints)"),h="".concat(a,"?").concat(_);return this._getAnalytics(f,h,!0,e,c)},e.prototype.getLastSevenDaysItemAnalytics=function(e){var t=this._getBaseUrl(e),n={Caller:this._caller};if(!t)return r.n.resolve();var a="".concat(t,"/analytics/lastSevenDays?$expand=activities($filter=ActivityType%20eq%20%27Access%27)");return this._getAnalytics("GetLastSevenDaysItemAnalytics",a,!1,e,n)},e.prototype.getItemAnalyticsByInterval=function(e,t,n,a){var i=p,r=t.toISOString(),o=n.toISOString(),s=this._getBaseUrl(e)||"",c=this._getAnalyticsByIntervalPath(s,i,r,o,a);return this._getAnalyticsByInterval("GetDailyItemAnalytics",c,e.getAccessToken&&e.getAccessToken(),i)},e.prototype._getAnalytics=function(e,t,n,a,r,o){var s=this;return this._dataRequestor.send({apiName:e,path:t,accessToken:a.getAccessToken&&a.getAccessToken(),headers:r,timeout:u,qosExtraData:{Caller:this._caller}}).then(function(e){return"string"==typeof e.isTrending&&"True"===e.isTrending||"boolean"==typeof e.isTrending&&!0===e.isTrending?e.isTrending=!0:e.isTrending=!1,e.eTag&&(s._eTagMap[a.itemId]=e.eTag),n?_(e,s._getProfileImageUrl):function(e,t){var n=e.activities,a=e.access,r=e.endDateTime,o=Object(i.__rest)(e,["activities","access","endDateTime"]);return{activities:b(n,t),incompleteData:o.incompleteData,startDateTime:o.startDateTime,skipToken:o.skipToken,isTrending:o.isTrending,viewCount:a&&a.actionCount,viewerCount:a&&a.actorCount,lastActivityDateTime:r}}(e,s._getProfileImageUrl)})},e.prototype.updateItemKeyPoints=function(e,t){var n=this,a="".concat(this._getBaseUrl(e),"/insights/keyPoints");return this._dataRequestor.send({path:a,apiName:"UpdateKeyPoints",requestType:"POST",headers:{Caller:this._caller,"if-Match":this._eTagMap[e.itemId]},postData:JSON.stringify({value:t}),accessToken:e.getAccessToken&&e.getAccessToken(),timeout:u,qosExtraData:{Caller:this._caller},parseResponse:function(t){return n._eTagMap[e.itemId]=t.getResponseHeader("eTag")||"",JSON.parse(t.responseText)}}).then(function(e){return e.value})},e.prototype._getAnalyticsByInterval=function(e,t,n,a){return this._dataRequestor.send({apiName:e,path:t,accessToken:n,useAuthorizationHeaders:this._useSharePointApi,timeout:u,qosExtraData:{Caller:this._caller}}).then(function(e){var t;return"v2.1"===a?(e=e)&&e.value&&(t=e.value.map(g)):t=(e=e).Items,t})},e.prototype._getBaseUrl=function(e){return e&&e.graphItemUrl?"".concat(e.graphItemUrl):null},e.prototype._getAnalyticsByIntervalPath=function(e,t,n,a,i){var r;i=i||"day";var o="v2.1"===t?"oneDrive.getActivitiesByInterval":"getanalyticsbyinterval";return r=this._useSharePointApi?"interval='".concat(i,"',startDateTime='").concat(n,"',endDateTime='").concat(a,"'"):"v2.1"===t?"startDateTime=".concat(n,"&endDateTime=").concat(a,"&interval=").concat(i):"startDateTime='".concat(n,"'&endDateTime='").concat(a,"'&interval='").concat(i,"'"),this._useSharePointApi?"".concat(e,"/oneDrive.getActivitiesByInterval(").concat(r,")"):"".concat(e,"/").concat(o,"?").concat(r)},e.prototype.getFilesAnalytics=function(e,t,n){var a=this;return e&&t?this._dataRequestor.send({apiName:"getFilesAnalytics.byItems",useAuthorizationHeaders:!0,accessToken:n,apiVersion:"v2.1",path:"".concat(t,"/items?$expand=analytics($expand=lastSevenDays)&$filter=sharepointIds/listItemUniqueId eq '").concat(e.join("' or sharepointIds/listItemUniqueId eq '"),"'"),postProcessQos:this._overrideFilesAnalyticsExpectedFailure}).then(function(e){return a._parseFilesAnalyticsResponse(e)}):r.n.resolve()},e.prototype.getRecommendedActions=function(e){var t="".concat(this._getBaseUrl(e)).concat("?$expand=recommendedActionSet($expand=nonAggregatedRecommendedActions,aggregatedEditRecommendedAction($expand=importantActorsAndActivities))");return this._dataRequestor.send({apiName:"RecommendedActions",path:t,accessToken:e.getAccessToken&&e.getAccessToken(),timeout:u,parseResponse:function(e){return JSON.parse(e.responseText).recommendedActionSet},headers:{Caller:this._caller},qosExtraData:{Caller:this._caller}})},e.prototype.getShareWith=function(e){var t="".concat(this._getBaseUrl(e)).concat("/recommendations/shareWith/users?$top=2&$filter=userType eq 'Internal'");return this._dataRequestor.send({apiName:"ShareWith",path:t,accessToken:e.getAccessToken&&e.getAccessToken(),timeout:u,parseResponse:function(e){return JSON.parse(e.responseText).value},headers:{Caller:this._caller},qosExtraData:{Caller:this._caller}})},e.prototype._overrideFilesAnalyticsExpectedFailure=function(e,t){var n=t?Object(c.t)(t,function(e){if("notSupported"===e)return{resultType:s.t.ExpectedFailure}}):{};return Object(i.__assign)(Object(i.__assign)({},e),n)},e.prototype._parseFilesAnalyticsResponse=function(e){var t=this,n=(e.value,Object(i.__rest)(e,["value"])),a=e.value.map(function(e){var n=e.analytics,a=Object(i.__rest)(e,["analytics"]);return Object(i.__assign)(Object(i.__assign)({},a),{analytics:{lastSevenDays:h(n.lastSevenDays,t._getProfileImageUrl)}})});return Object(i.__assign)(Object(i.__assign)({},n),{value:a})},e}();function _(e,t){var n=e&&e.analytics&&e.analytics.allTime,i=n&&n.access,r=n&&n.endDateTime,o=b(n&&n.activities,t),s=function(e){var t,n,i,r=[];return e.malware&&r.push({status:a.MalwareDetected}),e.publication&&e.publication.level.indexOf("checkout")>-1&&r.push({status:a.ThisFileIsCheckedOut,userCheckedOutThis:e.publication.checkedOutBy&&e.publication.checkedOutBy.user}),e.dataLossPrevention&&(e.dataLossPrevention.block?r.push({status:a.DLPBlocked}):e.dataLossPrevention.notify&&r.push({status:a.DLPWarning})),e.metadataMissing&&r.push({status:a.MissingMetaData}),e.awaitingApproval&&r.push({status:a.AwaitingApproval}),e.trending&&r.push({status:a.Trending}),e.createdDateTime&&(t=new Date(e.createdDateTime),n=(new Date).getTime(),i=t&&t.valueOf(),!isNaN(i)&&n-i<1728e5&&r.push({status:a.New,createdRelativeTime:Object(d.n)(Object(l.t)(e.createdDateTime)),creator:e.createdBy&&e.createdBy.user})),r}(e),c=function(e){var t=e&&e.insights,n=t&&t.keyPoints;return t&&{readTime:t.readTime,keyPoints:n}}(e),u=e&&e.reactions;return{activities:o||[],incompleteData:n&&n.incompleteData,startDateTime:n&&n.startDateTime,skipToken:n&&n.skipToken,isTrending:n&&n.isTrending,viewCount:i&&i.actionCount,viewerCount:i&&i.actorCount,commentCount:u&&u.commentCount,likeCount:u&&u.likeCount,lifeCycleStatus:s,keyPointsData:c,lastActivityDateTime:r,createdBy:e.createdBy&&e.createdBy.user,createdDateTime:e.createdDateTime}}function h(e,t){e.activities;var n=Object(i.__rest)(e,["activities"]),a=e.activities&&e.activities.map(function(e){var n=Object(i.__rest)(e,[]),a=n.actor&&n.actor.user&&n.actor.user.email;return n.activityDateTime=Object(d.n)(Object(l.t)(n.activityDateTime)),n.actor.user.image=t&&t(n.actor.user.email)||"".concat(f).concat(a),n});return Object(i.__assign)(Object(i.__assign)({},n),{activities:a})}function b(e,t){return e&&e.map(function(e){var n=Object(i.__rest)(e,[]),a=n.actor&&n.actor.user&&n.actor.user.email,r=Object(i.__assign)(Object(i.__assign)({},n.actor.user),{image:t?t(a):"".concat(f).concat(a),userType:n.actor.user.userType});return Object(i.__assign)(Object(i.__assign)({},n),{activityDateTime:Object(d.n)(Object(l.t)(n.activityDateTime)),actor:Object(i.__assign)(Object(i.__assign)({},n.actor),{location:n.location,user:r}),activityType:n.access?"Access":"Edit"})})}function g(e){return e&&{activity:{},incompleteData:{missingDataBeforeDateTime:e.endDateTime,wasThrottled:e.incompleteData&&e.incompleteData.wasThrottled},isTrending:e.isTrending,startDateTime:e.startDateTime,viewCount:e.access&&e.access.actionCount,viewerCount:e.access&&e.access.actorCount}}},4529:function(e,t,n){"use strict";n.r(t),n.d(t,"graphSharesAddon",function(){return S});var a=n(7),i=n(287),r=n(438),o=n(1300),s=n(0),c=n(674),d=n(395),l=n(79),u=n(3124),f=n(6),p=n(1028),m=n(286),_=n(351),h=n(167),b=n(58),g=n(179),v=n(8).e.isActivated("DBA99941-AB2F-497E-8E0F-5FFDE50EDC04","02/03/2023","Allow endpoint redirect in getSharesItem"),y=Object(a.i)({maxParallelOperationCount:8})(function e(t){var n=this,a=t.itemKey,i=o.e.deserialize(a),r=i.endpoint;return function(t){return Object(s.__awaiter)(n,void 0,void 0,function(){var n,o,y,S,D,I,x,C,O,w,E,A,L,k,M,P,T,U,F,H,R;return Object(s.__generator)(this,function(N){switch(N.label){case 0:return n=t(Object(h.e)({graphEndpoint:b.y,graphRecentEndpoint:b.I})),o=n.graphEndpoint,y=n.graphRecentEndpoint,[4,t(Object(c.t)(Object(s.__assign)({url:"".concat(Object(d.a)(i),"?$expand=thumbnails&select=*,webDavUrl"),qosName:"getSharesItem",endpoint:r,headers:{Prefer:"redeemSharingLinkIfNecessary"}},v?{}:{allowEndpointRedirect:!0})))];case 1:return S=N.sent(),D=new m.e({publisher:e}),I=S&&S.parentReference,x=I&&I.driveId,C=S&&S.webDavUrl,!v&&C&&(O=new g.e(C).authority,w=new g.e(r),E=w.authority,A=w.path,E!==O&&(r="".concat(O).concat(A))),L={endpoint:r,driveId:x,itemId:S.id},k=l.e.serialize(L),M=I&&I.id?l.e.serialize({endpoint:r,driveId:x,itemId:I.id}):void 0,D.merge(t(Object(u.e)({itemKey:k,driveItem:S,endpoint:r,parentFolderItemKey:M})).itemResolver),P=t(Object(h.e)({processDriveItemFromSharePoint:b.M})).processDriveItemFromSharePoint,T=r.indexOf("/_api/v2.0")>-1||r.indexOf("/_api/v2.1")>-1,U=o||y,P&&(T||U)&&(F=t(P.process({itemKey:k,driveItem:S})).itemResolver,D.merge(F)),D.resolveItems({items:(H={},H[k]=Object(s.__assign)(Object(s.__assign)({},_.n.pack(l.e)),f.t.pack({itemKey:p.e.serialize({driveItemKey:L,sortBy:"",isAscending:!0})})),H)}),D.mapKeys({mappings:(R={},R[k]=a,R)}),t(D.execute()),[2]}})})}}),S=Object(a.t)(function(){return function(e){e(Object(i.a)(o.e,r.e)(y))}})},5228:function(e,t,n){"use strict";n.r(t),n.d(t,"graphAddon",function(){return Ns});var a=n(0),i=n(7),r=n(1692),o=n(1786),s=n(287),c=n(1731),d=n(222),l=n(395),u=n(674),f=n(167),p=n(260),m=n(6),_=n(23),h=n(19),b=new _.e("driveItemPage",{endpoint:h.e,setItemKey:h.e,token:h.e}),g=n(286),v=n(313),y=n(321),S=n(58),D=n(251),I=n(41),x=n(179),C=n(3124),O=n(79),w=n(4),E=n(1059),A=n(1444),L=n(230),k=n(2),M=new k.e("sharedBy"),P=n(3522);function T(e){var t=e.itemKey,n=e.driveItemKey,i=e.parentFolderItemKey,r=e.setItemKey,o=e.driveItemResponse,s=e.endpoint,c=e.getDriveItemFacets,d=void 0===c?C.e:c,l=e.shouldInvalidateItemSetOnChildItemRename,u=void 0===l?void 0:l;return function(e){var c,l,f,_,h,b,v,y=new g.e({publisher:T}),S=E.e.serialize({driveItemKey:n}),D=void 0;if(r){var I=Object(p.e)().forFacet(w.d).thenInvalidate(r,m.e).forFacet(w.k).thenInvalidate(r,m.e);u&&!u(s)||(I=I.forFacet(w.u).thenInvalidate(r,m.e)),D=I.pack()}y.merge(e(d({itemKey:t,driveItemKey:n,driveItem:o,endpoint:s,parentFolderItemKey:i,setItemKey:r})).itemResolver),y.resolveItems({items:(c={},c[t]=Object(a.__assign)(Object(a.__assign)({},w.e.pack({itemKey:S})),D),c)});var x=null!==(l=o.lastModifiedBy)&&void 0!==l?l:null===(f=o.remoteItem)||void 0===f?void 0:f.lastModifiedBy;if(x&&(null==(F=x.user)?void 0:F.email)){var C=P.e.serialize({email:F.email,endpoint:s}),O=U({itemKey:t,personFacet:w.E,userKey:C,user:F}).itemResolver;y.merge(O)}var L=null!==(_=o.createdBy)&&void 0!==_?_:null===(h=o.remoteItem)||void 0===h?void 0:h.createdBy;if(L&&(null==(F=L.user)?void 0:F.email)){var k=P.e.serialize({email:F.email,endpoint:s});O=U({itemKey:t,personFacet:A.a,userKey:k,user:F}).itemResolver,y.merge(O)}if(null===(b=o.remoteItem)||void 0===b?void 0:b.shared){var F,H=null!==(v=o.remoteItem.shared.sharedBy)&&void 0!==v?v:o.remoteItem.shared.owner;if(null==(F=null==H?void 0:H.user)?void 0:F.email){var R=P.e.serialize({email:F.email,endpoint:s});O=U({itemKey:t,personFacet:M,userKey:R,user:F}).itemResolver,y.merge(O)}}return{itemResolver:y}}}function U(e){var t,n,i=e.itemKey,r=e.personFacet,o=e.userKey,s=e.user,c=new g.e({publisher:U});return c.resolveItems({items:Object(a.__assign)((t={},t[o]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(s.displayName)),L.e.pack(s.email)),L.i.pack(s.id)),t),r&&(n={},n[i]=Object(a.__assign)({},r.pack({itemKey:o,displayValue:s.displayName})),n))}),{itemResolver:c}}var F=n(2747),H=new _.e("driveItem",{endpoint:h.e,driveId:h.t,canonicalUrl:h.e});function R(e){var t=e.driveItemResponse,n=e.endpoint,i=e.getDriveItemFacets,r=void 0===i?C.e:i;return function(i){var o,s,c,d=t.remoteItem,l=d&&d.parentReference,u=t.parentReference,f=u||l,p=f&&f.driveId,m=f&&f.id,_="personal"===(f&&f.driveType),h=!!t.root;d?(c=d.id,l&&(p=l.driveId)):c=_&&t.root?F.a:t.id;var b={endpoint:n,driveId:p,itemId:c},g=O.e.serialize(b),v=t&&(t.webDavUrl||t.webUrl),y=_&&f&&f.path===F.e?F.a:m||void 0,S=f&&y?O.e.serialize({endpoint:n,driveId:f.driveId||p,itemId:y}):void 0,D=[],I="";if(!_&&v){var C=new x.e(v);D.push.apply(D,C.path.split("/").slice(1,-1).map(function(e){return decodeURIComponent(e)})),D.unshift(C.authority),I=D.join("/")}f&&!h&&!y&&I&&(S=H.serialize({endpoint:n,driveId:f.driveId,canonicalUrl:I}));var E=i(T(Object(a.__assign)(Object(a.__assign)({},e),{itemKey:g,driveItemKey:b,parentFolderItemKey:S}))).itemResolver;if(E.resolveItems({items:Object(a.__assign)({},S&&(o={},o[S]=Object(a.__assign)({},I?w.A.pack(I):{}),o))}),d&&l){var A=O.e.serialize({endpoint:n,driveId:u&&u.driveId,itemId:t.id}),L=O.e.serialize({endpoint:n,driveId:l.driveId,itemId:d.id});E.mapKeys({mappings:(s={},s[A]=L,s)}),E.merge(i(r({itemKey:L,driveItem:t,endpoint:n})).itemResolver)}return{itemResolver:E,actualDriveItemKey:b,actualItemKey:g}}}var N=n(150),B=n(50),j=n(1730),V=n(128),z=n(1028),G=n(3147),K=n(2926),W=n(3146),q=n(239),Q=n(768),Y=n(1434),J=n(365),X=n(170),Z=n(1052),$=n(1478),ee=n(1051),te=n(1440),ne=n(3536),ae=n(1046),ie=n(3445),re=n(3292),oe=n(2686),se=n(3921),ce=n(3537),de=n(777),le=n(3661),ue=n(3662),fe=n(423),pe=n(3660);function me(e){var t=e.itemKey,n=e.driveItemKey,i=e.driveItem,r=e.endpoint,o=e.parentFolderItemKey,s=e.shouldReturnShareFacets,c=void 0===s||s,l=e.setItemKey,u=i.coverImage,f=i.file,_=i.fileSystemInfo,h=i.name,b=i.parentReference,v=i.lenses,y=i.remoteItem,S=i.root,D=i.size,I=i.thumbnails,x=i.image,C=i.video,E=i.eTag,A=i.photo,L=i.restricted,k=i.tags,M=i.specialFolder,P=i.photoStreamItemSource;return function(e){var s,T,U,F,H,R,N,j,_e,he,be=i.lastModifiedDateTime,ge=void 0===be?_&&_.lastModifiedDateTime:be,ve=i.createdDateTime||_&&_.createdDateTime,ye=(new Date).getTime(),Se=ve?new Date(ve).getTime():void 0,De=Se?ye-Se<1728e5:void 0,Ie=b&&b.driveId,xe=b&&b.driveType,Ce="personal"===xe,Oe=_&&_.lastAccessedDateTime,we=(null==A?void 0:A.takenDateTime)||(null==A?void 0:A.alternateTakenDateTime),Ee=i.package||(null==y?void 0:y.package),Ae=I,Le=!(null==Ae?void 0:Ae.length)||void 0===Ae[0].isPreAuth,ke=x,Me=C,Pe=i.shared||(null==y?void 0:y.shared),Te={itemId:i.id,driveId:Ie,endpoint:r},Ue=_&&_.systemPath,Fe=void 0;y&&(Fe={itemId:y.id,driveId:y.parentReference&&y.parentReference.driveId||"",endpoint:r},he=O.e.serialize({itemId:y.id,driveId:null!==(R=null===(H=y.parentReference)||void 0===H?void 0:H.driveId)&&void 0!==R?R:Ie,endpoint:r}));var He,Re=n||Te,Ne=O.e.serialize(Re),Be=i.webDavUrl,je=Be&&decodeURIComponent(Be);He="business"!==xe&&"documentLibrary"!==xe&&"personal"!==xe||!S?h||"":J.n;var Ve,ze=i.bundle||(null==y?void 0:y.bundle),Ge=i.folder||(null==y?void 0:y.folder)||ze;if(Ge){var Ke=d.e.matches(l);Ve=y?Ke?2:12:Pe?5:2}var We=(null===(N=null==Ge?void 0:Ge.folderView)||void 0===N?void 0:N.sortBy)||"",qe="descending"===(null===(j=null==Ge?void 0:Ge.folderView)||void 0===j?void 0:j.sortOrder),Qe=We&&{columnKey:Object(fe.l)(We),isAscending:!qe},Ye=null!=D?D:null==y?void 0:y.size,Je=null==Ge?void 0:Ge.childCount,Xe=function(e,t){var n=e.lastIndexOf(".");return t||n<0?{name:e,extension:""}:{name:e.substring(0,n),extension:e.substring(n)}}(He,!!Ge),Ze=Xe.extension||(null==Ee?void 0:Ee.type),$e=Ze&&Object(ne.e)(Ze),et=i.sharepointIds,tt=i.localItem,nt=i.webUrl,at=new g.e({publisher:me});return at.resolveItems({items:(s={},s[t]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},O.e.pack(Re)),w.u.pack(He)),ee.n.pack(Ue)),w.c.pack(ge?new Date(ge).getTime():void 0)),w.s.pack(Se)),X.c.pack(we?new Date(we).getTime():void 0)),w.S.pack(De)),V.i.pack(Ee&&"oneNote"===Ee.type?{}:void 0)),Object(p.e)().forFacet(X.h).thenInvalidate(Ne,G.e).pack()),K.e.pack(i)),m.t.pack({itemKey:z.e.serialize({driveItemKey:Re,sortBy:We,isAscending:!qe})})),w.n.pack({itemKey:Q.e.serialize({driveItemKey:Re})})),w.k.pack(o?{itemKey:o}:void 0)),Z.e.pack(xe)),w.p.pack(Xe)),oe.e.pack(ze)),se.e.pack(u)),ee.t.pack(f&&f.mimeType)),W.e.pack(Fe)),te.t.pack(v&&v.length>0?v:void 0)),le.e.pack(k)),ue.e.pack(!!P)),w._.pack(Ge?{}:void 0)),Oe?Object(a.__assign)({},w.o.pack(new Date(Oe).getTime())):{}),Ae?Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},G.e.pack(Ae)),re.e.pack(Le)),ce.e.pack(Object(de.i)(Xe.extension))):{}),E?w.f.pack(E):{}),ke&&ke.width&&ke.height?X.d.pack({width:ke.width,height:ke.height}):{}),ke&&!Me?X.m.pack({}):{}),Me?X.g.pack({}):{}),Ce?Object(a.__assign)({},$.e.pack(i.vault)):{}),c?Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.D.pack(!!Pe)),Y.e.pack(Pe)),Ve?V.e.pack(Ve):{}):{}),s)}),(null===(_e=i.vault)||void 0===_e?void 0:_e.root)&&at.mapKeys({mappings:(T={},T[O.e.serialize({endpoint:r,driveId:Ie,itemId:"vault"})]=t,T)}),at.resolveItems({items:(U={},U[t]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},void 0!==Ye?w.m.pack(Ye):{}),nt?w.A.pack(nt):{}),Qe?m.s.pack(Qe):{}),je||ze?w.i.pack(je):{}),tt?ee.e.pack(tt):{}),"number"==typeof Je?B.e.pack(Je):{}),$e?te.e.pack($e):{}),L?pe.e.pack(L):{}),et?ae.e.pack(et):{}),M?ie.e.pack(M.name):{}),U)}),at.resolveItems({items:(F={},F[t]=Object(a.__assign)({},q.e.pack(he?{itemKey:he}:void 0)),F)}),{itemResolver:at}}}function _e(e){var t=e.driveItemResponse,n=e.endpoint;return function(i){var r=t.parentReference,o=r&&r.driveId,s=r&&r.id,c=t.id;t.root&&(c=F.a);var d={endpoint:n,driveId:o,itemId:c},l=O.e.serialize(d),u=r&&r.path===F.e?F.a:s||void 0,f=r&&u?O.e.serialize({endpoint:n,driveId:r.driveId,itemId:u}):void 0;return{itemResolver:i(T(Object(a.__assign)(Object(a.__assign)({},e),{itemKey:l,driveItemKey:d,getDriveItemFacets:me,parentFolderItemKey:f}))).itemResolver,actualDriveItemKey:d,actualItemKey:l}}}var he=n(8),be=n(2887),ge=!he.e.isActivated("2517C3C6-AAA1-43DA-BBB6-F27E6C7497D1","06/13/2022","Fallback children response to value of `[]` when `@odata.null` is asserted"),ve=!he.e.isActivated("241308BC-D957-4B3D-97F4-07ACD4C725B5","09/08/2022","Fixes issues with endpoint resolution for migrated content");function ye(e){return function(t){var n,i,r,o,s,c,d,l,u,_=e.itemKey,h=e.parentItemKey,C=e.itemSetKeyFacet,O=e.filterChildItems,w=e.onProcessResponse,E=e.groupChildItems,A=e.response,L=e.skip,k=void 0===L?0:L,M=e.enableRandomAccess,P=void 0!==M&&M,T=e.disableRemoteItem,U=e.totalChildCount,F=e.getDriveItemFacets,H=C.deserialize(_),V=H.driveItemKey.endpoint,z=new g.e({publisher:ye}),G=t(Object(D.e)({name:"remoteItemsMissingParentRef"}));ge&&!A.value&&A["@odata.null"]&&(A.value=[]);var K,W="number"==typeof A["@odata.count"]?A["@odata.count"]:U||A.value.length,q=A["@odata.nextLink"],Q=!!q,Y=t(Object(N.e)(function(e){return{childItemsFacetResolved:e.isItemFacetResolved(m.e,_),prevChildKeys:e.demandItemFacet(m.e,_)}})),J=Y.childItemsFacetResolved,X=Y.prevChildKeys,Z=X&&X.itemKeys,$=0,ee=0,te=0;P&&(J&&Z?K=Z.slice(0):"number"==typeof W&&(K=new Array(W+(Q&&W<=A.value.length?1:0)))),K||(K=new Array(A.value.length+(Q?1:0)));for(var ne=k,ae=0,ie=0,re=A.value;ie<re.length;ie++){var oe=re[ie],se=O&&O(oe),ce=oe.remoteItem,de=!(oe.remoteItem&&oe.remoteItem.parentReference&&oe.remoteItem.parentReference.driveId),le=ce&&de;if(le&&ae++,se||le)K.splice(ne,1),W--;else{var ue=t(Object(f.e)({graphEndpoint:S.y,graphRecentEndpoint:S.I,processDriveItemSet:S.P,allowDisableRemoteItemInPlace:S.i,convergenceConfiguration:be.e,getIsExternalItem:S.g})),fe=ue.graphEndpoint,pe=ue.graphRecentEndpoint,me=ue.processDriveItemSet,he=ue.allowDisableRemoteItemInPlace,Se=ue.convergenceConfiguration,De=ue.getIsExternalItem,Ie=he&&T,xe=Ie?_e:R,Ce=V.indexOf("/_api/v2.0")>-1||V.indexOf("/_api/v2.1")>-1,Oe=fe||pe;if(Ce){var we=null===(s=oe.parentReference)||void 0===s?void 0:s.driveId,Ee=ve&&we&&(null==Se?void 0:Se.isMigratedContent(we))?(null===(d=null===(c=oe.parentReference)||void 0===c?void 0:c.sharepointIds)||void 0===d?void 0:d.siteUrl)||(null===(l=oe.sharepointIds)||void 0===l?void 0:l.siteUrl):oe.webDavUrl||!Ie&&oe.remoteItem&&oe.remoteItem.webDavUrl||oe.webUrl;if(Ee){var Ae=new x.e(decodeURIComponent(Ee)).authority;V=ve||Oe?"".concat(Ae,"/_api/v2.0"):"".concat(Ae).concat(new x.e(V).path)}}var Le=t(xe({shouldInvalidateItemSetOnChildItemRename:me&&me.shouldInvalidateItemSetOnChildItemRename,setItemKey:_,driveItemResponse:oe,endpoint:V,getDriveItemFacets:F})),ke=Le.itemResolver,Me=Le.actualItemKey,Pe=Le.actualDriveItemKey,Te=oe.thumbnails,Ue=oe.remoteItem;if($++,(Te||!Ie&&Ue&&Ue.thumbnails)&&ee++,De&&(null===(u=null==Ue?void 0:Ue.sharepointIds)||void 0===u?void 0:u.tenantId)&&De({tenantId:Ue.sharepointIds.tenantId})&&te++,K[ne]=Me,z.merge(ke),w){var Fe=w({itemKey:_,driveItemKey:Pe,item:oe});Fe&&z.merge(Fe.itemResolver)}var He=t(Object(f.e)({processDriveItemFromSharePoint:S.M})).processDriveItemFromSharePoint;if(He&&(Ce||Oe)){var Re=t(He.process({itemKey:Me,driveItem:oe})).itemResolver;z.merge(Re)}ne++}}if(t(G(Object(a.__assign)({resultType:ae<1?I.t.Success:I.t.Failure},ae>0?{extraData:{count:ae}}:{}))),Q){var Ne=b.serialize({setItemKey:_,endpoint:V,token:q});z.merge(Object(v.t)({itemKey:Ne}).itemResolver),K[ne]=Ne}if(E){var Be=E(H);Be&&z.merge(Be.itemResolver)}else z.resolveItems({items:(n={},n[_]=Object(a.__assign)({},m.e.pack({itemKeys:K})),n)});return z.resolveItems({items:(i={},i[_]=Object(a.__assign)({},j.e.pack({childCount:$,childCount_withThumbnail:ee,childCount_external:te})),i)}),W!==U&&z.resolveItems({items:(r={},r[h]=Object(a.__assign)({},B.e.pack(W)),r)}),z.resolveItems({items:(o={},o[_]=Object(a.__assign)(Object(a.__assign)({},m.r.pack({itemKey:h})),Object(p.e)().forFacet(m.e).thenInvalidate(y.e).pack()),o)}),{itemResolver:z}}}var Se=n(1302),De=n(174);function Ie(e){var t=e.itemKey,n=e.itemSetKeyFacet,i=e.parentItemKeyFacet,r=e.childItemsResponse,o=e.disableRemoteItem,s=e.parentItemResponse,c=e.mapItemSetKey,d=n.deserialize(t),l=i.serialize(d.driveItemKey),u=d.driveItemKey.endpoint;return function(n){var i,d;De.t(Se.e.processData.start);var _=n(ye(Object(a.__assign)(Object(a.__assign)({},e),{response:r,disableRemoteItem:o,parentItemKey:l}))).itemResolver;if(c){var h=c().itemResolver;_.merge(h)}var b=n(Object(f.e)({allowDisableRemoteItemInPlace:S.i})).allowDisableRemoteItemInPlace;if(s){var g=n((b&&o?_e:R)({setItemKey:t,driveItemResponse:s,endpoint:u})),v=g.itemResolver,y=g.actualItemKey;_.mapKeys({mappings:(i={},i[y]=l,i)}),_.merge(v)}return _.resolveItems({items:(d={},d[l]=Object(a.__assign)({},Object(p.e)().forFacet(m.t).thenInvalidate(e.itemKey,m.e).pack()),d)}),De.t(Se.e.processData.end),{itemResolver:_}}}var xe=n(391),Ce=he.t.isActivated("cade488d-480a-444f-a1ea-d3d121529bb7","11/01/2021","Set one minute timeout for API requests");function Oe(e){var t=this,n=e.itemKey,i=e.itemSetKeyFacet,r=e.getUrl,o=e.sortChildItems,s=e.qosName,c=e.preprocessResponse,d=e.expectedErrors,f=e.disableRemoteItem,p=void 0!==f&&f,m=e.scenarioInfo,_=i.deserialize(n),h=_.driveItemKey,b=h.endpoint,g=h.driveId;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,f,h,v,y;return Object(a.__generator)(this,function(S){switch(S.label){case 0:t=Object(l.n)(_.driveItemKey),S.label=1;case 1:return S.trys.push([1,4,,5]),[4,n(Object(u.n)({url:r(_),driveUrl:t,driveId:g,qosName:"getChildren".concat(s?".".concat(s):""),endpoint:b,headers:e.additionalHeaders,expectedErrors:d,timeout:Ce?void 0:6e4,scenarioInfo:m}))];case 2:return i=S.sent(),f=Object(a.__spreadArray)([],i.value,!0),h=c&&c(f)||i.value,v=o&&o(h)||h,[4,n(Ie(Object(a.__assign)(Object(a.__assign)({},e),{disableRemoteItem:p,childItemsResponse:Object(a.__assign)(Object(a.__assign)({},i),{value:v})})))];case 3:return[2,{itemResolver:S.sent().itemResolver}];case 4:throw y=S.sent(),new xe.e(Object(a.__assign)({code:"UnknownError"},y instanceof Error?{innerError:y}:{message:JSON.stringify(y)}));case 5:return[2]}})})}}var we=n(146),Ee=n(107),Ae=n(559),Le=n(508),ke=n(370);function Me(e,t){var n=new Date(e.valueOf());return n.setDate(n.getDate()-t),n}var Pe=n(2455),Te=new Map([["code",Ee.e.text],["csv",Ee.e.excel],["docx",Ee.e.word],["dotx",Ee.e.word],["one",Ee.e.onenote],["onepkg",Ee.e.onenote],["onetoc",Ee.e.onenote],["pdf",Ee.e.pdf],["photo",Ee.e.media],["potx",Ee.e.powerpoint],["ppsx",Ee.e.powerpoint],["pptx",Ee.e.powerpoint],["rtf",Ee.e.text],["txt",Ee.e.text],["video",Ee.e.media],["xlsx",Ee.e.excel],["xltx",Ee.e.excel],["zip",Ee.e.zip]]);var Ue=n(194);function Fe(e,t,n){var a=e.lastModifiedDateTime,i=t.lastModifiedDateTime,r=a&&i&&new Date(a).getTime()-new Date(i).getTime()||0,o=a&&i&&new Date(i).getTime()-new Date(a).getTime()||0;return n?r:o}function He(e,t,n){var a=e&&e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedDateTime,i=t&&t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedDateTime,r=a&&i&&new Date(a).getTime()-new Date(i).getTime()||0,o=a&&i&&new Date(i).getTime()-new Date(a).getTime()||0;return n?r:o}function Re(e,t,n){var a=e.name,i=t.name,r=a&&i&&a.localeCompare(i)||0,o=a&&i&&i.localeCompare(a)||0;return n?r:o}function Ne(e,t,n){var a,i,r,o,s,c,d=(null===(a=e.remoteItem)||void 0===a?void 0:a.shared)&&(null!==(i=e.remoteItem.shared.sharedBy)&&void 0!==i?i:e.remoteItem.shared.owner),l=null===(r=null==d?void 0:d.user)||void 0===r?void 0:r.displayName,u=(null===(o=t.remoteItem)||void 0===o?void 0:o.shared)&&(null!==(s=t.remoteItem.shared.sharedBy)&&void 0!==s?s:t.remoteItem.shared.owner),f=null===(c=null==u?void 0:u.user)||void 0===c?void 0:c.displayName,p=l&&f&&l.localeCompare(f)||0,m=l&&f&&f.localeCompare(l)||0;return n?p:m}function Be(e,t,n,i){return function(e,r){return Object(a.__spreadArray)([],e,!0).sort(function(e,a){var r,o,s,c,d=e.folder||(null===(r=e.remoteItem)||void 0===r?void 0:r.folder)||(null===(o=e.remoteItem)||void 0===o?void 0:o.bundle),l=a.folder||(null===(s=a.remoteItem)||void 0===s?void 0:s.folder)||(null===(c=a.remoteItem)||void 0===c?void 0:c.bundle);return n&&d&&!l?-1:n&&!d&&l?1:i(e,a,t)})}(e)}var je=n(3920),Ve=new _.e("SharedByPersonKeyFacet",{displayName:h.e,email:h.e,id:h.e}),ze=new _.e("dateSharedGroupKeyFacet",{relativeTime:h.e,sharedDateTime:h.e}),Ge=new _.e("relativeTimeGroupKeyFacet",{relativeTime:h.e}),Ke=n(4633),We=n(570),qe=n(18),Qe=n(60),Ye=n(4631),Je=(Ye.T,Ye.l,Ye.F,Ye.H,Ye.U,Ye.i,Ye.p,Ye.L,Ye.C,Ye.M,Ye.P,Ye.k,Ye.v,Ye.E,Ye.y,Ye.g,Ye.I,Ye._,Ye.x,Ye.D,Ye.S,Ye.h,Ye.A,Ye.w,Ye.O,Ye.b,[Ye.r,Ye.a,Ye.c,Ye.e,Ye.d,Ye.s,Ye.o,Ye.t,Ye.m,Ye.f,Ye.u,Ye.n]),Xe=he.t.isActivated("1E74BB9A-47A2-40F6-89FA-C628928BEC2F","04/12/2022","Enable grouping of items that are missing the email or display name of the person who shared an item");function Ze(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,r,o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return t=e.endpoint,i=n(Object(f.e)({getUserOneDriveEndpoint:S.v,graphEndpoint:S.y})),r=i.getUserOneDriveEndpoint,(o=i.graphEndpoint)&&t!==o&&r?[4,n(r({endpoint:t}))]:[3,2];case 1:s=a.sent(),t=s,a.label=2;case 2:return[2,t]}})})}}var $e=n(2823),et=Object(i.i)()(function e(t){var n=this,i=d.e.deserialize(t.itemKey),r=i.filters,o=i.sortBy,s=i.isAscending;return function(i){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,c,l,p,_,h,b,v,y,D,I,x,C,E;return Object(a.__generator)(this,function(A){switch(A.label){case 0:return n=function(e){if(d.e.matches(e)){var t=d.e.deserialize(e).groupBy;if(t===fe.a[fe.c])return function(e){var t={},n=function(i){for(var r,o,s=new g.e({publisher:n}),c=function(e){for(var t=[],n=0,a=e;n<a.length;n++){var i=a[n];if(!Ve.matches(i))return e;var r=Ve.deserialize(i);t.push(r)}return t.sort(function(e,t){return e&&t&&e.displayName.localeCompare(t.displayName)}).map(function(e){return Ve.serialize(e)})}(Object.keys(t)),d=[],l=0,u=c;l<u.length;l++){var f=u[l];if(Ve.matches(f)){var p=Ve.deserialize(f);s.resolveItems({items:(r={},r[f]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(p.displayName)),B.r.pack(!0)),m.e.pack({itemKeys:t[f]})),r)}),d.push(f)}}return s.resolveItems({items:(o={},o[e]=Object(a.__assign)(Object(a.__assign)({},m.e.pack({itemKeys:d})),Qe.e.pack(!0)),o)}),{itemResolver:s}};return{onProcessResponse:function(e){var n,i,r,o,s,c=e.driveItemKey,d=e.item;if(d&&c){var l=d.remoteItem,u=l&&l.shared&&(null!==(n=l.shared.sharedBy)&&void 0!==n?n:l.shared.owner),f=(null===(i=null==u?void 0:u.user)||void 0===i?void 0:i.displayName)||(Xe?"":(null===(r=null==u?void 0:u.user)||void 0===r?void 0:r.email)||Ke.s),p=Object(a.__assign)(Object(a.__assign)({},null!==(o=null==u?void 0:u.user)&&void 0!==o?o:{}),{displayName:f}),m=O.e.serialize(c);if(!Xe||p.email||p.id){var _=Ve.serialize({displayName:p.displayName,email:p.email||"",id:p.id||""});s=_,t.hasOwnProperty(s)||(t[_]=[]),t[_].push(m)}}},groupChildItems:n}}(e);if(t===fe.a[fe.e])return function(e){var t={},n=function(i){for(var r,o,s=new g.e({publisher:n}),c=function(e){for(var t={},n=function(e){for(var t=[],n=0,a=e;n<a.length;n++){var i=a[n];if(!ze.matches(i))return e;var r=ze.deserialize(i);t.push(r)}return t.sort(function(e,t){return e&&t&&new Date(t.sharedDateTime).getTime()-new Date(e.sharedDateTime).getTime()}).map(function(e){return ze.serialize(e)})}(Object.keys(e)),a=function(e){return t.hasOwnProperty(e)},i=0,r=n;i<r.length;i++){var o=r[i];if(ze.matches(o)){var s=ze.deserialize(o).relativeTime,c=Ge.serialize({relativeTime:s});if(a(c))for(var d=0,l=e[o];d<l.length;d++){var u=l[d];t[c].push(u)}else{t[c]=[];for(var f=0,p=e[o];f<p.length;f++)u=p[f],t[c].push(u)}}}return t}(t),d=[],l=0,u=Object.keys(c);l<u.length;l++){var f=u[l];if(Ge.matches(f)){var p=Ge.deserialize(f).relativeTime;s.resolveItems({items:(r={},r[f]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(p)),B.r.pack(!0)),m.e.pack({itemKeys:c[f]})),r)}),d.push(f)}}return s.resolveItems({items:(o={},o[e]=Object(a.__assign)(Object(a.__assign)({},m.e.pack({itemKeys:d})),Qe.e.pack(!0)),o)}),{itemResolver:s}};return{onProcessResponse:function(e){var n,a=e.driveItemKey,i=e.item;if(i&&a){var r=i.remoteItem,o=r&&r.shared&&r.shared.sharedDateTime,s=O.e.serialize(a);if(o){var c=function(e,t){if(!e)return Ke.n;var n=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(e>=n)return We.today;if(n.setDate(n.getDate()-1),e>=n)return We.yesterday;if(n.setDate(t.getDate()-t.getDay()),e>=n)return Ke.i;if(n.setDate(n.getDate()-7),e>n)return Ke.t;var a=new Date(t.getFullYear(),t.getMonth(),1);if(e>=new Date(t.getFullYear(),t.getMonth()-1,1)&&e<a)return Ke.e;if(n.setDate(n.getDate()-7),e>n)return Ke.o;if(n.setDate(n.getDate()-7),e>n)return Ke.r;if(e>=a)return Ke.a;var i=t.getFullYear()===e.getFullYear(),r=Je[e.getMonth()];return i?r:qe.format(We.MonthAndYear,r,e.getFullYear())}(new Date(o),new Date),d=ze.serialize({relativeTime:c,sharedDateTime:o});n=d,t.hasOwnProperty(n)||(t[d]=[]),t[d].push(s)}}},groupChildItems:n}}(e)}return{onProcessResponse:void 0,groupChildItems:void 0}}(t.itemKey),c=n.onProcessResponse,l=n.groupChildItems,p=d.e.deserialize(t.itemKey),_=p.driveItemKey.endpoint,h=i(Object(f.e)({graphSharedWithMeEndpoint:S.C,isUnauthenticated:je.e,convergenceConfiguration:be.e})),b=h.graphSharedWithMeEndpoint,v=h.isUnauthenticated,y=void 0!==v&&v,D=h.convergenceConfiguration,!he.e.isActivated("8D6592C3-9CFD-4B17-B0EC-F88A5B9B7EFA","01/17/2023","Do not query SWM if user is unauth")&&y?[2]:(_=b||_,he.e.isActivated("C8633E26-C16D-4D6D-ABE5-BE1A2C3C256A","02/23/2022","Use OneDrive endpoint for Shared with me")?[3,3]:b&&b!==p.driveItemKey.endpoint?(p=Object(a.__assign)(Object(a.__assign)({},p),{driveItemKey:Object(a.__assign)(Object(a.__assign)({},p.driveItemKey),{endpoint:b})}),[3,3]):[3,1]);case 1:return[4,i(Ze({endpoint:_}))];case 2:(I=A.sent())!==p.driveItemKey.endpoint&&(p=Object(a.__assign)(Object(a.__assign)({},p),{driveItemKey:Object(a.__assign)(Object(a.__assign)({},p.driveItemKey),{endpoint:I})})),A.label=3;case 3:return(x=i(Object(u.i)(p.driveItemKey.endpoint)))&&!o&&(o=fe.i,s=!0),C=d.e.serialize(p),[4,i(Oe(Object(a.__assign)(Object(a.__assign)({},t),{qosName:"sharedWithMe",itemKey:C,itemSetKeyFacet:d.e,parentItemKeyFacet:we.e,disableRemoteItem:!1,getUrl:function(e){var t=e.driveItemKey.endpoint;return x?"".concat(t,"/drive/oneDrive.sharedWithMe?select=*,webDavUrl"):!he.e.isActivated("211F049A-DF94-41B3-99C3-E71620C63E23","05/31/2022","Remove me from request Url")&&I?"".concat(t,"/drive/sharedWithMe?expand=formats&allowExternal=true&$top=500"):"".concat(t,"/me/drive/sharedWithMe?expand=formats&allowExternal=true&$top=500")},filterChildItems:function(e){return!function(e,t){return void 0===t&&(t=[]),t.every(function(t){var n,a=!("sharedByName"===t.type)||function(e,t){var n,a,i,r=(null===(n=e.remoteItem)||void 0===n?void 0:n.shared)&&(null!==(a=e.remoteItem.shared.sharedBy)&&void 0!==a?a:e.remoteItem.shared.owner),o=null===(i=null==r?void 0:r.user)||void 0===i?void 0:i.displayName;return!!o&&t.indexOf(o)>-1}(e,t.values),i=!("fileName"===t.type)||function(e,t){return!!e.name&&function(e,t){var n,a,i=(n=e,a=Object(Ae.t)(n,!0),Object(Le.n)(a)),r=Te.get(i);return!!r&&Object(Ee.t)(t.filters,r)}(e.name,t)}(e,Object(ke.t)(t.values)),r=!("dateModified"===t.type)||function(e,t){var n=e.lastModifiedDateTime||"";return(n&&new Date(n))>=t}(e,function(e){var t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate());switch(e){case Pe.e.today:return n;case Pe.e.yesterday:return Me(n,1);case Pe.e.last7Days:return Me(n,7);case Pe.e.last30Days:return Me(n,30);case Pe.e.last3Months:return Me(n,90);default:return new Date(0)}}((n=t.values).length<1||-1===Object.keys(Pe.e).indexOf(n[0])?Pe.e.none:Pe.e[n[0]]));return a&&i&&r})}(e,r)},sortChildItems:function(e){return function(e,t,n,a){void 0===a&&(a=!1);var i=fe.a[fe.e],r=fe.a[fe.c],o=fe.a[Ue.a],s=fe.a[Ue.n],c=fe.a[fe.o],d=fe.a[Ue.s];switch(t){case i:return Be(e,n,a,He);case r:return Be(e,n,a,Ne);case o:case s:case d:return Be(e,n,a,Re);case c:return Be(e,n,a,Fe);default:return e}}(e,o,s,!0)},onProcessResponse:function(e){var t,n,a;if(c&&c(e),!he.e.isActivated("D5DE03D9-65F1-4DBC-ACED-1454D5E5B534","02/06/2023","Call setMigrationState for all migrated drives in SWM")){var i=e.item,r=!!(null===(t=null==i?void 0:i.remoteItem)||void 0===t?void 0:t.sharepointIds),o=null===(a=null===(n=null==i?void 0:i.remoteItem)||void 0===n?void 0:n.parentReference)||void 0===a?void 0:a.driveId;D&&r&&o&&D.setMigrationState(o,!0)}},groupChildItems:l,mapItemSetKey:function(){var n,a=new g.e({publisher:e});return a.mapKeys({mappings:(n={},n[C]=t.itemKey,n)}),{itemResolver:a}},scenarioInfo:{scenario:$e.e.PopulateSharedWithMe,scenarioType:$e.t.ActiveUserOperation}})))];case 4:return E=A.sent().itemResolver,i(E.execute()),[2]}})})}}),tt=n(225),nt=n(438),at=n(1791),it=Object(i.t)(function(){return function(e){e(Object(tt.t)({keyFacet:d.e,facets:[d.e,m.e]})),e(c.e),e(Object(s.a)(d.e,nt.e)(et)),e(at.e)}}),rt=new _.e("sharedByMeRootItem",{endpoint:h.e}),ot=new _.e("sharedByMeItemSet",{driveItemKey:O.e.subKeyPart}),st=n(348),ct=n(592),dt=n(112),lt=n(279),ut=n(1076);function ft(e,t){var n=t.itemsScopeItemKey,i=t.engagement,r=i&&i.name;return{engagement:{objectType:"SharedByMe",datasource:"Graph",extraData:Object(a.__assign)({},"ItemsView.Load"===r?Object(ut.e)(e,{itemsScopeItemKey:n}):{})}}}function pt(e,t){return{engagement:{currentPage:"SharedByMe"}}}var mt=Object(i.t)(function(){return function(e){e(Object(ct.e)(rt,dt.e)(ft)),e(Object(ct.e)(ot,dt.e)(ft)),e(Object(ct.e)(rt,lt.e)(pt))}}),_t=Object(st.e)(rt,function(e){return function(){return{defaultChildItemSet:{itemKey:ot.serialize({driveItemKey:e})},displayName:J.r,icon:void 0}}},mt),ht=!he.e.isActivated("519F99F6-DD95-455D-8604-464641B5540D","06/13/2022","Do NOT request thumbnails from SBY API"),bt=Object(i.i)()(function(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,r,o;return Object(a.__generator)(this,function(s){switch(s.label){case 0:return t=e.itemKey,i=ot.deserialize(t).driveItemKey.endpoint,r=n(Object(u.i)(i)),[4,n(Oe(Object(a.__assign)(Object(a.__assign)({},e),{qosName:"sharedByMe",itemSetKeyFacet:ot,parentItemKeyFacet:rt,disableRemoteItem:!1,getUrl:function(e){var t="".concat(i,"/drive/shared"),n=ht&&r?"":"$expand=thumbnails";return"".concat(t,"?").concat(n,"&").concat("$select=*,fileSystemInfo,folder,reactions,bundle,webDavUrl,package")}})))];case 1:return o=s.sent().itemResolver,n(o.execute()),[2]}})})}}),gt=Object(i.t)(function(){return function(e){e(Object(tt.t)({keyFacet:rt,facets:[rt,w.u,w.m,w._,w.A,w.i,w.c,m.t,w.k,ee.n]})),e(Object(tt.t)({keyFacet:ot,facets:[ot,m.e]})),e(_t),e(Object(s.a)(ot,nt.e)(bt)),e(mt)}}),vt=n(1038),yt=n(339),St=n(1068),Dt=n(231);function It(e,t){var n=t.handlers,i=t.itemKey,r=e.demandItemFacet(yt.e,i);if(n&&r){for(var o=[],s=0,c=n;s<c.length;s++){var d=c[s];if(d.key===Dt.l.key)o.push("photo");else if(d.key===Dt.u.key)o.push("video");else if(d.key===Dt.a.key)o.push("folder");else if(d.key===Dt.n.key)o.push("file");else if(d.key===Dt.d.key)o.push("onenote");else if(d.key===Dt.s.key)o.push("!photo");else if(d.key===Dt.c.key)o.push("!video");else if(d.key===Dt.r.key)o.push("!folder");else if(d.key===Dt.o.key)o.push("!onenote");else{var l=Object(St.e)(d);l&&o.push(l)}}return{itemKey:yt.e.serialize(Object(a.__assign)(Object(a.__assign)({},r),{filters:o}))}}return{}}var xt,Ct=n(1729),Ot=n(162),wt=n(439),Et=n(578),At=new _.e("recentGroup",{recentItemSet:yt.e.subKeyPart,relativeTime:Object(Et.e)({today:"today",yesterday:"yesterday",thisWeek:"thisWeek",lastWeek:"lastWeek",twoWeeksAgo:"twoWeeksAgo",threeWeeksAgo:"threeWeeksAgo",thisMonth:"thisMonth",lastMonth:"thisMonth",twoMonthsAgo:"twoMonthsAgo",older:"older"})}),Lt=864e5;function kt(e,t){return e.toDateString()===t.toDateString()}!function(e){e.today="today",e.yesterday="testerday",e.thisWeek="thisWeek",e.lastWeek="lastWeek",e.twoWeeksAgo="twoWeeksAgo",e.threeWeeksAgo="threeWeeksAgo",e.thisMonth="thisMonth",e.lastMonth="lastMonth",e.twoMonthsAgo="twoMonthsAgo",e.older="older"}(xt||(xt={}));var Mt=n(1307),Pt=n(4096),Tt=n(1110),Ut=!he.t.isActivated("670094E2-09D8-4B36-90FB-B7EF6BA067C9","04/06/2022","Add support for `photo` and `video` filters for the picker");function Ft(e){return e.reduce(function(e,t){return e&&t?"(".concat(e," or ").concat(t,")"):t||e})}function Ht(e){return e.reduce(function(e,t){return e&&t?"(".concat(e," and ").concat(t,")"):t||e})}function Rt(e){return function(t){for(var n=void 0,a=void 0,i=0;i<e.length;i++){var r=e[i],o=!1,s=r;if(Object(Mt.e)(r)&&(s=Object(Mt.t)(r),o=!0),"."===s[0])if(t.name){var c=new RegExp("".concat(s.toLocaleLowerCase(),"$")),d=t.name.toLocaleLowerCase().split(c),l=2===d.length&&""===d[1]||!1;o?n=void 0!==n?n&&!l:l:a=a||l}else n=!1,a=!1;else if("folder"===s){var u=void 0!==t.folder||void 0!==t.remoteItem&&void 0!==t.remoteItem.folder||!1;o?n=void 0!==n?n&&!u:u:a=a||u}else if("onenote"===s){var f=t.package&&"oneNote"===t.package.type||t.remoteItem&&t.remoteItem.package&&"oneNote"===t.remoteItem.package.type||!1;o?n=void 0!==n?n&&!f:f:a=a||f}else if("photo"===s&&Ut){var p=void 0!==t.photo||void 0!==t.image;o?n=void 0!==n?n&&!p:p:a=a||p}else if("video"===s&&Ut){var m=!!t.video;o?n=void 0!==n?n&&!m:m:a=a||m}}return void 0===a?void 0!==n&&n:(void 0===n||n)&&!a}}var Nt=n(4632),Bt=!he.t.isActivated("2477F975-39B5-47B9-AA5F-C02028225BCB","10/27/2021","Updates ODC itemsscope Recent to use prefer APIVersion 2.0 header (instead of 2.1) in the case the user has been migrated."),jt=!he.e.isActivated("667B27A0-823E-489C-B1CF-3AA1F1E5C454","04/09/2022","Enable the Older grouping for list items in Recent pivot"),Vt=!he.e.isActivated("213A4632-291F-4C56-A70F-D16FF269A867","04/07/2022","Enforce maxmimum filter complexity for Graph Recent API"),zt=function(e,t){var n=new RegExp("^"+t+"\\/","i");return e.filter(function(e){var t=e&&e.remoteItem||e;return!(!t||!t.file)&&n.test(t.file.mimeType)})},Gt=Object(i.i)()(function(e){var t=this,n=yt.e.deserialize(e.itemKey),i=n.filters,r=void 0===i?[]:i,o=n.groupBy,s=void 0===o?"":o,c=Object(ke.e)({extFilters:Object(ke.t)(r),allowedMediaTypes:[Ee.e.photo,Ee.e.video],fileTypeIconMap:wt.e}),d=Object(ke.e)({extFilters:Object(ke.t)(r),allowedMediaTypes:[Ee.e.photo],fileTypeIconMap:wt.e}),p=Object(ke.e)({extFilters:Object(ke.t)(r),allowedMediaTypes:[Ee.e.video],fileTypeIconMap:wt.e});return function(i){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,o,_,h,b,v,y,D,I,x,C,E,A,L,k,M,P,T,U,F,H,R,N,j,V,z,G,K,W,q,Q,Y,J,X,Z,$,ee,te,ne;return Object(a.__generator)(this,function(ae){switch(ae.label){case 0:return t=i(Object(f.e)({graphRecentEndpoint:S.I,enableOverflowRecentGroup:S.u,convergenceConfiguration:be.e,enableRecentVroom21Takeover:S.p})),o=t.graphRecentEndpoint,_=t.enableOverflowRecentGroup,h=void 0===_?jt:_,b=t.convergenceConfiguration,v=t.enableRecentVroom21Takeover,y=n,o?(y=Object(a.__assign)(Object(a.__assign)({},y),{driveItemKey:Object(a.__assign)(Object(a.__assign)({},y.driveItemKey),{endpoint:o})}),[3,3]):[3,1];case 1:return[4,i(Ze({endpoint:y.driveItemKey.endpoint}))];case 2:(D=ae.sent())!==y.driveItemKey.endpoint&&(y=Object(a.__assign)(Object(a.__assign)({},y),{driveItemKey:Object(a.__assign)(Object(a.__assign)({},y.driveItemKey),{endpoint:D})})),ae.label=3;case 3:return I=yt.e.serialize(y),x=At.serialize({recentItemSet:y,relativeTime:"today"}),C=At.serialize({recentItemSet:y,relativeTime:"yesterday"}),E=At.serialize({recentItemSet:y,relativeTime:"thisWeek"}),A=At.serialize({recentItemSet:y,relativeTime:"lastWeek"}),L=At.serialize({recentItemSet:y,relativeTime:"twoWeeksAgo"}),k=At.serialize({recentItemSet:y,relativeTime:"threeWeeksAgo"}),M=At.serialize({recentItemSet:y,relativeTime:"lastMonth"}),P=At.serialize({recentItemSet:y,relativeTime:"twoMonthsAgo"}),T=At.serialize({recentItemSet:y,relativeTime:"older"}),U=[],F=[],H=[],R=[],N=[],j=[],V=[],z=[],G=[],K="",W="date"===s,q=function(e){var t,n=e.driveItemKey,i=e.item,r=new g.e({publisher:q});if(i&&n){var o=i.remoteItem,s=o&&o.fileSystemInfo,c=s&&s.lastAccessedDateTime,d=O.e.serialize(n);if(W&&c){var l=new Date(c);switch(function(e){var t=new Date;return function(e,t){return kt(t,e)}(e,t)?xt.today:function(e,t){return kt(new Date(t.getTime()-Lt),e)}(e,t)?xt.yesterday:function(e,t){var n=t.setHours(0,0,0,0)-t.getDay()*Lt;return e.getTime()>n}(e,t)?xt.thisWeek:function(e,t){var n=t.setHours(0,0,0,0)-(t.getDay()+7)*Lt;return e.getTime()>n}(e,t)?xt.lastWeek:function(e,t){var n=t.setHours(0,0,0,0)-12096e5;return e.getTime()>n}(e,t)?xt.twoWeeksAgo:function(e,t){var n=t.setHours(0,0,0,0)-18144e5;return e.getTime()>n}(e,t)?xt.threeWeeksAgo:function(e,t){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()}(e,t)?xt.thisMonth:function(e,t){return t.getMonth()-e.getMonth()==11||t.getFullYear()===e.getFullYear()&&t.getMonth()-e.getMonth()==1}(e,t)?xt.lastMonth:function(e,t){var n=t.getFullYear(),a=e.getFullYear(),i=t.getMonth(),r=e.getMonth();return n===a&&i-r==2||n-a==1&&i-r==-10}(e,t)?xt.twoMonthsAgo:xt.older}(l)){case xt.today:U.push(d);break;case xt.yesterday:F.push(d);break;case xt.thisWeek:H.push(d);break;case xt.lastWeek:R.push(d);break;case xt.twoWeeksAgo:N.push(d);break;case xt.threeWeeksAgo:j.push(d);break;case xt.lastMonth:V.push(d);break;case xt.twoMonthsAgo:z.push(d),K=Je[l.getMonth()];break;case xt.older:default:G.push(d)}}return r.resolveItems({items:(t={},t[d]=Object(a.__assign)({},w._.pack(void 0)),t)}),{itemResolver:r}}},Q=!c&&W?function(t){var n,i,r=new g.e({publisher:Q});r.resolveItems({items:(n={},n[x]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(Nt.r)),B.r.pack(!0)),m.e.pack({itemKeys:U})),n[C]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(Nt.s)),B.r.pack(!0)),m.e.pack({itemKeys:F})),n[E]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(Nt.a)),B.r.pack(!0)),m.e.pack({itemKeys:H})),n[A]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(Nt.t)),B.r.pack(!0)),m.e.pack({itemKeys:R})),n[L]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(Nt.o)),B.r.pack(!0)),m.e.pack({itemKeys:N})),n[k]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(Nt.i)),B.r.pack(!0)),m.e.pack({itemKeys:j})),n[M]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(Nt.e)),B.r.pack(!0)),m.e.pack({itemKeys:V})),n[P]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(K)),B.r.pack(!0)),m.e.pack({itemKeys:z})),n[T]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(Nt.n)),B.r.pack(!0)),m.e.pack({itemKeys:G})),n)});var o=[];return U.length>0&&o.push(x),F.length>0&&o.push(C),H.length>0&&o.push(E),R.length>0&&o.push(A),N.length>0&&o.push(L),j.length>0&&o.push(k),V.length>0&&o.push(M),z.length>0&&o.push(P),G.length>0&&h&&o.push(T),r.resolveItems({items:(i={},i[e.itemKey]=Object(a.__assign)({},m.e.pack({itemKeys:o})),i)}),{itemResolver:r}}:void 0,Y=i(Object(u.i)(y.driveItemKey.endpoint)),J=[{code:"notAllowed",message:"You do not have permission to create this personal site or you do not have a valid license"},{code:"notAllowed",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"notAllowed",message:"Operation not allowed"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}],X=Bt&&(null==b?void 0:b.isUserMigrated)?"ApiVersion=2.0":"ApiVersion=2.1",Z=he.e.isActivated("ec806106-9a41-4826-810d-712db11fef90","22/7/2022","Use RecentExcludeMediaApp in Prefer Header"),$=Z?"RecentOnlyMediaApp":"RecentExcludeMediaApp",[4,i(Oe(Object(a.__assign)(Object(a.__assign)({},e),{qosName:c?"recentMedia":Y?"ODC-recent":"recent",itemKey:I,itemSetKeyFacet:yt.e,parentItemKeyFacet:Ot.e,getUrl:function(e){var t="".concat(Object(l.n)({endpoint:e.driveItemKey.endpoint,driveId:"me"}),"/recent?"),n=he.e.isActivated("022299AD-ACC7-4C1F-B2E8-010FBC126277","1/7/2022","Narrow filters for media queries");if(Y)t="".concat(e.driveItemKey.endpoint,"/drive/view.recent?");else{if(d&&!n){var i="$filter=(remoteItem/image ne null)",o="$expand=thumbnails";return"".concat(t).concat(i,"&").concat(o)}if(p&&!n)return i="$filter=(remoteItem/image eq null or remoteItem/video ne null)",o="$expand=thumbnails","".concat(t).concat(i,"&").concat(o);if(c)return i="$filter=(remoteItem/image ne null or remoteItem/video ne null)",o="$expand=thumbnails","".concat(t).concat(i,"&").concat(o)}return"".concat(t).concat(function(e){if(!e||0===e.length||Vt&&e.length>8)return"";for(var t=[],n=[],i=0;i<e.length;i++){var r=e[i],o=!1,s=r;Object(Mt.e)(r)&&(s=Object(Mt.t)(r),o=!0),"folder"===s?!o&&t.push("folder ne null"):"onenote"===s?o?n.push("(remoteItem/package/type ne 'oneNote' and package/type ne 'oneNote')"):t.push("(remoteItem/package/type eq 'oneNote' or package/type eq 'oneNote')"):"."!==s[0]||!o&&t.push("(endsWith(name, '".concat(s.toLowerCase(),"') or endsWith(remoteItem/name, '").concat(s.toLowerCase(),"'))"))}return t.length>0||n.length>0?"&$filter=".concat(0===n.length?Ft(t):0===t.length?Ht(n):Ht(Object(a.__spreadArray)([Ft(t)],n,!0))):""}(r))},getDriveItemFacets:Kt,expectedErrors:J,preprocessResponse:function(e){return X.indexOf("2.1")<0&&!v&&(d?e=zt(e,"image"):p&&(e=zt(e,"video|^application"))),(t=e.sort(function(e,t){var n=e.remoteItem&&e.remoteItem.fileSystemInfo&&e.remoteItem.fileSystemInfo.lastAccessedDateTime,a=t.remoteItem&&t.remoteItem.fileSystemInfo&&t.remoteItem.fileSystemInfo.lastAccessedDateTime;return n||a?n?a?n>a?-1:1:-1:1:0}))?t.filter(function(e,t,n){return n.map(function(e){return e.id}).indexOf(e.id)===t}):t;var t},additionalHeaders:c?{Prefer:"".concat(X,",").concat($,",NoPreAuthThumbnailUrls")}:{Prefer:"".concat(X,";ODC,returnparentresource,returnowner")},onProcessResponse:q,groupChildItems:Q,scenarioInfo:{scenario:$e.e.PopulateRecentFiles,scenarioType:$e.t.ActiveUserOperation}})))];case 4:return ee=ae.sent().itemResolver,c&&ee.resolveItems({items:(te={},te[e.itemKey]=Object(a.__assign)({},B.s.pack({})),te)}),ee.mapKeys({mappings:(ne={},ne[I]=e.itemKey,ne)}),i(ee.execute()),[2]}})})}});function Kt(e){return function(t){var n,i=new g.e({publisher:Kt});i.merge(t(Object(C.e)(e)).itemResolver);var r=e.driveItem,o=r.thumbnails,s=r.remoteItem,c=o||s&&s.thumbnails;return i.resolveItems({items:(n={},n[e.itemKey]=Object(a.__assign)({},c?Object(a.__assign)({},re.e.pack(!1)):{}),n)}),{itemResolver:i}}}var Wt=n(1790),qt=Object(i.t)(function(){return function(e){e(Object(tt.t)({keyFacet:yt.e,facets:[yt.e,m.e]})),e(Ct.e),e(Object(s.a)(yt.e,nt.e)(Gt)),e(Object(ct.e)(yt.e,vt.e)(It)),e(Wt.e)}}),Qt=n(115),Yt=he.t.isActivated("5F12686F-52A2-4E49-A1D8-A2AE7969622E","10/29/2021","Use multiPart getItem api(ODC vroom) to avoid CORS if KS is not activated.");function Jt(){return function(e){return!e(Object(f.e)({isWinApp:S.E})).isWinApp&&!Yt}}var Xt=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=O.e.deserialize(n);return function(r){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,o,s,c,d,p,m,_,h,b,g,v,y,D,I;return Object(a.__generator)(this,function(x){switch(x.label){case 0:return t=i,r(Object(N.e)(function(e){return e.demandItemFacet(w.d,n)}))?[2]:i.driveId&&"me"!==i.driveId?[3,2]:[4,r(Ze({endpoint:i.endpoint}))];case 1:(o=x.sent())!==i.endpoint&&(t=Object(a.__assign)(Object(a.__assign)({},i),{endpoint:o})),x.label=2;case 2:return s=Object(l.n)(t),c=i.driveId,d=r(Object(f.e)({disableRemoteItemInPlace:S.i})).disableRemoteItemInPlace,p=d?_e:R,[4,r(Object(u.i)(t.endpoint))];case 3:return m=x.sent(),_=r(Jt())&&m,[4,r(Object(u.n)({url:"".concat(Object(l.t)(t),"?$expand=thumbnails"),driveUrl:s,driveId:c,qosName:"getItem",useMultiPartIfSupported:_,endpoint:t.endpoint}))];case 4:return h=x.sent(),b=r(p({driveItemResponse:h,endpoint:t.endpoint})),g=b.itemResolver,v=b.actualItemKey,g.resolveItems({items:(y={},y[e.itemKey]=Object(a.__assign)({},Qt.i.pack(O.e)),y)}),g.mapKeys({mappings:(D={},D[v]=n,D)}),i.driveId&&"me"!==i.driveId||g.mapKeys({mappings:(I={},I[O.e.serialize(Object(a.__assign)(Object(a.__assign)({},i),{driveId:"me"}))]=O.e.serialize(Object(a.__assign)(Object(a.__assign)({},i),{driveId:""})),I[n]=O.e.serialize(t),I)}),r(g.execute()),[2]}})})}}),Zt=Object(i.i)()(function e(t){var n=this,i=t.itemKey,r=b.deserialize(i),o=r.setItemKey,s=r.endpoint,c=r.token,d=_.e.get(o).deserialize(o),h=d.extFilters,y=d.driveItemKey,D=Object(l.n)(y),I=z.e.matches(o);return function(t){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,r,d,l,_,x,E,A,L,k,M,P,T,U,H,R,N,B,j,V,z,G,K;return Object(a.__generator)(this,function(W){switch(W.label){case 0:return[4,t(Object(u.i)(s))];case 1:return n=W.sent(),r=t(Jt())&&n,[4,t(Object(u.t)({endpoint:s,url:c,driveUrl:D,driveId:y.driveId,useMultiPartIfSupported:r,qosName:"getChildrenPage"}))];case 2:for(d=W.sent(),l=h&&h.length>0?Rt(h):void 0,_=new g.e({publisher:e}),x=[],E=0,A=d.value;E<A.length;E++)L=A[E],l&&l(L)||(k=L&&(L.parentReference||L.remoteItem&&L.remoteItem.parentReference),M=k&&k.driveId,P=O.e.serialize({itemId:L.id,driveId:M,endpoint:s}),T=null==k?void 0:k.id,U=(null==k?void 0:k.path)===F.e?F.a:T||void 0,H=k?O.e.serialize({itemId:U,driveId:M,endpoint:s}):void 0,R=t(Object(f.e)({allowDisableRemoteItemInPlace:S.i,processDriveItemFromSharePoint:S.M})),N=R.allowDisableRemoteItemInPlace,B=R.processDriveItemFromSharePoint,j=I&&N?me:C.e,x.push(P),_.merge(t(j({itemKey:P,driveItem:L,endpoint:s,parentFolderItemKey:H})).itemResolver),_.resolveItems({items:(K={},K[P]=Object(a.__assign)({},Object(p.e)().forFacet(w.u).thenInvalidate(i,m.e).forFacet(w.d).thenInvalidate(i,m.e).pack()),K)}),B&&(V=t(B.process({itemKey:P,driveItem:L})).itemResolver,_.merge(V)));return(z=d["@odata.nextLink"])&&(G=b.serialize({setItemKey:o,endpoint:s,token:z}),_.merge(Object(v.t)({itemKey:G}).itemResolver),x.push(G)),_.merge(Object(v.e)({itemKey:i,itemSetKey:o,childItemKeys:x}).itemResolver),t(_.execute()),[2]}})})}}),$t=n(672),en=n(169),tn=n(3538),nn=!he.e.isActivated("E0D4E3B7-F0E1-41FE-BDB6-DCFF1C62CA43","04/01/2022","Process parent item error, and add handling for `sharingPasswordRequired` error");function an(e,t){var n=Object(k.t)({},{});return e instanceof $t.e&&(n=Object($t.t)(e,function(n){var i,r;switch(n){case 404:return en.p.pack({});case"sharingPasswordRequired":if(nn)return Object(a.__assign)(Object(a.__assign)({},tn.e.pack({fixItUrl:null===(r=null===(i=null==e?void 0:e.response)||void 0===i?void 0:i.error)||void 0===r?void 0:r.fixItUrl})),en.e.pack({}));case 401:return en.e.pack({});case 0:return en.g.pack({domain:new x.e(t).domain})}})||Object(k.t)({},{})),n}var rn,on=n(4097),sn=new k.e("enableListViewDataPrefetchConfiguration"),cn=(new k.e("enableQuotaPrefetchConfiguration"),new k.e("prefetchCacheConfiguration")),dn=n(69),ln=!he.e.isActivated("1B495665-36BF-4607-9FA5-4188B441480C","01/17/2022","Expand thumbnails in parent Item request"),un=((rn={})[fe.r]="name",rn[fe.s]="lastModifiedDateTime",rn[fe.d]="size",rn[fe.n]="photo/takenDateTime",rn),fn=!he.e.isActivated("03493AC3-19D5-41B4-819C-AA79F8EF0A6B","07/14/2022","Add special Folder to the select query"),pn="HonorNonIndexedQueriesWarningMayFailRandomly",mn=he.e.isActivated("E4E006D3-AD74-4A5E-AD82-20E4FDF57586","12/01/2022","Add A2OD prefer header in request to get shortcut remoteitem")?pn:"".concat(pn,", ").concat("Include-Feature=AddToOneDrive"),_n="Migration=EnableRedirect;FailOnMigratedFiles",hn=!he.e.isActivated("0EE393E4-FFA7-42F0-A80F-087B337FC123","04/01/2022","Restrict `loadAndProcessPagedDriveItemSet` to throw 1 error. Throw child error with preference if both child and parent response throw."),bn=!he.e.isActivated("E0D4E3B7-F0E1-41FE-BDB6-DCFF1C62CA43","04/01/2022","Process parent item error, and add handling for `sharingPasswordRequired` error"),gn=!he.e.isActivated("FC3A83FA-3DF5-4FF4-8DD8-A0B87B3136CC","06/07/2022","Check if the parent item is resolved or not using resolvedAsKeyFacetFacet"),vn=!he.e.isActivated("3601D612-C2B7-4B43-9EE4-DD98BBE9A680","09/12/2022","Allows processing of user migrated error in ODC prefetch");function yn(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,r,o,s,c,d,p,m,_,h,b,v,y,S,D,I,x,C,w,E,A,L,M,P,T,U,F,H,R,j,V,G,K,W,q,Q,Y,J,X,$,ee,te,ne,ae,ie,re,oe,se,ce,de,le,ue,fe,pe,me;return Object(a.__generator)(this,function(_e){switch(_e.label){case 0:return t=e.itemKey,i=e.top,r=e.skip,o=e.disableRemoteItemInPlace,s=z.e.deserialize(t),c=s.driveItemKey,d=s.extFilters,p=s.sortBy,m=s.isAscending,_=s,h=c,c.driveId&&"me"!==c.driveId?[3,2]:[4,n(Ze({endpoint:c.endpoint}))];case 1:(b=_e.sent())!==c.endpoint&&(h=Object(a.__assign)(Object(a.__assign)({},c),{endpoint:b}),_=Object(a.__assign)(Object(a.__assign)({},s),{driveItemKey:h})),_e.label=2;case 2:return v=O.e.serialize(h),y=Object(l.n)(h),S=h.driveId||"",[4,n(Object(N.e)(function(e){return{isParentItemResolved:gn?e.demandItemFacet(Qt.i,v)===O.e:e.isItemFacetResolved(O.e,v),totalChildCount:e.isItemFacetResolved(B.e,v)?e.demandItemFacet(B.e,v):void 0,driveType:e.isItemFacetResolved(Z.e,v)?e.demandItemFacet(Z.e,v):void 0}}))];case 3:return D=_e.sent(),I=D.isParentItemResolved,x=D.totalChildCount,C=D.driveType,w=n(Object(u.i)(h.endpoint)),E=n(Jt())&&w,A=n(Object(f.e)({convergenceConfiguration:be.e,enableListViewDataPrefetchConfiguration:sn,prefetchCache:cn,isUnauthenticated:je.e})),L=A.convergenceConfiguration,M=A.enableListViewDataPrefetchConfiguration,P=A.prefetchCache,T=A.isUnauthenticated,U=void 0!==T&&T,F=[{code:"notAllowed",message:"You do not have access to create this personal site or you do not have a valid license"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"ItemNotFound"},{code:"503"},{code:"userContentMigrated"}],H=L&&L.canHandleUserMigration,R=null==L?void 0:L.isMigratedContent,j=S&&R&&R(S),V=Promise.resolve(void 0),I||(G=function(e){var t=e.driveItem,n=Object(l.t)(t);if(!n)return"";var a=new dn.t(n);return a.setQueryParameter("$select","*,sharepointIds"),ln&&a.setQueryParameter("$expand","thumbnails"),a.toString()}({driveItem:h}),K="getItem",W=function(){return n(Object(u.n)({url:G,driveUrl:y,driveId:S,useMultiPartIfSupported:E,qosName:K,endpoint:h.endpoint,headers:w&&H?{Prefer:_n}:void 0,expectedErrors:w?F:void 0,scenarioInfo:{scenario:$e.e.BrowseFiles,scenarioType:$e.t.ActiveUserOperation}}))},M&&P?($=P.getData({url:G,qosName:K}),V=$?$.catch(function(e){if(vn&&e instanceof $t.e&&"userContentMigrated"===e.code)throw e;return W()}):W()):V=W()),q=function(e){var t=e.driveItem,n=e.skip,i=e.totalChildCount,r=e.isConsumerEndpoint,o=e.isMigratedContent,s=e.isUnauthenticated,c=e.enableDefaultSortOrderFromBackend,d=e.sortBy,u=e.isAscending,f=e.extFilters,p=e.top,m=Object(l.t)(t),_=n?"&skiptoken=".concat(n+1,"/").concat(i,"&skip=").concat(n):"",h=c?"&orderby=folder,".concat(o||s?"name":"savedSortFieldValue"):"",b=d&&void 0!==u?function(e,t){return"&orderby=folder,".concat(un[e]," ").concat(t?"asc":"desc")}(d,u):h,g=function(e){if(!e||0===e.length)return"";e.unshift("folder");for(var t=[],n=[],i=0,r=Object(Tt.e)(e);i<r.length;i++){var o=r[i],s=!1,c=o;if(Object(Mt.e)(o)&&(c=Object(Mt.t)(o),s=!0),s)return"";if(Object(Pt.e)(c))return"";if(!Ut)return"";if("media"===c)t.push("photo ne null"),t.push("video ne null");else if("photo"===c)t.push("photo ne null");else if("video"===c)t.push("video ne null");else{if("folder"!==c)return"";t.push("folder ne null")}}return t.length>0||n.length>0?"&$filter=".concat(0===n.length?Ft(t):0===t.length?Ht(n):Ht(Object(a.__spreadArray)([Ft(t)],n,!0))):""}(f),v=fn?",specialFolder":"",y="thumbnails".concat(r?",lenses,tags":"");return"".concat(m,"/children?$top=").concat(p).concat(_).concat(b,"&$expand=").concat(y,"&select=*,ocr,webDavUrl,sharepointIds,isRestricted,commentSettings").concat(v).concat(g)}({driveItem:c,skip:r,totalChildCount:x,isConsumerEndpoint:w,isMigratedContent:!!j,isUnauthenticated:U,enableDefaultSortOrderFromBackend:on.e,sortBy:p,isAscending:m,extFilters:d,top:i}),Q="getChildren.folder",Y=j?{Prefer:"".concat(mn)}:void 0,J=function(){return n(Object(u.n)({url:q,driveUrl:y,driveId:S,qosName:Q,useMultiPartIfSupported:E,endpoint:h.endpoint,headers:w&&H?{Prefer:_n}:Y,expectedErrors:F,scenarioInfo:{scenario:$e.e.BrowseFiles,scenarioType:$e.t.ActiveUserOperation}}))},M&&P?($=P.getData({url:q,qosName:Q}),X=$?$.catch(function(e){if(vn&&e instanceof $t.e&&"userContentMigrated"===e.code)throw e;return J()}):J()):X=J(),ee=!1,De.e(Se.e.dataFetch.start)||(De.t(Se.e.dataFetch.start),ee=!0),hn?[4,V.catch(function(t){ae=bn?n(function(e,t){var n=e.error;return function(i){var r,o=an(n,t),s=Object(k.n)({accessDeniedError:en.e,passwordProtectedError:tn.e},o),c=s.accessDeniedError,d=s.passwordProtectedError,l=new xe.e({facets:o,innerError:new xe.e(n)});if(c&&d){var u=new g.e;u.updateItems({items:(r={},r[e.itemKey]=Object(a.__assign)({},Qt.t.pack(l)),r)}),i(u.execute())}return l}}(Object(a.__assign)(Object(a.__assign)({},e),{error:t}),h.endpoint)):t})]:[3,6];case 4:return te=_e.sent(),[4,X.catch(function(t){ie=n(Sn(Object(a.__assign)(Object(a.__assign)({},e),{error:t,parentItemError:ae}),h.endpoint))})];case 5:if(ne=_e.sent(),ie)throw ie;if(ne=ne,ae)throw ae;return[3,8];case 6:return re=[X.catch(function(t){throw n(Sn(Object(a.__assign)(Object(a.__assign)({},e),{error:t}),h.endpoint))}),V],[4,Promise.all(re)];case 7:le=_e.sent(),ne=le[0],te=le[1],_e.label=8;case 8:return ee&&De.t(Se.e.dataFetch.end),te&&(te.folder&&(x=te.folder.childCount),te.parentReference&&te.parentReference.driveType&&(C=te.parentReference.driveType)),oe=n(Object(u.r)(h.endpoint,C)),(se=new g.e({publisher:yn})).mapKeys({mappings:(ue={},ue[z.e.serialize(_)]=e.itemKey,ue[v]=O.e.serialize(s.driveItemKey),ue)}),s.driveItemKey.driveId&&"me"!==s.driveItemKey.driveId||((null===(me=null==te?void 0:te.parentReference)||void 0===me?void 0:me.driveId)&&se.mapKeys({mappings:(fe={},fe[z.e.serialize(Object(a.__assign)(Object(a.__assign)({},_),{driveItemKey:Object(a.__assign)(Object(a.__assign)({},_.driveItemKey),{driveId:te.parentReference.driveId})}))]=e.itemKey,fe)}),se.mapKeys({mappings:(pe={},pe[O.e.serialize(Object(a.__assign)(Object(a.__assign)({},s.driveItemKey),{driveId:"me"}))]=O.e.serialize(Object(a.__assign)(Object(a.__assign)({},s.driveItemKey),{driveId:""})),pe)})),de=(ce=se).merge,[4,n(Ie({itemKey:t,itemSetKeyFacet:z.e,parentItemKeyFacet:O.e,parentItemResponse:te,childItemsResponse:ne,disableRemoteItem:o,filterChildItems:d&&d.length>0?Rt(d):void 0,skip:r,enableRandomAccess:oe,totalChildCount:x,onProcessResponse:function(e){var t,n=e.driveItemKey,i=new g.e({publisher:yn});return n&&i.resolveItems({items:(t={},t[O.e.serialize(n)]=Object(a.__assign)({},Qt.i.pack(O.e)),t)}),{itemResolver:i}}}))];case 9:return de.apply(ce,[_e.sent().itemResolver]),[2,se]}})})}}function Sn(e,t){var n=e.error,i=e.parentItemError;return function(r){var o,s=an(n,t),c=Object(k.n)({itemNotFoundError:en.p,accessDeniedError:en.e,networkBlockedError:en.g},s),d=c.itemNotFoundError,l=c.accessDeniedError,u=c.networkBlockedError,f=Object(k.n)({passwordProtectedError:tn.e},i instanceof xe.e?i.facets:Object(k.t)({},{})).passwordProtectedError,p=new xe.e({facets:Object(a.__assign)(Object(a.__assign)({},s),f?tn.e.pack(f):{}),innerError:new xe.e(n)});if(d||l||u){var _=new g.e;_.updateItems({items:(o={},o[e.itemKey]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},m.e.pack(void 0)),m.o.pack(void 0)),Qt.t.pack(p)),o)}),r(_.execute())}return p}}var Dn=Object(i.i)()(function(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(a.__generator)(this,function(r){switch(r.label){case 0:return t=n(Object(f.e)({pageSize:S.r})).pageSize,[4,n(yn(Object(a.__assign)(Object(a.__assign)({},e),{disableRemoteItemInPlace:!0,skip:0,top:t||F.t})))];case 1:return i=r.sent(),De.t(Se.e.resolveData.start),n(i.execute()),De.t(Se.e.resolveData.end),[2]}})})}}),In=Object(i.t)(function(){return function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(t){return e(Object(tt.t)({keyFacet:z.e,facets:[z.e,m.e]})),e(Object(s.a)(z.e,nt.e)(Dn)),[2]})})}}),xn=n(44),Cn=n(149),On=n(374),wn=n(490);function En(e,t){var n=t.folderItemKey,i=t.itemSet;if(n&&i){var r=e.demandItemFacet(K.e,n),o=function(e,t){return!("photo"===(null==e?void 0:e.folderType))&&t===fe.t}(null==r?void 0:r.folder,i.sortBy)?"":i.sortBy;return Object(a.__assign)(Object(a.__assign)({},i),{sortBy:o})}return i}function An(e,t){var n,i,r=Object(xn.e)(e),o={},s=e.demandItemFacet(z.e,t.itemKey),c=e.demandItemFacet(O.e,t.itemKey),d=e.demandItemFacet(q.e,t.itemKey,{suppressGetItems:!0}),l=e.demandItemFacet(W.e,t.itemKey,{suppressGetItems:!0});if(he.e.isActivated("09AA0112-641E-4D73-805E-DBCD89D22C3D","9/30/2021","Use new shortcutItemFacet for shortcut checks")){if(l&&t.itemKey)return i={driveItemKey:l,sortBy:"",isAscending:!0},f=z.e.serialize(i),Object(a.__assign)(Object(a.__assign)({},Ln(0,{itemSetKey:f,parentItemKey:O.e.serialize(i.driveItemKey),stageItem:t.stageItem})),{itemKey:On.e.serialize({localItemKey:t.itemKey,remoteItemKey:f})})}else if(d&&t.itemKey){var u=e.demandItemFacet(O.e,d.itemKey);if(u){i={driveItemKey:u,sortBy:"",isAscending:!0};var f=z.e.serialize(i);return Object(a.__assign)(Object(a.__assign)({},Ln(0,{itemSetKey:f,parentItemKey:O.e.serialize(i.driveItemKey),stageItem:t.stageItem})),{itemKey:On.e.serialize({localItemKey:t.itemKey,remoteItemKey:f})})}}if(s){var p=c||s.driveItemKey;i=En(e,{folderItemKey:O.e.serialize(p),itemSet:s}),n=Ln(0,{itemSetKey:z.e.serialize(i||s),parentItemKey:O.e.serialize(s.driveItemKey),stageItem:t.stageItem}),o={itemKey:t.itemKey}}else i=function(e,t){var n=t.folderItemKey,i=t.currentItemSetKey;if(i&&n){var r=e.demandItemFacet(z.e,i),o=e.demandItemFacet(O.e,n);if(r&&o){if(!he.e.isActivated("D8B0FDDF-555D-49A4-B069-D03ED692694A","11/4/2021","Do not emit item set key for non-folder items")&&o.itemId&&"root"!==o.itemId&&!e.demandItemFacet(w._,n))return;var s=o.endpoint,c=o.driveId,d=o.itemId;return Object(a.__assign)(Object(a.__assign)({},r),{driveItemKey:{endpoint:s,driveId:c,itemId:d}})}}}(e,{folderItemKey:t.itemKey,currentItemSetKey:r}),o=(f=(i=En(e,{folderItemKey:t.itemKey,itemSet:i}))?z.e.serialize(i):void 0)?{itemKey:f}:{},n=i&&f&&Ln(0,{itemSetKey:f,parentItemKey:O.e.serialize(i.driveItemKey),stageItem:t.stageItem});var m=Object(wn.e)(e),_=m?e.demandItemFacet(O.e,m.localItemKey):void 0;if(m&&(i||o||c)){var h=_&&_.driveId,b=s&&s.driveItemKey&&s.driveItemKey.driveId||c&&c.driveId,g=i?z.e.serialize(i):s?z.e.serialize(s):c?O.e.serialize(c):void 0;if(h!==b&&g)return Object(a.__assign)({itemKey:On.e.serialize({localItemKey:m.localItemKey,remoteItemKey:g})},n?{stageItem:n}:{})}return Object(a.__assign)(Object(a.__assign)({},o),n?{stageItem:n}:{})}function Ln(e,t){var n=this,i=t.parentItemKey,r=t.itemSetKey,o=t.stageItem;if(i)return o?Object(Cn.t)(function(e){var t=e.itemsScopeItemKey,s=e.currentItemKey;return function(e){return Object(a.__awaiter)(n,void 0,void 0,function(){var n;return Object(a.__generator)(this,function(c){switch(c.label){case 0:return e(Object(tt.e)({items:(n={},n[r]=Object(a.__assign)({},m.r.pack({itemKey:i})),n)})),[4,e(o({currentItemKey:s,itemsScopeItemKey:t}))];case 1:return c.sent(),[2]}})})}}):void 0}var kn=n(263),Mn=n(402),Pn=new _.e("driveItemVirtualizedPage",{endpoint:h.e,setItemKey:h.e,skip:Mn.e,top:Mn.e}),Tn=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=Pn.deserialize(n),r=i.setItemKey,o=i.top,s=i.skip;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(a.__generator)(this,function(c){switch(c.label){case 0:return[4,n(yn(Object(a.__assign)(Object(a.__assign)({},e),{itemKey:r,disableRemoteItemInPlace:!1,skip:s,top:o})))];case 1:return(t=c.sent()).resolveItems({items:(i={},i[r]=Object(a.__assign)({},Object(p.e)().forFacet(m.e).thenInvalidate(e.itemKey,m.e).pack()),i)}),n(t.execute()),[2]}})})}}),Un=n(1475),Fn=n(612);function Hn(e,t){var n=t.handlers,i=t.itemKey,r=e.demandItemFacet(z.e,i),o=e.demandItemFacet(Fn.e,i);if(n&&(r||o)){for(var s=[],c=0,d=n;c<d.length;c++){var l=d[c];if(l.key===Dt.l.key)s.push("photo");else if(l.key===Dt.u.key)s.push("video");else if(l.key===Dt.a.key)s.push("folder");else if(l.key===Dt.n.key)s.push("file");else if(l.key===Dt.d.key)s.push("onenote");else if(l.key===Dt.s.key)s.push("!photo");else if(l.key===Dt.c.key)s.push("!video");else if(l.key===Dt.r.key)s.push("!folder");else if(l.key===Dt.o.key)s.push("!onenote");else{var u=Object(St.e)(l);u&&s.push(u)}}if(r)return{itemKey:z.e.serialize(Object(a.__assign)(Object(a.__assign)({},r),{extFilters:s}))}}return{}}var Rn=n(1473),Nn=n(1552),Bn=n(1308);function jn(e,t){return{validator:Bn.e}}var Vn=n(277);function zn(e,t){var n,a,i=t.itemKey,r=Object(Vn.e)(e,{itemKey:i}),o=e.demandItemFacet(O.e,r),s=e.demandItemFacet(z.e,i),c=e.demandItemFacet(Fn.e,i);if(!o&&!s&&!c)return{};var d=null!==(a=null!==(n=null==c?void 0:c.driveItemKey)&&void 0!==n?n:null==s?void 0:s.driveItemKey)&&void 0!==a?a:o,l=null==d?void 0:d.endpoint,u=null==d?void 0:d.driveId,f=l&&u?e.demandItemFacet(O.e,O.e.serialize({endpoint:l,driveId:u,itemId:"root"})):void 0;return{isAvailable:!0,query:null==c?void 0:c.searchTerm,getSearchItemKey:function(e){var t;if(d)return Fn.e.serialize({driveItemKey:d,searchTerm:e||"",scope:null!==(t=null==c?void 0:c.scope)&&void 0!==t?t:(null==f?void 0:f.itemId)===(null==o?void 0:o.itemId)?"drive":"folder"})}}}var Gn=n(1515),Kn=n(686),Wn=n(1075),qn=n(1298),Qn=n(709),Yn=n(637),Jn=n(691),Xn=n(425),Zn=n(426),$n=n(2930);function ea(e,t){var n=t.itemKey;return e.demandItemFacet(oe.e,n)?{isAvailable:!1}:{isAvailable:e.demandItemFacet($n.e,n)}}var ta=n(59);function na(e,t){var n=t.itemKey,a=Object(ta.e)(e);return e.demandItemFacet(rt,a)&&!e.demandItemFacet(oe.e,n)?{isAvailable:!1}:{isAvailable:e.demandItemFacet($n.a,n),validator:Bn.e}}var aa=n("react-lib"),ia=n(56),ra=n(4630),oa=n(126);function sa(e,t){var n=t.itemKey,a=e.demandItemFacet($n.t,n),i=e.demandItemFacet(W.e,n);return{isAvailable:a&&!i,deleteWizard:ca}}Object(oa.n)([{rawString:".informationContainer_9d9ce1da{background-color:#f3f2f1;border-radius:8px;box-sizing:border-box;display:flex;gap:8px;padding:8px 12px;width:100%}.informationContainer_9d9ce1da .infoIcon_9d9ce1da{color:#616161;font-family:FabricMDL2Icons;font-size:16px}.informationContainer_9d9ce1da .informationText_9d9ce1da{color:#242424;font-size:12px;line-height:16px;margin:0}"}]);var ca=Object(ia.t)(function(e,t){var n,i=t.itemKeys,r=t.defaultRender,o=Object(a.__rest)(t,["itemKeys","defaultRender"]),s=e.demandItemFacet(w.d,i[0]);if(1===i.length){var c=e.demandItemFacet(w.u,i[0]);n=Object(a.__assign)(Object(a.__assign)({},o),{getDeleteWizardStrings:function(e){return Object(a.__assign)(Object(a.__assign)({},o.getDeleteWizardStrings(e)),{confirmTitle:s?ra.o:ra.e,confirmText:s?qe.format(ra.r,c):ra.t})}})}else i.length>0&&(n=Object(a.__assign)(Object(a.__assign)({},o),{getDeleteWizardStrings:function(e){return Object(a.__assign)(Object(a.__assign)({},o.getDeleteWizardStrings(e)),{confirmTitle:s?ra.o:ra.e,confirmText:s?ra.i:ra.n})}}));var d=!1;he.e.isActivated("940C7189-6004-4F43-BF51-0CC7401767E7","02/25/2022","Enable Photo story delete prompt when deleting an item used in photo story")||(d=i.some(function(t){return e.demandItemFacet(ue.e,t)}));var l=n||o;return r?aa.createElement(r,Object(a.__assign)({itemKeys:i},l),d&&aa.createElement("div",{className:"informationContainer_9d9ce1da"},aa.createElement("div",{className:"infoIcon_9d9ce1da"},""),aa.createElement("p",{className:"informationText_9d9ce1da"},ra.a))):null});function da(e,t){var n=t.itemKey;return e.demandItemFacet(oe.e,n)?{isAvailable:!1}:{isAvailable:e.demandItemFacet($n.i,n)}}var la=n(3145),ua=!he.e.isActivated("13F88196-AC5C-4718-8E30-A5727F39F771","01/20/2023","Enables AV override on file downloads for item owners");function fa(e,t){if(1!==t.itemKeys.length)return{};var n=t.itemKeys[0];if(e.demandItemFacet(w._,n))return{};var i=e.demandItemFacet(O.e,n),r=i?Object(l.t)(i):void 0,o=i?Object(l.n)(i):void 0,s=null==i?void 0:i.driveId,c=i&&i.endpoint||"",d=i&&Object(la.e)(e,{driveItemKey:i});return{isAvailable:e.demandItemFacet($n.n,n),getDownloadData:r&&o?function(){return function(e){var t=this,n=e.itemUrl,i=e.driveUrl,r=e.driveId,o=e.endpoint,s=e.isOwner;return function(c){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,d,l,f,p;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,c(Object(u.t)({url:e.itemUrl,driveUrl:i,driveId:r,method:"GET",qosName:"getItemDownloadUrl",endpoint:o}))];case 1:if(t=a.sent(),d=function(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)}(n)?t["@microsoft.graph.downloadUrl"]:t["@content.downloadUrl"],!d)throw new Error("Unable to obtain download URL.");return ua&&s&&((l=new dn.t(d)).setQueryParameter("AVOverride","1"),d=l.toString()),[2,{method:"GET",url:d}];case 2:throw(f=a.sent())instanceof $t.e?(p=Object($t.t)(f,function(e,t){switch(e){case"unauthenticated":case 401:return en.a.pack({});case"itemNotFound":case 404:return en.c.pack({});case"accessDenied":case 403:return en.e.pack({});default:return en.v.pack({})}}),new xe.e({innerError:f,facets:p})):f;case 3:return[2]}})})}}({itemUrl:r,driveUrl:o,driveId:s,endpoint:c,isOwner:d})}:void 0}}function pa(e,t){var n=t.itemKey,i=e.demandItemFacet(O.e,n);return{isAvailable:!0,getShareLink:function(){return function(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,r,o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return(t=e.driveItem)?(i=Object(l.t)(t)+"/invite",r=Object(l.n)(t),o=t.driveId,[4,n(Object(u.n)({url:i,driveUrl:r,method:"POST",qosName:"getDefaultShareLink",endpoint:t.endpoint,driveId:o,headers:{prefer:"getDefaultLink","Content-type":"application/json"}}))]):[3,2];case 1:if(!(s=a.sent()))throw new Error("Unable to obtain default share URL");return[2,{url:s.value[0].link.webUrl,scope:s.value[0].link.scope}];case 2:throw new Error("Unable to obtain default share URL")}})})}}({driveItem:i})}}}function ma(e,t){var n=t.itemKey,i=t.link,r=t.recipients,o=e.demandItemFacet(O.e,n);return{isAvailable:!0,permissionInvite:function(){return function(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,r,o,s,c,d,l,f,p,m;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(i=e.link,r=e.recipients,!(t=e.driveItem)||!i)throw new Error("Unable to obtain default share URL");return o=t.endpoint,s=t.driveId,d=btoa(i),c="u!"+d.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-"),l=r.map(function(e){return{email:e}}),f={recipients:l,roles:["read"]},p=o.replace("v1.0","beta"),m=p+"/shares/"+c+"/permission/grant",[4,n(Object(u.n)({url:m,driveId:s,method:"POST",qosName:"permissionGrant",endpoint:t.endpoint,headers:{"Content-type":"application/json",Accept:"application/json"},body:f}))];case 1:return[2,{recipients:a.sent().value[0].grantedToIdentities.map(function(e){return{email:e.user.email}})}]}})})}}({driveItem:o,link:i,recipients:r})}}}var _a=n(1339),ha=n(1700),ba=n(46),ga=n(3634),va=n(4098),ya=n(904),Sa=n(2931),Da=!he.t.isActivated("9E25FA89-BCCC-4B1B-A51A-07D2E059CA43","06/16/2022","Enable shortcut tags in engagement extra data");function Ia(e,t){var n=t.itemsScopeItemKey,i=t.engagement,r=t.itemKey,o=i&&i.name,s=e.demandItemFacet(z.e,r),c=(null==s?void 0:s.driveItemKey)||e.demandItemFacet(O.e,r),d=c&&Object(la.e)(e,{driveItemKey:c}),l=e.demandItemFacet(On.e,r),u=void 0,f=void 0;if(Da)if(l)e.demandItemFacet(z.e,l.remoteItemKey)?u=!0:f=!0;else{var p=e.demandItemFacet(Qe.n,n);f=!!e.demandItemFacet(On.e,p&&p.itemKey)}var m,_=c||{},h=_.driveId,b=void 0===h?"me":h,g=_.itemId,v=void 0===g?"root":g;return"me"===b&&"root"===v?m="MyFiles":(s||"root"===v)&&(m="Folder"),{engagement:Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},(null==i?void 0:i.datasource)?{}:{datasource:"Graph"}),m?{objectType:m}:{}),{extraData:Object(a.__assign)({itemGraphId:v,itemGraphDriveId:b,isOwner:!!d,isShortcut:u,isInsideAShortcut:f},"ItemsView.Load"===o?Object(ut.e)(e,{itemsScopeItemKey:n}):{})})}}function xa(e,t){var n=t.currentItemKey,a=e.demandItemFacet(z.e,n),i=(null==a?void 0:a.driveItemKey)||e.demandItemFacet(O.e,n)||{},r=i.driveId,o=void 0===r?"me":r,s=i.itemId;return{engagement:{currentPage:"me"===o&&"root"===(void 0===s?"root":s)?"MyFiles":"Folder"}}}var Ca=Object(i.t)(function(){return function(e){e(Object(ct.e)(O.e,dt.e)(Ia)),e(Object(ct.e)(z.e,dt.e)(Ia)),e(Object(ct.e)(O.e,lt.e)(xa))}}),Oa=Object(i.t)(function(){return function(e){var t=e(Object(f.e)({useBatchedDeleteConfiguration:S.N})).useBatchedDeleteConfiguration;e(Object(tt.t)({keyFacet:O.e,facets:[O.e,w.u,w.m,w._,q.e,W.e,w.A,w.c,m.t,w.k,w.i,w.f,ee.n]})),e(Object(tt.t)({keyFacet:b,facets:[b,m.e,m.a]})),e(In),e(Object(s.a)(O.e,nt.e)(Xt)),e(Object(s.a)(Pn,nt.e)(Tn)),e(Object(s.a)(b,nt.e)(Zt)),e(Object(ct.e)(O.e,kn.e)(An)),e(Object(ct.e)(z.e,kn.e)(An)),e(Ca),e(Object(ct.e)(z.e,Sa.e)(zn)),e(Object(ct.e)(z.e,vt.e)(Hn)),e(Object(s.a)(O.e,Gn.t)(Object(i.a)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(23).then(n.bind(null,5152))];case 1:return[2,e.sent().driveItemCreateFolderOperationHandler]}})})}))),e(t?Object(s.a)(O.e,Kn.e)(Object(i.a)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(504).then(n.bind(null,5153))];case 1:return[2,e.sent().driveItemDeleteItemsBatchedOperationHandler]}})})})):Object(s.a)(O.e,Kn.e)(Object(i.a)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(24).then(n.bind(null,4302))];case 1:return[2,e.sent().driveItemDeleteItemsOperationHandler]}})})}))),e(Object(ct.e)(O.e,ga.e)(e(Object(ba.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(20).then(n.bind(null,5154))];case 1:return[2,e.sent().driveItemDeleteProgressControlHandler]}})})})))),e(Object(s.a)(O.e,Wn.t)(Object(i.a)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(26).then(n.bind(null,5155))];case 1:return[2,e.sent().driveItemRenameItemOperationHandler]}})})}))),e(Object(s.a)(O.e,qn.t)(Object(i.a)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(27).then(n.bind(null,5343))];case 1:return[2,e.sent().driveItemUploadItemsOperationHandler]}})})}))),e(Object(s.a)(O.e,Rn.t)(Object(i.a)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(25).then(n.bind(null,5156))];case 1:return[2,e.sent().driveItemMoveCopyItemsOperationHandler]}})})}))),e(Object(s.a)(O.e,Un.e)(Object(i.a)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(19).then(n.bind(null,5157))];case 1:return[2,e.sent().addToOneDriveOperationHandler]}})})}))),e(Object(ct.e)(O.e,Qn.e)(ea)),e(Object(ct.e)(O.e,Nn.e)(jn)),e(Object(ct.e)(O.e,Yn.e)(na)),e(Object(ct.e)(O.e,Jn.t)(sa)),e(Object(ct.e)(O.e,Xn.e)(da)),e(Object(ct.e)(O.e,_a.e)(pa)),e(Object(ct.e)(O.e,ha.e)(ma)),e(Object(ct.e)(O.e,Zn.t)(fa)),e(Object(ct.e)(O.e,ya.e)(va.e))}}),wa=n(3208),Ea=n(3207),Aa=he.e.isActivated("1097DC43-A3D7-4151-A119-48637C6D4534","04/05/2022","Fixes itemsscope + ko shim logic related to items with view-only permissions"),La=Object(i.i)()(function e(t){var n=this;return function(i){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,r,o,s,c,d,u;return Object(a.__generator)(this,function(f){switch(f.label){case 0:return n=t.itemKey,r=Ea.e.deserialize(n),o=r.endpoint,s=Object(l.n)(r),[4,i(ka({url:Object(l.e)(r),driveUrl:s,qosName:"commands",endpoint:o}))];case 1:return c=f.sent(),(d=new g.e({publisher:e})).resolveItems({items:(u={},u[n]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},wa.e.pack(c.addToOneDrive)),wa.t.pack(c.createFolder)),wa.n.pack(c.createLink)),wa.a.pack(c.delete)),wa.i.pack(c.download)),wa.r.pack(c.invite)),wa.o.pack(c.move)),wa.s.pack(c.officeLens)),wa.c.pack(c.rename)),wa.d.pack(c.upload)),u)}),i(d.execute()),[2]}})})}});function ka(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(a.__generator)(this,function(a){return t=e.endpoint,i=n(Object(u.i)(t)),[2,{addToOneDrive:{roles:Aa||i?["write"]:["owner","write","read"]},createFolder:{roles:["owner","write"]},createLink:{defaultScope:"anonymous",linkTypes:["view","edit"],scopes:["anonymous","application"]},delete:{roles:["owner","write"]},download:{roles:["owner","write","read"]},invite:{roles:["owner","write"]},move:{roles:["owner","write"]},officeLens:{extensions:["jpeg","jpg","jpe"],lensNames:["officeLens"],roles:["owner"]},rename:{roles:["owner","write"]},upload:{roles:["owner","write"]}}]})})}}var Ma=Object(i.t)(function(){return function(e){e(Object(tt.t)({keyFacet:Ea.e,facets:[wa.e,wa.t,wa.n,wa.a,wa.i,wa.r,wa.o,wa.s,wa.c,wa.d]})),e(Object(s.a)(Ea.e,nt.e)(La))}});function Pa(e){var t=e.itemKey,n=e.itemSetKeyFacet,i=e.parentItemKeyFacet,r=e.childItemsResponse,o=e.disableRemoteItem,s=e.parentItemResponse,c=e.mapItemSetKey,d=n.deserialize(t),l=i.serialize(d),u=d.driveItemKey.endpoint;return function(n){var i,d;De.t(Se.e.processData.start);var _=n(ye(Object(a.__assign)(Object(a.__assign)({},e),{response:r,disableRemoteItem:o,parentItemKey:l}))).itemResolver;if(c){var h=c().itemResolver;_.merge(h)}var b=n(Object(f.e)({allowDisableRemoteItemInPlace:S.i})).allowDisableRemoteItemInPlace;if(s){var g=n((b&&o?_e:R)({setItemKey:t,driveItemResponse:s,endpoint:u})),v=g.itemResolver,y=g.actualItemKey;_.mapKeys({mappings:(i={},i[y]=l,i)}),_.merge(v)}return _.resolveItems({items:(d={},d[l]=Object(a.__assign)({},Object(p.e)().forFacet(m.t).thenInvalidate(e.itemKey,m.e).pack()),d)}),De.t(Se.e.processData.end),{itemResolver:_}}}var Ta=he.t.isActivated("cade488d-480a-444f-a1ea-d3d121529bb7","11/01/2021","Set one minute timeout for API requests");function Ua(e){var t=this,n=e.itemKey,i=e.itemSetKeyFacet,r=e.getUrl,o=e.sortChildItems,s=e.qosName,c=e.preprocessResponse,d=e.expectedErrors,f=e.disableRemoteItem,p=void 0!==f&&f,m=i.deserialize(n),_=m.driveItemKey,h=_.endpoint,b=_.driveId;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,f,_,g,v;return Object(a.__generator)(this,function(y){switch(y.label){case 0:t=Object(l.n)(m.driveItemKey),y.label=1;case 1:return y.trys.push([1,4,,5]),[4,n(Object(u.n)({url:r(m),driveUrl:t,driveId:b,qosName:"getChildren".concat(s?".".concat(s):""),endpoint:h,headers:e.additionalHeaders,expectedErrors:d,timeout:Ta?void 0:6e4,scenarioInfo:{scenario:$e.e.Search,scenarioType:$e.t.ActiveUserOperation}}))];case 2:return i=y.sent(),f=Object(a.__spreadArray)([],i.value,!0),_=c&&c(f)||i.value,g=o&&o(_)||_,[4,n(Pa(Object(a.__assign)(Object(a.__assign)({},e),{disableRemoteItem:p,childItemsResponse:Object(a.__assign)(Object(a.__assign)({},i),{value:g})})))];case 3:return[2,{itemResolver:y.sent().itemResolver}];case 4:throw v=y.sent(),new xe.e(Object(a.__assign)({code:"UnknownError"},v instanceof Error?{innerError:v}:{message:JSON.stringify(v)}));case 5:return[2]}})})}}var Fa=n(921),Ha=Object(i.i)()(function(e){var t=this,n=Fn.e.deserialize(e.itemKey);return function(i){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,r,o,s,c,d,l,p,m,_,h;return Object(a.__generator)(this,function(b){switch(b.label){case 0:return t=i(Object(f.e)({graphSearchEndpoint:S.x,convergenceConfiguration:be.e,consumerDirectEndpoint:S.h})),r=t.graphSearchEndpoint,o=t.convergenceConfiguration,s=t.consumerDirectEndpoint,c=null==o?void 0:o.isUserMigrated,d=[{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}],l=n,r?(l=Object(a.__assign)(Object(a.__assign)({},l),{driveItemKey:Object(a.__assign)(Object(a.__assign)({},l.driveItemKey),{endpoint:r})}),[3,3]):[3,1];case 1:return l.driveItemKey.driveId&&"me"!==l.driveItemKey.driveId?[3,3]:[4,i(Ze({endpoint:l.driveItemKey.endpoint}))];case 2:(p=b.sent())!==l.driveItemKey.endpoint&&(l=Object(a.__assign)(Object(a.__assign)({},l),{driveItemKey:Object(a.__assign)(Object(a.__assign)({},l.driveItemKey),{endpoint:p})})),b.label=3;case 3:return m=Fn.e.serialize(l),[4,i(Ua(Object(a.__assign)(Object(a.__assign)({},e),{itemKey:m,qosName:"search".concat(c?".migratedUser":""),itemSetKeyFacet:Fn.e,parentItemKeyFacet:Fa.e,getUrl:function(e){var t=e.driveItemKey,n=i(Object(u.i)(t.endpoint));return function(e,t,n,i){var r,o=e.searchTerm,s=e.extFilters,c=e.dateFilter,d=e.scope,l=e.driveItemKey;o&&(r=encodeURIComponent(o).replace(/'/g,"''"));var u=function(e){if(!e||0===e.length)return"";for(var t=[],n=[],i=0;i<e.length;i++){var r=e[i],o=!1,s=r;Object(Mt.e)(r)&&(s=Object(Mt.t)(r),o=!0),"folder"===s?!o&&t.push("folder ne null"):"onenote"===s?o?n.push("(remoteItem/package/type ne 'oneNote' and package/type ne 'oneNote')"):t.push("(remoteItem/package/type eq 'oneNote' or package/type eq 'oneNote')"):"."!==s[0]?"audio"===s?!o&&t.push("audio ne null"):"document"===s?!o&&t.push("file ne null and video eq null and image eq null and audio eq null and folder eq null"):"media"===s&&!o&&t.push("image ne null or video ne null"):!o&&t.push("(endsWith(name, '".concat(s.toLowerCase(),"') or endsWith(remoteItem/name, '").concat(s.toLowerCase(),"'))"))}return t.length>0||n.length>0?"&$filter=( ".concat(0===n.length?Ft(t):0===t.length?Ht(n):Ht(Object(a.__spreadArray)([Ft(t)],n,!0))," )"):""}(s),f=function(e,t){return""!==e?"".concat(e).concat(t?" and ".concat(t):""):t?"&$filter=".concat(t):""}(u,(null==c?void 0:c.beginDate)?"( createdDateTime ge ".concat(c.beginDate," )"):"");if(t||i){var p=l;return n&&(p=Object(a.__assign)(Object(a.__assign)({},l),{endpoint:t?l.endpoint:n})),"".concat(Ra(d,p),"/oneDrive.search(q=@s)?@s='").concat(r,"'").concat(f,"&$expand=thumbnails&select=*,webDavUrl,ocr")}return"".concat(Ra(d,l),"/search(q=@s)?@s='").concat(r,"'&$expand=thumbnails&select=*,webDavUrl,ocr")}(l,n,s,c)},expectedErrors:d})))];case 4:return(_=b.sent().itemResolver).mapKeys({mappings:(h={},h[m]=e.itemKey,h)}),i(_.execute()),[2]}})})}});function Ra(e,t){return"drive"===e?Object(l.n)(t):Object(l.t)(t)}var Na=Object(i.i)()(function(e){var t=this,n=Fa.e.deserialize(e.itemKey),i=n.searchTerm,r=n.driveItemKey,o=n.scope;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,s;return Object(a.__generator)(this,function(c){return t=qe.format(J.i,i),n(Object(tt.e)({items:(s={},s[e.itemKey]=Object(a.__assign)(Object(a.__assign)({},w.u.pack(t)),m.t.pack(Object(a.__assign)(Object(a.__assign)({itemKey:Fn.e.serialize({driveItemKey:r,searchTerm:i,scope:o})},w._.pack({})),w.k.pack(void 0)))),s)})),[2]})})}}),Ba=Object(i.t)(function(){return function(e){e(Object(tt.t)({keyFacet:Fa.e,facets:[w.u,m.t]})),e(Object(s.a)(Fa.e,nt.e)(Na)),e(Object(tt.t)({keyFacet:Fn.e,facets:[m.e]})),e(Object(s.a)(Fn.e,nt.e)(Ha)),e(Object(ct.e)(Fn.e,Sa.e)(zn))}}),ja=n(4519),Va=n(4076),za=n(816),Ga=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=Q.e.deserialize(n).driveItemKey,r=i.endpoint,o=i.driveId;return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,s,c,d,p,m,_,h,b=this;return Object(a.__generator)(this,function(g){return t={Caller:"HoverCard"},s=e(Object(f.e)({enableCookiesForAnalyticsRequests:S.c})).enableCookiesForAnalyticsRequests,c=void 0!==s&&s,d="GetItemAnalytics_addon-graph",p=Object(a.__awaiter)(b,void 0,void 0,function(){var s,f,p,m,_,h;return Object(a.__generator)(this,function(b){switch(b.label){case 0:return[4,e(Object(u.n)({url:(g=Object(l.t)(i),v=Ka(g),y="$select=*".concat(",id,reactions").concat(",trending"),S="".concat(y,"&").concat("$expand=analytics($expand=allTime($expand=activities))").concat(",insights($expand=keyPoints)"),D="".concat(v,"?").concat(S),D),qosName:"".concat(d,"_GetAnalyticsSections"),endpoint:r,driveId:o,timeout:6e3,headers:t,driveUrl:Ka(Object(l.n)(i)),allowCookies:c}))];case 1:return s=b.sent(),f=Object(ja.t)(s),(p=f.createdBy)&&(m=P.e.serialize({email:p.email,endpoint:r}),e(Object(tt.e)({items:(_={},_[m]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(p.displayName)),L.e.pack(p.email)),L.a.pack(p.image)),L.i.pack(p.id)),_[n]=Object(a.__assign)({},A.a.pack({itemKey:m,displayValue:p.displayName})),_)}))),e(Object(tt.e)({items:(h={},h[n]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},A.f.pack(f.viewCount)),A.p.pack(f.viewerCount)),A.o.pack(f.isTrending)),A.e.pack(f.activities)),A.d.pack(f.likeCount)),A.t.pack(f.commentCount)),A.c.pack(f.lifeCycleStatus)),A.s.pack(f.keyPointsData)),A.r.pack(f.incompleteData)),A.i.pack(f.createdDateTime)),h)})),[2]}var g,v,y,S,D})}),m=[p],_=Object(a.__awaiter)(b,void 0,void 0,function(){var o,s,f,p;return Object(a.__generator)(this,function(m){switch(m.label){case 0:return[4,e(Object(u.n)({url:(_=Object(l.t)(i),h=Ka(_),"".concat(h).concat("?$expand=recommendedActionSet($expand=nonAggregatedRecommendedActions,aggregatedEditRecommendedAction($expand=importantActorsAndActivities)),conversationSet($expand=emailConversations($expand=participants),meetingConversations($expand=participants),teamsConversations($expand=participants))")),qosName:"".concat(d,"_GetRecommendedActionsAndConversations"),endpoint:r,timeout:6e3,headers:t,driveUrl:Ka(Object(l.n)(i)),allowCookies:c}))];case 1:return o=m.sent(),s=function(e){var t=e.recommendedActionSet,n=t.nonAggregatedRecommendedActions;return t.aggregatedEditRecommendedAction&&t.aggregatedEditRecommendedAction.recentEditorCount&&(n=n.concat(t.aggregatedEditRecommendedAction)),n}(o),f=function(e){var t=e.conversationSet,n=t.emailConversations.concat(t.meetingConversations,t.teamsConversations),a={},i=[];return n.forEach(function(e){var t=e.teamsMessageThreadId||e.conversationInstance.conversationId;a.hasOwnProperty(t)||(a[t]=!0,i.push({activityTimestamp:e.conversationInstance.sharedByTime,context:e.conversationInstance.subject,conversationType:Va.e[e.conversationInstance.referenceType],deepLink:e.conversationInstance.deepLink,referencePreview:e.conversationInstance.referencePreview,isSharedByMe:e.conversationInstance.isSharedByMe,sharedByUserDisplayName:e.sharedByUser.displayName,sharedByUserEmail:e.sharedByUser.email,participants:e.participants}))}),i.sort(function(e,t){return Date.parse(t.activityTimestamp)-Date.parse(e.activityTimestamp)})}(o),e(Object(tt.e)({items:(p={},p[n]=Object(a.__assign)(Object(a.__assign)({},A.l.pack(s)),A.n.pack(f)),p)})),[2]}var _,h})}),m.push(_),e(Object(tt.e)({items:(h={},h[n]=Object(a.__assign)({},A.u.pack([])),h)})),[2,Object(za.e)(m)]})})}});function Ka(e){return e.replace("2.0","2.1")}var Wa=Object(i.t)(function(){return function(e){e(Object(tt.t)({keyFacet:Q.e,facets:[A.f]})),e(Object(s.a)(Q.e,nt.e)(Ga))}}),qa=n(3125),Qa=n(1719),Ya=n(265),Ja=Object(i.n)({maxParallelOperationCount:1,maxItemCountPerBatch:20,areSameBatch:function(e,t){var n=E.e.deserialize(e.itemKey).driveItemKey,a=n.endpoint,i=n.driveId,r=E.e.deserialize(t.itemKey).driveItemKey,o=r.endpoint,s=r.driveId;return!!i&&!!s&&i===s&&a===o}})(function e(t){var n=this,i=t.items;return function(t){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,r,o,s,c,d,f,m,_,h,b,v,y,S,D,I,x,C,A,L,k,M,P,T,U,F,H,R,N,B,j;return Object(a.__generator)(this,function(V){switch(V.label){case 0:if(n=Object.keys(i),r=n[0],o=E.e.deserialize(r),s=o.driveItemKey,c=s.endpoint,d=s.driveId,!c)throw new Error("No endpoint to determine activity items.");return f=n.map(function(e){return E.e.deserialize(e).driveItemKey.itemId}),m=Object(l.n)({endpoint:(z=c,z.replace("2.1","2.0")),driveId:d}),_="".concat(m,"/ExtendedActivitiesForItems"),h={driveItems:f,badgeOnly:!0},[4,t(Object(u.t)({url:_,method:"POST",body:h,qosName:"ItemActivityFieldDataSource.extendedActivitiesForItems",endpoint:c,driveId:d}))];case 1:if((b=V.sent()).value){for(v=function(e){for(var t={},n=0,a=e;n<a.length;n++){var i=a[n],r=i.driveItemId;r&&(t[r]||(t[r]=[])).push(i)}return t}(b.value),y=0,S=0,D=0,I=0,x=new g.e({publisher:e}),C=0,A=n;C<A.length;C++)L=A[C],y++,k=E.e.deserialize(L),M=k.driveItemKey.itemId,P=M&&v[M],T=O.e.serialize(k.driveItemKey),U=void 0,P&&(F=new qa.e,H=F.processResponse({item:{name:M||"",relativePath:"",absolutePath:"",isFolder:!1,graphItemUrl:_},response:{value:P,"@odata.nextLink":""}}).activities,R=Xa(H),(N=Za(H))&&(D++,S++,R||(I++,B=$a(N,L).itemResolver,x.merge(B),U=N))),x.resolveItems({items:(j={},j[L]=Object(a.__assign)({},Qa.e.pack(U)),j[T]=Object(a.__assign)({},Object(p.e)().forFacet(w.e).thenInvalidate(L,Qa.e).pack()),j)});t(x.execute()),t(Object(Ya.e)({name:"ItemActivityField.View",extraData:{activityFieldProcessedItemCount:y,activityFieldEligibleItemCount:S,activityFieldActiveItemCount:D,activityFieldBadgedItemCount:I,activityFieldBadgedPercent:y?Math.round(I/y*100):0},isIntentional:!1}))}return[2]}var z})})}});function Xa(e){var t=e[0];return!!t&&1===t.actors.length&&t.actors[0].self&&!t.type||!1}function Za(e){var t=e[0],n={};if(t)for(var i=0,r=t.actors;i<r.length;i++)(l=r[i]).id&&(n[l.id]=!0);for(var o=Object(a.__assign)(Object(a.__assign)({},t),{actors:Object(a.__spreadArray)([],t.actors||[],!0)}),s=1;s<e.length;s++)for(var c=0,d=e[s].actors;c<d.length;c++){var l;"string"!=typeof(l=d[c]).id||n[l.id]||(o.actors.push(l),n[l.id]=!0)}return o||t}function $a(e,t){var n=new g.e({publisher:$a}),i=E.e.deserialize(t).driveItemKey,r=function(e){var t=e.actors,n=e.action.mention&&e.action.mention.mentionees||[],i=e.action.share&&e.action.share.recipients||[],r=e.action.commentResponse&&e.action.commentResponse.commentAuthor,o=Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)([],t,!0),n,!0),i,!0);return r&&o.push(r),o}(e);if(r.length>0){var o=ei(r,i).itemResolver;n.merge(o)}return{itemResolver:n}}function ei(e,t){for(var n=new g.e({publisher:ei}),a=0,i=e;a<i.length;a++){var r=ti(i[a],t).itemResolver;n.merge(r)}return{itemResolver:n}}function ti(e,t){var n=new g.e({publisher:ti}),a=U({itemKey:O.e.serialize(t),userKey:P.e.serialize({email:e.email||"",endpoint:t.endpoint}),user:{displayName:e.displayName,email:e.email}}).itemResolver;return n.merge(a),{itemResolver:n}}var ni=Object(i.t)(function(){return function(e){e(Object(s.a)(E.e,nt.e)(Ja)),e(Object(s.a)(E.e,nt.e)(Ja))}}),ai=n(4529),ii=Object(i.t)(function(){return function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(t){return e(Oa),e(Ma),e(Wa),e(o.e),e(r.e),e(qt),e(it),e(gt),e(Ba),e(ni),e(ai.graphSharesAddon),[2]})})}}),ri=n(940),oi=n(91),si=Object(i.t)(function(){return function(e){e(Object(ct.e)(O.e,ri.e)(e(Object(ba.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,e(Object(oi.c)())];case 1:return t.sent(),[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e(14)]).then(n.bind(null,5016))];case 2:return[2,t.sent().driveItemActivityFieldControlHandler]}})})}))))}}),ci=n(449),di=n(523),li=n(888),ui=n(766),fi=n(80),pi=n(240),mi=n(700),_i=n(36),hi=n(214),bi=n(278),gi=n(193),vi=Object(fi.i)({key:new k.e("dateAccessedColumn").id,name:pi.e,fieldName:"",minWidth:fi.e.regularMin,maxWidth:fi.e.regularMax,isCollapsable:!0,data:{facets:Object(a.__assign)({},gi.e.pack("dateAccessed"))}},mi.e)(function(e,t){var n=e.demandItemFacet(w.o,t,{suppressGetItems:!0}),a=n&&new Date(n).getTime();if("number"!=typeof a||isNaN(a))return{text:""};var i=e.demandItemFacet(_i.O,hi.e),r=i&&i.language||window.navigator.language;return r?{text:Object(bi.n)(new Date(a),r)}:{dateValue:a}},function(e,t){return"".concat(e.demandItemFacet(w.o,t))}),yi=n(3130),Si=Object(a.__assign)(Object(a.__assign)({},yi.e),{columnActionsMode:li.t.disabled}),Di=Object(a.__assign)(Object(a.__assign)({},vi),{columnActionsMode:li.t.disabled}),Ii=he.e.isActivated("E4DF8572-56CE-4708-A3CB-DB9720F1B163","09/19/2022","Disable column header action on Recent ItemSet since no action avaible")?[ui.t,yi.e,vi]:[ui.t,Si,Di];function xi(e,t){return{columns:Ii}}var Ci=n(292),Oi=n(312),wi=n(238),Ei=n(761),Ai=n(3164),Li=n(3534),ki=[Oi.e,Li.e,wi.n,wi.t,Ei.e];function Mi(e,t){var n=function(e,t){for(var n=[],a=0,i=t.defaultCommands;a<i.length;a++){var r=i[a];r.key===Oi.e.key?n.push(Ai.e):n.push(r)}return{overrideDefaultCommands:n}}(0,{defaultCommands:ki}).overrideDefaultCommands;return{commands:n}}var Pi=n(4317),Ti=n(422);function Ui(e,t){return{isAvailable:!1}}var Fi=n(1361),Hi=n(1100);function Ri(e,t){var n=e.demandItemFacet(yt.e,t.itemKey),i=!!e.demandItemFacet(B.s,t.itemKey)||(null==n?void 0:n.filters)&&Object(ke.e)({extFilters:Object(ke.t)(n.filters),allowedMediaTypes:[Ee.e.photo,Ee.e.video],fileTypeIconMap:wt.e});return Object(a.__assign)({},i?{defaultLayout:Hi.t.layoutType,isLayoutResolved:!0}:{layouts:[Fi.t,Fi.e]})}var Ni=n(1066),Bi=n(3131),ji=n(3659),Vi=n(4319),zi=n(1304),Gi=n(1518),Ki=Object(fi.i)({key:Ue.t,name:pi.t,fieldName:"",minWidth:fi.e.regularMin,maxWidth:fi.e.regularMax,isCollapsable:!0,sortProps:fi.t,data:{facets:Object(a.__assign)({},gi.e.pack("dateTaken"))}},Gi.t)(function(e,t){return function(){return{itemKey:t}}},function(e,t){return"".concat(e.demandItemFacet(X.c,t,{suppressGetItems:!0}))}),Wi=n(1140),qi=n(1330),Qi=n(614),Yi=n(4093),Ji=he.e.isActivated("22B8A337-05E5-4246-A042-4589C0F3DF7A","11/30/2022","add location column"),Xi=Object(a.__assign)(Object(a.__assign)({},Yi.e),{name:Vi.e});Object(a.__spreadArray)(Object(a.__spreadArray)([ui.e,Qi.t,zi.e,qi.e],Ji?[]:[Xi],!0),[Wi.e],!1),Object(a.__spreadArray)(Object(a.__spreadArray)([ui.e,Qi.t,zi.e,Ki,qi.e],Ji?[]:[Xi],!0),[Wi.e],!1);var Zi=he.e.isActivated("F0E9D1A9-2D93-4FEB-8870-CA6A2A2438B0","08/22/2022","Use the new item path field control handler for fetching paths for files or folders");function $i(e,t){var n,a,i=t.itemKey,r=e.demandItemFacet(w.k,i),o=e.demandItemFacet(w.L,i),s=e.demandItemFacet(ji.e,null==r?void 0:r.itemKey);if(o&&!Zi){var c=qe.format(Vi.n,o);return s?{displayPathSegments:er("/".concat(c).concat(s.path)),openUrl:""}:r&&(u=e.demandItemFacet(w.u,null==r?void 0:r.itemKey))?{displayPathSegments:[c.concat(u)],openUrl:""}:{displayPathSegments:[c],openUrl:""}}var d=Object(xn.e)(e),l=e.demandItemFacet(Fn.e,d);if(!Ji&&l)if(Object($n.o)(e,i)){var u;if(r&&(u=e.demandItemFacet(w.u,null==r?void 0:r.itemKey)))return{displayPathSegments:[u],openUrl:"",action:void 0}}else{var f=e.demandItemFacet(Y.e,i),p=null===(a=null===(n=null==f?void 0:f.owner)||void 0===n?void 0:n.user)||void 0===a?void 0:a.displayName;if(p)return{displayPathSegments:[qe.format(Vi.t,p)],openUrl:"",action:void 0}}return{}}function er(e){for(var t=[],n=0,a=new x.e(e).segments.slice(1);n<a.length;n++){var i=a[n];t.push(i)}return t}var tr=Object(i.t)(function(){return function(e){e(Object(ct.e)(O.e,Bi.e)($i)),e(Object(ct.e)(ji.e,Bi.e)($i))}}),nr=Object(i.t)(function(){return function(e){e(qt),e(tr),e(Object(ct.e)(yt.e,Ni.e)(Ri)),e(Object(ct.e)(yt.e,di.e)(Ri)),e(Object(ct.e)(yt.e,ci.e)(xi)),e(Object(ct.e)(Ot.e,Ci.e)(Mi)),e(Object(ct.e)(Ot.e,Ti.e)(Pi.recentContextMenuControlHandler)),e(Object(ct.e)(At,kn.e)(Ui))}}),ar=n(4321),ir=n(453),rr=n(1313),or=n(4003),sr=n(3923),cr=n(3206),dr=!he.t.isActivated("A62AD86A-B7EB-4EF6-A7F2-CC139D544AE7","","");function lr(e,t){return{commands:Object(a.__spreadArray)(Object(a.__spreadArray)([cr.e?Oi.e:Ai.e,wi.n,wi.t,rr.e],dr?[ir.e]:[],!0),[sr.e,or.e,Ei.e],!1)}}var ur,fr=n(325),pr=((ur={})[Ue.a]=!0,ur[Ue.n]=!0,ur[Ue.s]=!0,ur[fe.c]=!0,ur[fe.e]=!0,ur[fe.o]=!0,ur);function mr(e,t){return{isAvailable:!0,sortHandler:function(e,t){var n=t.itemSetKey,i=t.handler,r=i.columnKey,o=i.isAscending;if(!pr[r])return{};var s=e.demandItemFacet(d.e,n);if(!s)return{};var c=fe.a[r];if(!c)return{};var l=s.driveItemKey.endpoint,f=s.sortBy;return Object(u.a)(e,l)&&!f&&r===Ue.n&&o?{newItemSetKey:n}:{newItemSetKey:d.e.serialize(Object(a.__assign)(Object(a.__assign)({},s),{sortBy:c,isAscending:o}))}}}}var _r,hr=n(647);function br(e,t){var n=t.itemKey,i=e.demandItemFacet(d.e,n),r=i&&i.driveItemKey.endpoint,o=r&&i&&Ln(0,{itemSetKey:d.e.serialize(i),parentItemKey:we.e.serialize({endpoint:r}),stageItem:t.stageItem});return Object(a.__assign)({},o?{stageItem:o}:{})}var gr=((_r={})[fe.c]=!0,_r[fe.e]=!0,_r);function vr(e,t){var n=t.itemSetKey,i=t.handler.columnKey;if(!gr[i])return{};var r=e.demandItemFacet(d.e,n);if(!r)return{};var o=fe.a[i];return o?{newItemSetKey:d.e.serialize(Object(a.__assign)(Object(a.__assign)({},r),{groupBy:o}))}:{}}function yr(e,t){var n=t.itemSetKey,i=e.demandItemFacet(d.e,n);return i?{newItemSetKey:d.e.serialize(Object(a.__assign)(Object(a.__assign)({},i),{groupBy:void 0}))}:{}}var Sr=n(1648),Dr=he.t.isActivated("d4cb8ed6-56a5-4c23-8c49-2f352054edd9","12/15/2021","Use cultureName instead of cultureUIName to display the date"),Ir=Object(fi.i)({name:Sr.t,key:fe.e,fieldName:"",minWidth:fi.e.regularMin,maxWidth:fi.e.regularMax,isCollapsable:!0,sortProps:fi.t},mi.e)(function(e,t){var n=e.demandItemFacet(Y.e,t),a=n&&new Date(n.sharedDateTime).getTime();if("number"!=typeof a||isNaN(a))return{text:""};var i=e.demandItemFacet(_i.O,hi.e),r=!Dr&&(null==i?void 0:i.cultureLCID)||(null==i?void 0:i.language)||window.navigator.language;return r?{text:Object(bi.n)(new Date(a),r)}:{dateValue:a}}),xr=n(926),Cr=new _.e("topCollaboratorSetKeyFacet",{endpoint:h.e}),Or=n(1988),wr=n(512),Er=n(1948),Ar=n(4634);Object(oa.n)([{rawString:".topCollaPlaceHolder_f0c2bf25{display:flex;min-width:13px;height:21px}[dir=ltr] .topCollaPlaceHolder_f0c2bf25{padding-right:10px}[dir=rtl] .topCollaPlaceHolder_f0c2bf25{padding-left:10px}.topCollaboratorIcon_f0c2bf25{color:#0078d4;font-size:13px;line-height:21px;text-align:center}.topCollaboratorUserName_f0c2bf25{font-weight:700}.topCollaboratorTooltip_f0c2bf25{padding:0 2px}.userWithTopCollaborator_f0c2bf25{display:flex}.userWithTopCollaborator_f0c2bf25 .topCollaPlaceHolder_f0c2bf25{min-width:13px}[dir=ltr] .userWithTopCollaborator_f0c2bf25 .topCollaPlaceHolder_f0c2bf25{padding-right:7px}[dir=rtl] .userWithTopCollaborator_f0c2bf25 .topCollaPlaceHolder_f0c2bf25{padding-left:7px}[dir=ltr] .columnHeader_f0c2bf25{margin-left:20px}[dir=rtl] .columnHeader_f0c2bf25{margin-right:20px}"}]);var Lr=function(e){function t(t){return e.call(this,t)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.userName,n=e.isPlaceholder,a=aa.createElement(wr.e,{className:"topCollaboratorIcon_f0c2bf25",iconName:"TeamFavorite"}),i=aa.createElement("span",{className:"topCollaboratorUserName_f0c2bf25"},t),r=aa.createElement("div",{className:"topCollaboratorTooltip_f0c2bf25"},qe.formatToArray(Ar.e,i));return aa.createElement("div",{className:"topCollaPlaceHolder_f0c2bf25"},n?null:t?aa.createElement(Er.e,{content:r},a):a)},t}(Or.e),kr=Object(fi.i)({name:Sr.n,key:fe.c,fieldName:"",minWidth:fi.e.regularMin,maxWidth:fi.e.regularMax,isCollapsable:!0,sortProps:fi.a,headerClassName:"columnHeader_f0c2bf25"},xr.e)(function(e,t){var n,a=e.demandItem({shareByPerson:M},t).shareByPerson,i=e.demandItem({sharedBy:Y.e},t).sharedBy,r=null==a?void 0:a.itemKey,o=i&&(null!==(n=i.sharedBy)&&void 0!==n?n:i.owner),s=(null==a?void 0:a.displayValue)||o&&o.user&&o.user.displayName,c=!1;if(r&&P.e.matches(r)){var d=P.e.deserialize(r).email,l=e.demandItemFacet(m.e,Cr.serialize({endpoint:"https://graph.microsoft.com/beta"}));l&&(c=l.itemKeys.slice(0,3).some(function(t){var n=e.demandItemFacet(L.e,t);return!!n&&n===d}))}return r||s?{people:[{itemKey:r||"",displayValue:s}],onRenderUser:function(e,t){if(!e||!t)return null;var n=t(e),a=e.user;return aa.createElement("div",{className:"userWithTopCollaborator_f0c2bf25"},aa.createElement(Lr,{userName:a.title,isPlaceholder:!c}),n)}}:{people:[]}},function(e,t){return"".concat(e.demandItemFacet(L.e,t))}),Mr=!he.e.isActivated("261491DC-B6D7-4FB8-85F3-EBAA7EA472B0","05/31/2022",'Enables the "Shared Date" column in ODC Shared with me');function Pr(e,t){var n=t.itemSetKey,i=!1,r=e.demandItemFacet(d.e,n);if(r){var o=r.driveItemKey.endpoint;i=Object(u.a)(e,o)}return{columns:Object(a.__spreadArray)(Object(a.__spreadArray)([],i?Object(a.__spreadArray)([ui.e,Qi.t],Mr?[Ir]:[],!0):[ui.t,yi.e,Ir],!0),[kr],!1)}}var Tr=new _.e("topCollaboratorItemKeyFacet",{id:h.e}),Ur=Object(i.i)()(function e(t){var n=this,i=t.itemKey;return function(r){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,o,s,c,d,l,p,_,h,b,v,y,D,I,x,C;return Object(a.__generator)(this,function(O){switch(O.label){case 0:return n=new g.e({publisher:e}),o=r(Object(f.e)({graphEndpoint:S.y})).graphEndpoint,s=Cr.deserialize(i),c=o||s.endpoint,d="".concat(c,"/me/people/"),[4,r(Object(u.t)({url:d,qosName:"getTopCollaborator",endpoint:c}))];case 1:for(l=O.sent(),p=[],_=0,h=l.value;_<h.length;_++)b=h[_],v=b.id,y=b.displayName,D=b.userPrincipalName,I=Tr.serialize({id:v}),r(Object(tt.e)({items:(x={},x[I]=Object(a.__assign)(Object(a.__assign)({},w.u.pack(y)),L.e.pack(D)),x)})),p.push(I);return n.resolveItems({items:(C={},C[t.itemKey]=Object(a.__assign)({},m.e.pack({itemKeys:p})),C)}),r(n.execute()),[2]}})})}});function Fr(e,t){return{isAvailable:!1}}function Hr(e,t){return{isAvailable:!1}}var Rr=Object(i.t)(function(){return function(e){e(it),e(Object(ct.e)(we.e,Ci.e)(lr)),e(Object(ct.e)(we.e,Ti.e)(ar.sharedWithMeContextMenuControlHandler)),e(Object(ct.e)(d.e,fr.t)(mr)),e(Object(ct.e)(d.e,kn.e)(br)),e(Object(ct.e)(d.e,hr.e)(vr)),e(Object(ct.e)(d.e,hr.t)(yr)),e(Object(ct.e)(d.e,ci.e)(Pr)),e(Object(ct.e)(Ve,kn.e)(Fr)),e(Object(ct.e)(Ge,kn.e)(Hr)),e(Object(s.a)(Cr,nt.e)(Ur))}}),Nr=n(1710),Br=n(788),jr=n(1318);function Vr(e,t){var n=t.setItemKey,a=e.demandItemFacet(z.e,n);if(!n||!a)return{};var i=a.driveItemKey.endpoint,r=O.e.serialize(a.driveItemKey),o=e.demandItemFacet(Z.e,r),s=e.demandItemFacet(S.r,hi.e)||F.t,c=e.demandItemFacet(S.R,hi.e);return c&&c(i,o)?{totalItemCount:e.demandItemFacet(B.e,r),getPageKey:function(e,t){return Pn.serialize({setItemKey:n,endpoint:a.driveItemKey.endpoint,skip:e,top:t-e})},pageSize:s}:{}}var zr=n(1299),Gr=he.t.isActivated("637A4DC9-1258-4BD2-8166-5F852E5FEBBE","11/09/2021","The switch to add modifiedBy column in default column set."),Kr=he.t.isActivated("52A76194-DB1E-4300-A64E-FB69963A684C","10/13/2022","Disable column header action since no action avaible"),Wr=Object(a.__assign)(Object(a.__assign)({},qi.e),{columnActionsMode:li.t.disabled}),qr=Kr?qi.e:Wr,Qr=[ui.e,Qi.e,zi.e,Wi.e,qr],Yr=[ui.e,Qi.e,zi.e,zr.e,Wi.e,qr],Jr=[ui.e,Qi.e,zi.e,Ki,Wi.e,qi.e];function Xr(e,t){var n,a=t.itemSetKey;if(a){var i=Object(Vn.e)(e,{itemKey:a}),r=e.demandItemFacet(K.e,i);if("photo"===(null===(n=null==r?void 0:r.folder)||void 0===n?void 0:n.folderType))return{columns:Jr}}return!Gr&&e.demandItemFacet(S.a,hi.e)?{columns:Qr}:{columns:Yr}}var Zr=n(28);function $r(e,t){return n=z.e,{isAvailable:!0,sortHandler:function(e,t){var i=t.itemSetKey,r=t.handler,o=r.columnKey,s=r.isAscending,c=e.demandItemFacet(n,i);if(!c)return{};var d=O.e.serialize(Object(a.__assign)({},c.driveItemKey)),l=e.demandItemFacet(Z.e,d);if(!l||"business"===l||"documentLibrary"===l)return{};var u=Object(Zr.e)(e,{customColumnKeysToFieldNamesConfiguration:S.n,isUnauthenticated:je.e}),f=u.customColumnKeysToFieldNamesConfiguration,p=u.isUnauthenticated,_=void 0!==p&&p;if(!c.sortBy){var h=e.demandItemFacet(m.s,d);if(on.e&&h&&!_){if(o===(null==h?void 0:h.columnKey)&&(null==h?void 0:h.isAscending)===s)return{newItemSetKey:i}}else if(o===Qi.e.key&&!0===s)return{newItemSetKey:i}}var b=Object(a.__assign)(Object(a.__assign)({},fe.a),f),g=b?b[o]:void 0;return g?{newItemSetKey:n.serialize(Object(a.__assign)(Object(a.__assign)({},c),{sortBy:g,isAscending:s}))}:{}}};var n}var eo=n(693);function to(e,t){var n=Object(ta.e)(e),a=e.demandItemFacet(Ot.e,n),i=e.demandItemFacet(we.e,n),r=e.demandItemFacet(rt,n);return t.isMove?{isAvailable:!a&&!i&&!r}:{isAvailable:!a}}var no=n(1787);function ao(e,t){var n=t.itemKey;return e.demandItemFacet(W.e,n,{suppressGetItems:!0})?{renameDialogAs:io}:{}}function io(e){var t=e.defaultRender,n=Object(a.__rest)(e,["defaultRender"]);return t?aa.createElement(t,Object(a.__assign)({},n),function(e){return aa.createElement(no.e,Object(a.__assign)({},e))}):null}var ro=n(683),oo=n(1708),so=n(22),co=n(621),lo=n(3291),uo={key:new k.e("openInOfficeOnlineDefaultClickHandler").id,evaluate:function(e,t){var n=t.itemKey,a=e.demandItem({openUrl:w.A,appMap:te.e},n),i=a.openUrl,r=a.appMap;return{action:i&&r?aa.createElement(co.e,{itemKey:n,action:Object(so.i)(e,aa.createElement(lo.e,{itemKey:n}))}):void 0}}},fo=n(3397),po={key:new k.e("openInOfficeClientDefaultClickHandler").id,evaluate:function(e,t){var n=t.itemKey,a=e.demandItem({openUrl:w.A,appMap:te.e},n),i=a.openUrl,r=a.appMap;return{action:i&&r?aa.createElement(co.e,{itemKey:n,action:Object(so.i)(e,aa.createElement(fo.e,{itemKey:n}))}):void 0}}};function mo(e,t){var n=t.handlers,i=void 0===n?[]:n,r=t.itemKey;return{isAvailable:!e.demandItemFacet(w.d,r),handlers:Object(a.__spreadArray)([oo.e,uo,po],i,!0)}}var _o=n(838),ho=n(1788),bo=n(832),go=n(205),vo=n(252),yo=n(1004),So=n(2181),Do=Object(Cn.t)(function(e){e.itemsScopeItemKey;var t=e.localStorageKey,n=Object(a.__rest)(e,["itemsScopeItemKey","localStorageKey"]);return function(e){var i,r=e(Object(N.e)(function(e){return Object(So.e)(e,{name:t})}))||{},o=r&&function(e,t){var n=t.queryType,i=t.layoutType,r=i&&function(e){return e===go.e?yo.e:e===vo.e?yo.n:yo.t}(i),o=function(e,t){return n=e,Object(a.__assign)(((i={version:2})[0]="",i[1]="",i[3]="",i[6]="",i[16]="",i),n);var n,i}(e);return"number"==typeof n&&r&&(o[n]=r),o}(r,Object(a.__assign)({},n));e(Object(So.n)({values:(i={},i[t]=o,i)}))}}),Io=new k.e("defaultLayoutTypeMapConfiguration"),xo=new _.e("itemsScopeList",{driveId:h.e,itemsScopeItemKey:h.e});function Co(e,t){var n=Object(Zr.e)(e,{isLayoutResolvedEnabled:_i.x,isLocalStorageForLayoutEnabled:S.L,defaultLayoutTypeMapConfiguration:Io}),i=n.isLayoutResolvedEnabled,r=n.isLocalStorageForLayoutEnabled,o=n.defaultLayoutTypeMapConfiguration;if(!i||!r)return{};var s,c,d,l,u=t.itemsScopeItemKey,f=Object(xn.e)(e),p=e.demandItemFacet(z.e,f),m=void 0;if(f&&p&&u){var _=p.driveItemKey;if(_){var h=_.endpoint,b=_.driveId;if(!b||!h)return{};var g,v,y=xo.serialize({driveId:b,itemsScopeItemKey:u}),D=e.demandItemFacet(S.S,hi.e),I=D&&D(e,{itemSetKey:f}),x=I&&I.queryType||0;g="ItemsStore".concat((s={endpoint:h,driveId:b,queryType:x},c=s.endpoint,d=s.driveId,l="Graph.Files.FilesQueryType.".concat(c),d?"".concat(l,".").concat(d):l).toLocaleLowerCase());var C=Object(So.e)(e,{name:g});m=Object(So.t)(e,{name:g});var O=C&&C[x]||"";v=!O&&m&&o&&o[x]?o[x]:m?function(e){switch(e){case yo.t:return go.t;case yo.e:return go.e;default:return vo.e}}(O):void 0;var w=e.demandItemFacet(Qe.c,y);return{preferredLayoutType:e.demandItemFacet(Qe.s,y)||v,preferredLayoutVersion:w,setPreferredLayout:function(e){var t=e.layoutType;return function(n){var i,r;g&&b&&h&&n(Do({endpoint:h,driveId:b,itemsScopeItemKey:u,queryType:x,localStorageKey:g,layoutType:t})),n(Object(tt.e)({items:(i={},i[y]=Object(a.__assign)({},Qe.s.pack(e.layoutType)),i)})),n(Object(tt.e)({items:(r={},r[y]=Object(a.__assign)({},Qe.c.pack((w||0)+1)),r)}))}}}}}return{}}var Oo=n(1340),wo=n(2180),Eo=new k.e("itemRestrictedSignal").id;function Ao(e,t){var n=t.itemKey;if(e.demandItemFacet(pe.e,n)&&n){var i=Object(a.__spreadArray)([],t.signals||[],!0);return i.push(Lo),{signals:i}}return{}}var Lo={signal:aa.createElement(wo.t,null),title:J.e,key:Eo},ko=n(631),Mo=n(458),Po=n(780),To=n(215),Uo=n(25);Object(oa.n)([{rawString:".root_f578385e{display:inline-flex;position:relative;vertical-align:bottom;flex-direction:row;align-items:flex-end}.vaultCoverIsSmall_f578385e{width:72px;height:52px}.vaultCoverIsLarge_f578385e{width:112px;height:80px}.cover_f578385e{display:block;position:absolute;padding-bottom:12px;left:-3px;right:-3px;bottom:-4px}"}]);var Fo,Ho=n(276),Ro=Object(Ho.e)("/"),No="".concat(Ro,"office-ui-fabric-react-assets/foldericons"),Bo="".concat(Ro,"/assets/item-types/");!function(e){e.vaultOpen="vaultopen",e.vaultClosed="vaultclosed"}(Fo||(Fo={}));var jo,Vo,zo={small:{vaultclosed:"vaultCoverSmallVaultClosed",vaultopen:"vaultCoverSmallVaultOpen"},large:{vaultclosed:"VaultCoverLargeVaultClosed",vaultopen:"VaultCoverLargeVaultOpen"}},Go=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.vaultCoverSize,i=void 0===n?"large":n,r=t.vaultCoverType,o=void 0===r?"vaultclosed":r,s=(t.ref,t.children,t.isFluent),c=Object(a.__rest)(t,["vaultCoverSize","vaultCoverType","ref","children","isFluent"]),d=zo[i][o];return"small"===i?e="vaultCoverIsSmall_f578385e":"large"===i&&(e="vaultCoverIsLarge_f578385e"),aa.createElement("div",Object(a.__assign)({},c,{className:"".concat("root_f578385e"," ").concat(e," ").concat(s?"isFluent":""),role:"none"}),aa.createElement(wr.e,{"aria-hidden":!0,className:"ms-VaultCover ".concat("cover_f578385e"),iconName:d,role:"none"}))},t}(aa.Component);function Ko(e,t){var n=t.itemKey,i=e.demandItemFacet($.e,n),r=e.demandItemFacet(q.e,n,{suppressGetItems:!0})||e.demandItemFacet(W.e,n,{suppressGetItems:!0});return Object(a.__assign)(Object(a.__assign)({},i&&i.root?{tileAs:qo}:{}),{folderCoverControlHandler:function(t,n){var i={};r&&(i={folderCoverAs:Qo});var o=n.signalData;if(o&&o.signal)return i;var s=e.demandItem({specialFolder:ie.e},n.itemKey).specialFolder;if(!s)return i;var c=function(e){var t=null;return"desktop"===e?t=aa.createElement(wo.n,null):"documents"===e?t=aa.createElement(wo.a,null):"pictures"===e&&(t=aa.createElement(wo.l,null)),{signal:t,key:e||""}}(s);return c&&c.signal?Object(a.__assign)(Object(a.__assign)({},i),{signalData:c}):i}})}Vo={disableWarnings:!0},void 0===(jo=he.e.isActivated("C242A965-ED0B-4653-9CCD-6FA000E87895","11/03/2022","Use getFabricAssetCdnUrl to get the CDN url instead of hardcoding it")?"https://res-1.cdn.office.net/files/fabric-cdn-prod_20211207.001/office-ui-fabric-react-assets/foldericons":Object(Ho.e)("/office-ui-fabric-react-assets/foldericons"))&&(jo=No),Object(Uo.N)({fontFace:{},style:{width:78,height:58,overflow:"hidden"},icons:{vaultCoverSmallVaultClosed:aa.createElement("img",{src:"".concat(jo,"/vault-sm.svg")}),vaultCoverSmallVaultOpen:aa.createElement("img",{src:"".concat(jo,"/vault-sm-open.svg")})}},Vo),Object(Uo.N)({fontFace:{},style:{width:118,height:86,overflow:"hidden"},icons:{VaultCoverLargeVaultClosed:aa.createElement("img",{src:"".concat(jo,"/vault-lg.svg")}),VaultCoverLargeVaultOpen:aa.createElement("img",{src:"".concat(jo,"/vault-lg-open.svg")})}},Vo);var Wo=Object(ia.t)(function(e,t){var n=t.itemKey,i=Object(a.__rest)(t,["itemKey"]),r=e.demandItemFacet($.e,n),o=r&&r.isLocked?Fo.vaultClosed:Fo.vaultOpen;return aa.createElement(Go,Object(a.__assign)({},i,{vaultCoverSize:i.folderCoverSize,vaultCoverType:o}))}),qo=Object(ia.t)(function(e,t){var n=t.defaultRender,i=t.foreground,r=Object(a.__rest)(t,["defaultRender","foreground"]),o=t.itemKey,s=i,c=e.demandItemFacet($.e,o);return c&&c.root&&(s=Object(To.a)(e,aa.createElement(Wo,Object(a.__assign)({},r,{folderCoverSize:r.tileSize,itemKey:o})))),n?aa.createElement(n,Object(a.__assign)({},r,{foreground:s})):null});function Qo(e){var t=e.defaultRender,n=Object(a.__rest)(e,["defaultRender"]);return t?aa.createElement(t,Object(a.__assign)({},n,{folderCoverType:"linked"})):null}var Yo=n(1001),Jo=n(181),Xo=n(357);Object(oa.n)([{rawString:".fileHandlerFileTypeIcon_86ad4959{width:inherit;height:inherit}"}]);var Zo=!he.e.isActivated("C8C7CD90-A7D5-45A9-9BBC-9041BF1AD06F","07/19/2022","Prevent Shared Folder icon from appearing at SWM/SBY roots");function $o(e,t){var n=t.itemKey,a=e.demandItemFacet($.e,n);return a&&a.root?{iconAs:es}:{fileTypeIconAs:ts}}var es=Object(ia.t)(function(e,t){var n,i=t.itemKey,r=Object(a.__rest)(t,["itemKey"]),o=e.demandItemFacet($.e,i);if(o&&o.root){var s=e.demandItemFacet(w.u,i),c=o.isLocked?Fo.vaultClosed:Fo.vaultOpen,d={iconType:Yo.e.Image,ariaLabel:s,imageProps:{src:(n=c,"".concat(Bo).concat("20").concat("","/").concat(n,".").concat("png")),imageFit:Jo.t.contain,className:"fileHandlerFileTypeIcon_86ad4959",role:"none"}};return aa.createElement(wr.e,Object(a.__assign)({},r,d))}return null}),ts=Object(ia.t)(function(e,t){var n=t.defaultRender,i=Object(a.__rest)(t,["defaultRender"]),r=i.isFolder,o=i.itemKey,s=i.type,c=s;if(r&&void 0===s){var d=e.demandItemFacet(ie.e,o);void 0!==d&&("desktop"===d?c=Xo.e.desktopFolder:"documents"===d?c=Xo.e.documentsFolder:"pictures"===d&&(c=Xo.e.picturesFolder))}else if(Zo&&r&&s===Xo.e.sharedFolder){var l=Object(ta.e)(e),u=e.demandItemFacet(we.e,l),f=e.demandItemFacet(rt,l);(u||f)&&(c=Xo.e.folder)}return n?aa.createElement(n,Object(a.__assign)({},i,{type:c})):null}),ns=n(1607),as=n(1706),is=n(692),rs=n(104),os=n(3539),ss=new k.e("enableSyncConfigurationFacet"),cs=new rs.e;function ds(e,t){var n=function(e,t){var n=t.itemKey,a=t.platformDetection;if(!a.isWindows)return{syncState:"noSyncNotAllowedInExperience"};if(a.isMobile)return{syncState:"noSyncMobileDevice"};var i=e.demandItemFacet(O.e,n);return i?e.demandItemFacet(L.e,os.e.serialize(i))?{syncState:"syncNextGen"}:{syncState:"noSyncNotAllowedInExperience"}:{syncState:"noSyncItemIsNotLoaded"}}(e,{itemKey:t.itemKey,platformDetection:cs}).syncState;if("syncNextGen"!==n)return{syncState:n};var a=Object(Zr.e)(e,{enableSync:ss}).enableSync;return{isAvailable:!!a&&a(),syncState:n,protocolCallback:function(e){window.location.href=e}}}var ls=n(1603),us=Object(i.t)(function(){return function(e){e(Object(ct.e)(O.e,is.e)(ds)),e(Object(ct.e)(O.e,ls.e)(e(Object(ba.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(15).then(n.bind(null,5261))];case 1:return[2,e.sent().driveItemSyncDialogControlHandler]}})})}))))}}),fs=n(572),ps=n(157),ms=Object(ps.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(505).then(n.bind(null,5404))];case 1:return[2,e.sent().EmptyFolderTitle]}})})});function _s(e,t){var n=t.itemKey,a=t.emptyFolderTitle,i=(e.demandItemFacet(z.e,n)||{}).driveItemKey,r=i&&O.e.serialize(i),o=e.demandItemFacet(ie.e,r);return o&&"documents"===o?{emptyFolderTitle:Object(To.a)(e,aa.createElement(ms,{titleFallback:a}))}:{}}var hs=Object(i.t)(function(){return function(e){e(Oa),e(Object(ct.e)(z.e,ci.e)(Xr)),e(Object(ct.e)(z.e,Oo.e)(e(Object(ba.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(13).then(n.bind(null,5158))];case 1:return[2,e.sent().driveItemSortActionControlHandler]}})})})))),e(Object(ct.e)(z.e,fr.t)($r)),e(Object(ct.e)(O.e,ko.e)(Ao)),e(Object(ct.e)(O.e,Br.e)(Nr.e)),e(Object(ct.e)(z.e,jr.e)(Vr)),as.e||e(Object(ct.e)(O.e,ns.e)(ao)),e(Object(ct.e)(O.e,eo.e)(to)),e(Object(ct.e)(O.e,Mo.e)($o)),e(Object(ct.e)(O.e,Po.e)(Ko)),e(Object(ct.e)(O.e,ro.e)(mo)),e(Object(ct.e)(O.e,_o.e)(ho.e)),e(Object(ct.e)(z.e,bo.e)(Co)),e(us),e(Object(ct.e)(z.e,fs.e)(_s))}}),bs=new _.e("specialDriveItem",{endpoint:h.e,driveId:h.t,name:h.e}),gs=n(351),vs=Object(i.i)()(function e(t){var n=this,i=t.itemKey,r=bs.deserialize(i),o=r.driveId,s=r.endpoint,c=Object(l.n)(r);return function(t){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,d,f,p,_,h,b,v,y;return Object(a.__generator)(this,function(S){switch(S.label){case 0:return[4,t(Object(u.t)({url:Object(l.i)(r),driveUrl:c,driveId:o,qosName:"getItem",endpoint:s}))];case 1:return n=S.sent(),d=new g.e({publisher:e}),f=n&&n.parentReference,p=f&&f.driveId,_={endpoint:s,driveId:p||o,itemId:n.id},h=O.e.serialize(_),b=f&&f.id?O.e.serialize({endpoint:s,driveId:p,itemId:f.id}):void 0,d.merge(t(Object(C.e)({itemKey:h,driveItem:n,endpoint:s,parentFolderItemKey:b})).itemResolver),d.resolveItems({items:(v={},v[h]=Object(a.__assign)(Object(a.__assign)({},gs.n.pack(O.e)),m.t.pack({itemKey:z.e.serialize({driveItemKey:_,sortBy:"",isAscending:!0})})),v)}),d.mapKeys({mappings:(y={},y[h]=i,y)}),t(d.execute()),[2]}})})}});function ys(e,t){var n=t.itemsScopeItemKey,i=t.engagement,r=t.itemKey,o=i&&i.name,s=e.demandItemFacet(bs,r);return{engagement:Object(a.__assign)(Object(a.__assign)({},(null==i?void 0:i.datasource)?{}:{datasource:"Graph"}),{objectType:"Folder",extraData:Object(a.__assign)({itemGraphId:null==s?void 0:s.driveId,specialGraphName:null==s?void 0:s.name},"ItemsView.Load"===o?Object(ut.e)(e,{itemsScopeItemKey:n}):{})})}}var Ss=Object(i.t)(function(){return function(e){e(Object(ct.e)(bs,dt.e)(ys))}}),Ds=Object(i.t)(function(){return function(e){e(Object(s.a)(bs,nt.e)(vs)),e(Ss)}}),Is=Object(i.t)(function(){return function(e){e(Ds),e(Object(ct.e)(bs,Mo.e)($o)),e(Object(ct.e)(bs,Po.e)(Ko))}}),xs=n(3444),Cs=n(900),Os=n(3535),ws=Object(i.i)()(function e(t){var n=this,i=t.itemKey,r=xs.e.deserialize(i),o=r.endpoint,s=r.driveId;return function(t){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,r,c,d,u;return Object(a.__generator)(this,function(f){switch(f.label){case 0:return n=Object(l.n)({endpoint:o,driveId:s}),[4,t(Object(Cs.getSessionToken)({endpoint:o,driveUrl:n}))];case 1:return r=f.sent(),c=r&&r.accessToken,(d=new g.e({publisher:e})).resolveItems({items:(u={},u[i]=Object(a.__assign)({},Os.e.pack(c)),u)}),t(d.execute()),[2]}})})}}),Es=n(3663),As=n(3922),Ls=Object(i.t)(function(){return function(e){e(Object(s.a)(xs.e,nt.e)(ws)),Object(As.e)()||e(Object(s.a)(Es.e,nt.e)(Object(i.a)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(22).then(n.bind(null,5159))];case 1:return[2,e.sent().itemThumbnailGetItemsOperationHandler]}})})})))}}),ks=n(694),Ms=n(210),Ps=!he.e.isActivated("6E019929-F335-47E2-9308-911B40E188A3","06/13/2022","Disable picker move/copy command for vault"),Ts=Ms.n.isFeatureEnabled({ODC:"UseItemsScopeVroomMoveCopy"});function Us(e,t){var n=e.demandItemFacet(be.e,hi.e);if((null==n?void 0:n.isUserMigrated)&&!Ts)return{isAvailable:!1};for(var a=0,i=t.sourceItemKeys;a<i.length;a++){var r=i[a],o=e.demandItemFacet(O.e,r);if(!o)return{};var s=o.itemId;if((void 0===s?F.a:s)===F.a)return{};if(Ps){var c=e.demandItemFacet($.e,r);if(null==c?void 0:c.root)return{isAvailable:!1}}if(t.isMove&&!e.demandItemFacet($n.t,r))return{};if(e.demandItemFacet(W.e,r))return{}}var d=Object(ta.e)(e),l=e.demandItemFacet(Ot.e,d),u=e.demandItemFacet(we.e,d),f=e.demandItemFacet(rt,d);return t.isMove?{isAvailable:!l&&!u&&!f}:{isAvailable:!l}}var Fs=n(4099),Hs=Object(i.t)(function(){return function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(t){return e(Object(ct.e)(O.e,Fs.e)(e(Object(ba.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(28).then(n.bind(null,5268))];case 1:return[2,e.sent().driveItemMoveCopyProgressControlHandler]}})})})))),[2]})})}}),Rs=Object(i.t)(function(){return function(e){e(Hs),e(Object(ct.e)(O.e,ks.e)(Us))}}),Ns=Object(i.t)(function(){return function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(t){return e(ii),e(hs),e(Ls),e(si),e(nr),e(Rr),e(Is),e(Rs),[2]})})}})}}]);